import{c as Bs}from"./VIKLA3AL.js";import{a as ie}from"./WZHIWEFG.js";import{A as Z,B as bt,C as Ls,E as Cn,F as de,G as fe,H as Ye,J as Qe,K as Pt,a as Q,b as gt,c as fs,d as Fe,e as ms,f as _s,g as J,h as As,i as p,j as xe,k as Cs,l as Ot,m as W,n as U,o as Lt,p as ps,q as Is,r as Ns,s as ye,t as Rs,u as we,v as gs,w as St,x as Dt,y as ve,z as Os}from"./HIM55SOL.js";import{a as We}from"./X2SRSDMC.js";import{a as Rn}from"./UJXLCYHA.js";import{a as Fs}from"./VW4PILDH.js";import{a as ks,b as Hs}from"./FURDXDDQ.js";import{a as Xe}from"./UEN7EF5P.js";import{a as Us}from"./XQ7OTANB.js";import{ba as Nn,f as Ms}from"./W7JCQNRZ.js";import{L as Ge,o as Ds,p as pn,r as bs,s as Ps,t as In,w as ae}from"./NVVQBQGC.js";import{a as Ss}from"./ZO2DK75M.js";import{a as An}from"./SZ3C6HJE.js";import{a as us,d as ds}from"./GDFJJHFX.js";import{c as Ue,d as $,f as ne,i as Ts}from"./UTGLRY7A.js";var xs=Ue(Ke=>{"use strict";var gn=Ge();Object.defineProperty(Ke,"__esModule",{value:!0});Ke.default=void 0;var On=gn(Xe()),Ln=ae(),Sn=(0,On.default)((0,Ln.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");Ke.default=Sn});var wn=Ue(je=>{"use strict";var Un=Ge();Object.defineProperty(je,"__esModule",{value:!0});je.default=void 0;var Fn=Un(Xe()),xn=ae(),yn=(0,Fn.default)((0,xn.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}),"CloseOutlined");je.default=yn});var Gn=Ue(qe=>{"use strict";var vn=Ge();Object.defineProperty(qe,"__esModule",{value:!0});qe.default=void 0;var Yn=vn(Xe()),Qn=ae(),Wn=(0,Yn.default)((0,Qn.jsx)("path",{d:"M16 8v8H8V8h8m2-2H6v12h12V6z"}),"StopOutlined");qe.default=Wn});var Wc=Ue(Nt=>{"use strict";var wc=Ge();Object.defineProperty(Nt,"__esModule",{value:!0});Nt.default=void 0;var vc=wc(Xe()),Yc=ae(),Qc=(0,vc.default)((0,Yc.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"SearchOutlined");Nt.default=Qc});pn();In();var ys=ne(An()),ws=ne(Rn()),vs=ne(xs());var w=ne(ae()),Ys="webchatgpt-snackbar",Qs="webchatgpt-snackbar-container",Y,Dn=()=>(Y=Hs(),null),sE=()=>Y,rE=()=>{Y&&Y.closeSnackbar&&Y.closeSnackbar()},nE=()=>document.getElementById(Ys)?.shadowRoot?.getElementById(Qs),bn=()=>{let{customTheme:e}=Fs({colorSchema:"dark"});return(0,w.jsx)(Ps,{theme:e,children:(0,w.jsx)(ks,{maxSnack:3,preventDuplicate:!0,hideIconVariant:!0,autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"right"},action:t=>(0,w.jsx)(Ms,{onClick:()=>{Y&&Y.closeSnackbar&&Y.closeSnackbar(t)},children:(0,w.jsx)(vs.default,{fontSize:"inherit",sx:{color:"white"}})}),children:(0,w.jsx)(Dn,{})})})},aE=()=>{let{container:e,shadowRoot:t,emotionRoot:s}=Bs({containerId:Qs,shadowRootId:Ys,presetContainerElement(a){a.style.color="#fff"}});e.style.zIndex=`${us.TOAST}`,document.body.appendChild(t);let n=Ds({key:"webchatgpt-snackbar-emotion-cache",prepend:!0,container:s});(0,ws.createRoot)(e).render((0,w.jsx)(ys.default.StrictMode,{children:(0,w.jsx)(Us,{children:(0,w.jsx)(bs,{value:n,children:(0,w.jsx)(bn,{})})})}))},Ve=(e,t={})=>{Y.enqueueSnackbar(e,t)},Pn=(e,t={})=>{Ve(e,{...t,variant:"success"})},Mn=(e,t={})=>{Ve(e,{...t,variant:"warning"})},Bn=(e,t={})=>{Ve(e,{...t,variant:"info"})},kn=(e,t={})=>{Ve(e,{...t,variant:"error"})},Hn={success:Pn,warning:Mn,info:Bn,error:kn},iE=Hn;var ee=new Ss("ArkoseIframeGenerator"),$e=class{iframeInstance=null;constructor(){}async injectIframe(t){if(await this.ping(t))return!0;for(let n=0;n<1;n++){if(await We(this.injectIframeOnce(),1e4,!1))return ee.info("inject iframe success"),!0;ee.info("inject iframe fail","retry times",n+1),this.removeIframe()}return ee.info("inject iframe fail"),!1}async generateToken(t){if(ds||!await this.injectIframe(t))return"";let s=await We(this.postMessageGenerateToken(t),10*1e3,"");return s||this.removeIframe(),ee.info(`generateToken ${s?"success":"fail"}`,s),s}getRootContainer(){return document.body}async ping(t){return ee.info("ping"),this.iframeInstance?await We(new Promise(n=>{let a=c=>{if(c.data&&c.data.id===ie){let{data:l,type:u}=c.data;u==="pong"&&(ee.info("ping result",l?.success===!0),n(l?.success===!0),window.removeEventListener("message",a))}};window.addEventListener("message",a),this.iframeInstance?.contentWindow?.postMessage({id:ie,type:"ping",data:{model:t}},"*")}),2e3,!1)?!0:(this.removeIframe(),!1):(ee.info("ping result",!1),!1)}injectIframeOnce(){return new Promise(t=>{let s=a=>{if(a.data&&a.data.id===ie){let{data:c,type:l}=a.data;l==="inject_iframe_response"&&(t(c?.success===!0),window.removeEventListener("message",s))}};window.addEventListener("message",s);let n=document.createElement("iframe");n.id=$e.iframeId,n.src="https://chat.openai.com/robots.txt",n.style.cssText=`
      position: absolute !important;
      opacity: 0 !important;
      width: 1px !important;
      height: 1px !important;
      top: 0 !important;
      left: 0 !important;
      border: none !important;
      display: block !important;
      z-index: -1 !important;
      pointer-events: none;`,this.iframeInstance=n,this.getRootContainer()?.append(n)})}removeIframe(){let t=this.getRootContainer()?.querySelector(`#${$e.iframeId}`);t&&(this.iframeInstance=null,t.remove())}async postMessageGenerateToken(t){return new Promise(s=>{let n=a=>{if(a.data&&a.data.id===ie){let{data:c,type:l}=a.data;l==="get_token_response"&&(s(c?.token||""),window.removeEventListener("message",n))}};window.addEventListener("message",n),this.iframeInstance?.contentWindow?.postMessage({id:ie,type:"get_token",data:{model:t}},"*")})}},ze=$e;Ts(ze,"iframeId","webchatgpt-arkose-token-generate-iframe");var fE=new ze;var Xn={xml:!1,decodeEntities:!0},me=Xn,Ws={_useHtmlParser2:!0,xmlMode:!0};function _e(e){return e?.xml?typeof e.xml=="boolean"?Ws:{...Ws,...e.xml}:e??void 0}var X={};$(X,{contains:()=>Mt,html:()=>Ks,merge:()=>qn,parseHTML:()=>Vn,root:()=>jn,text:()=>G,xml:()=>Vs});function Xs(e,t,s){return e?e(t??e._root.children,null,void 0,s).toString():""}function Kn(e,t){return!t&&typeof e=="object"&&e!=null&&!("length"in e)&&!("type"in e)}function Ks(e,t){let s=Kn(e)?(t=e,void 0):e,n={...me,...this===null||this===void 0?void 0:this._options,..._e(t??{})};return Xs(this,s,n)}function Vs(e){let t={...this._options,xmlMode:!0};return Xs(this,e,t)}function G(e){let t=e||(this?this.root():[]),s="";for(let n=0;n<t.length;n++)s+=ye(t[n]);return s}function Vn(e,t,s=typeof t=="boolean"?t:!1){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(s=t);let n=this.load(e,me,!1);return s||n("script").remove(),n.root()[0].children.slice()}function jn(){return this(this._root)}function Mt(e,t){if(t===e)return!1;let s=t;for(;s&&s!==s.parent;)if(s=s.parent,s===e)return!0;return!1}function qn(e,t){if(!Gs(e)||!Gs(t))return;let s=e.length,n=+t.length;for(let a=0;a<n;a++)e[s++]=t[a];return e.length=s,e}function Gs(e){if(Array.isArray(e))return!0;if(typeof e!="object"||!Object.prototype.hasOwnProperty.call(e,"length")||typeof e.length!="number"||e.length<0)return!1;for(let t=0;t<e.length;t++)if(!(t in e))return!1;return!0}var Ut={};$(Ut,{addClass:()=>tr,attr:()=>$n,data:()=>Zn,hasClass:()=>sa,prop:()=>Jn,removeAttr:()=>ta,removeClass:()=>sr,toggleClass:()=>rr,val:()=>ea});function H(e){return e.cheerio!=null}function js(e){return e.replace(/[_.-](\w|$)/g,(t,s)=>s.toUpperCase())}function qs(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()}function g(e,t){let s=e.length;for(let n=0;n<s;n++)t(e[n],n);return e}function Je(e){let t="length"in e?Array.prototype.map.call(e,n=>Lt(n,!0)):[Lt(e,!0)],s=new J(t);return t.forEach(n=>{n.parent=s}),t}var te;(function(e){e[e.LowerA=97]="LowerA",e[e.LowerZ=122]="LowerZ",e[e.UpperA=65]="UpperA",e[e.UpperZ=90]="UpperZ",e[e.Exclamation=33]="Exclamation"})(te||(te={}));function Ae(e){let t=e.indexOf("<");if(t<0||t>e.length-3)return!1;let s=e.charCodeAt(t+1);return(s>=te.LowerA&&s<=te.LowerZ||s>=te.UpperA&&s<=te.UpperZ||s===te.Exclamation)&&e.includes(">",t+2)}var oe=Object.prototype.hasOwnProperty,Ce=/\s+/,Bt="data-",zs={null:null,true:!0,false:!1},Ht=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,zn=/^{[^]*}$|^\[[^]*]$/;function Ze(e,t,s){var n;if(!(!e||!p(e))){if((n=e.attribs)!==null&&n!==void 0||(e.attribs={}),!t)return e.attribs;if(oe.call(e.attribs,t))return!s&&Ht.test(t)?t:e.attribs[t];if(e.name==="option"&&t==="value")return G(e.children);if(e.name==="input"&&(e.attribs.type==="radio"||e.attribs.type==="checkbox")&&t==="value")return"on"}}function ce(e,t,s){s===null?er(e,t):e.attribs[t]=`${s}`}function $n(e,t){if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e!="string")throw new Error("Bad combination of arguments.");return g(this,(s,n)=>{p(s)&&ce(s,e,t.call(s,n,s.attribs[e]))})}return g(this,s=>{p(s)&&(typeof e=="object"?Object.keys(e).forEach(n=>{let a=e[n];ce(s,n,a)}):ce(s,e,t))})}return arguments.length>1?this:Ze(this[0],e,this.options.xmlMode)}function $s(e,t,s){return t in e?e[t]:!s&&Ht.test(t)?Ze(e,t,!1)!==void 0:Ze(e,t,s)}function kt(e,t,s,n){t in e?e[t]=s:ce(e,t,!n&&Ht.test(t)?s?"":null:`${s}`)}function Jn(e,t){var s;if(typeof e=="string"&&t===void 0){let n=this[0];if(!n||!p(n))return;switch(e){case"style":{let a=this.css(),c=Object.keys(a);return c.forEach((l,u)=>{a[u]=l}),a.length=c.length,a}case"tagName":case"nodeName":return n.name.toUpperCase();case"href":case"src":{let a=(s=n.attribs)===null||s===void 0?void 0:s[e];return typeof URL<"u"&&(e==="href"&&(n.tagName==="a"||n.name==="link")||e==="src"&&(n.tagName==="img"||n.tagName==="iframe"||n.tagName==="audio"||n.tagName==="video"||n.tagName==="source"))&&a!==void 0&&this.options.baseURI?new URL(a,this.options.baseURI).href:a}case"innerText":return Rs(n);case"textContent":return ye(n);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return $s(n,e,this.options.xmlMode)}}if(typeof e=="object"||t!==void 0){if(typeof t=="function"){if(typeof e=="object")throw new Error("Bad combination of arguments.");return g(this,(n,a)=>{p(n)&&kt(n,e,t.call(n,a,$s(n,e,this.options.xmlMode)),this.options.xmlMode)})}return g(this,n=>{p(n)&&(typeof e=="object"?Object.keys(e).forEach(a=>{let c=e[a];kt(n,a,c,this.options.xmlMode)}):kt(n,e,t,this.options.xmlMode))})}}function Js(e,t,s){var n;let a=e;(n=a.data)!==null&&n!==void 0||(a.data={}),typeof t=="object"?Object.assign(a.data,t):typeof t=="string"&&s!==void 0&&(a.data[t]=s)}function Zs(e,t){let s,n,a;t==null?(s=Object.keys(e.attribs).filter(c=>c.startsWith(Bt)),n=s.map(c=>js(c.slice(Bt.length)))):(s=[Bt+qs(t)],n=[t]);for(let c=0;c<s.length;++c){let l=s[c],u=n[c];if(oe.call(e.attribs,l)&&!oe.call(e.data,u)){if(a=e.attribs[l],oe.call(zs,a))a=zs[a];else if(a===String(Number(a)))a=Number(a);else if(zn.test(a))try{a=JSON.parse(a)}catch{}e.data[u]=a}}return t==null?e.data:a}function Zn(e,t){var s;let n=this[0];if(!n||!p(n))return;let a=n;return(s=a.data)!==null&&s!==void 0||(a.data={}),e?typeof e=="object"||t!==void 0?(g(this,c=>{p(c)&&(typeof e=="object"?Js(c,e):Js(c,e,t))}),this):oe.call(a.data,e)?a.data[e]:Zs(a,e):Zs(a)}function ea(e){let t=arguments.length===0,s=this[0];if(!s||!p(s))return t?void 0:this;switch(s.name){case"textarea":return this.text(e);case"select":{let n=this.find("option:selected");if(!t){if(this.attr("multiple")==null&&typeof e=="object")return this;this.find("option").removeAttr("selected");let a=typeof e!="object"?[e]:e;for(let c=0;c<a.length;c++)this.find(`option[value="${a[c]}"]`).attr("selected","");return this}return this.attr("multiple")?n.toArray().map(a=>G(a.children)):n.attr("value")}case"input":case"option":return t?this.attr("value"):this.attr("value",e)}}function er(e,t){!e.attribs||!oe.call(e.attribs,t)||delete e.attribs[t]}function et(e){return e?e.trim().split(Ce):[]}function ta(e){let t=et(e);for(let s=0;s<t.length;s++)g(this,n=>{p(n)&&er(n,t[s])});return this}function sa(e){return this.toArray().some(t=>{let s=p(t)&&t.attribs.class,n=-1;if(s&&e.length)for(;(n=s.indexOf(e,n+1))>-1;){let a=n+e.length;if((n===0||Ce.test(s[n-1]))&&(a===s.length||Ce.test(s[a])))return!0}return!1})}function tr(e){if(typeof e=="function")return g(this,(n,a)=>{if(p(n)){let c=n.attribs.class||"";tr.call([n],e.call(n,a,c))}});if(!e||typeof e!="string")return this;let t=e.split(Ce),s=this.length;for(let n=0;n<s;n++){let a=this[n];if(!p(a))continue;let c=Ze(a,"class",!1);if(!c)ce(a,"class",t.join(" ").trim());else{let l=` ${c} `;for(let u=0;u<t.length;u++){let f=`${t[u]} `;l.includes(` ${f}`)||(l+=f)}ce(a,"class",l.trim())}}return this}function sr(e){if(typeof e=="function")return g(this,(a,c)=>{p(a)&&sr.call([a],e.call(a,c,a.attribs.class||""))});let t=et(e),s=t.length,n=arguments.length===0;return g(this,a=>{if(p(a))if(n)a.attribs.class="";else{let c=et(a.attribs.class),l=!1;for(let u=0;u<s;u++){let f=c.indexOf(t[u]);f>=0&&(c.splice(f,1),l=!0,u--)}l&&(a.attribs.class=c.join(" "))}})}function rr(e,t){if(typeof e=="function")return g(this,(l,u)=>{p(l)&&rr.call([l],e.call(l,u,l.attribs.class||"",t),t)});if(!e||typeof e!="string")return this;let s=e.split(Ce),n=s.length,a=typeof t=="boolean"?t?1:-1:0,c=this.length;for(let l=0;l<c;l++){let u=this[l];if(!p(u))continue;let f=et(u.attribs.class);for(let _=0;_<n;_++){let A=f.indexOf(s[_]);a>=0&&A<0?f.push(s[_]):a<=0&&A>=0&&f.splice(A,1)}u.attribs.class=f.join(" ")}return this}var Xt={};$(Xt,{add:()=>xa,addBack:()=>ya,children:()=>Ia,closest:()=>ua,contents:()=>Na,each:()=>Ra,end:()=>Fa,eq:()=>Ma,filter:()=>Oa,filterArray:()=>Gt,find:()=>Ea,first:()=>ba,get:()=>Ba,has:()=>Da,index:()=>Ha,is:()=>La,last:()=>Pa,map:()=>ga,next:()=>da,nextAll:()=>fa,nextUntil:()=>ma,not:()=>Sa,parent:()=>la,parents:()=>ha,parentsUntil:()=>Ta,prev:()=>_a,prevAll:()=>Aa,prevUntil:()=>Ca,siblings:()=>pa,slice:()=>Ua,toArray:()=>ka});var st=ne(Cn(),1);var ra=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function Ee(e){return e.type!=="pseudo"?!1:ra.has(e.name)?!0:e.name==="not"&&Array.isArray(e.data)?e.data.some(t=>t.some(Ee)):!1}function nr(e,t,s){let n=t!=null?parseInt(t,10):NaN;switch(e){case"first":return 1;case"nth":case"eq":return isFinite(n)?n>=0?n+1:1/0:0;case"lt":return isFinite(n)?n>=0?Math.min(n,s):1/0:0;case"gt":return isFinite(n)?1/0:0;case"odd":return 2*s;case"even":return 2*s-1;case"last":case"not":return 1/0}}function ar(e){for(;e.parent;)e=e.parent;return e}function tt(e){let t=[],s=[];for(let n of e)n.some(Ee)?t.push(n):s.push(n);return[s,t]}var na={type:de.Universal,namespace:null},aa={type:de.Pseudo,name:"scope",data:null};function yt(e,t,s={}){return wt([e],t,s)}function wt(e,t,s={}){if(typeof t=="function")return e.some(t);let[n,a]=tt(Ye(t));return n.length>0&&e.some(Qe(n,s))||a.some(c=>or(c,e,s).length>0)}function ia(e,t,s,n){let a=typeof s=="string"?parseInt(s,10):NaN;switch(e){case"first":case"lt":return t;case"last":return t.length>0?[t[t.length-1]]:t;case"nth":case"eq":return isFinite(a)&&Math.abs(a)<t.length?[a<0?t[t.length+a]:t[a]]:[];case"gt":return isFinite(a)?t.slice(a+1):[];case"even":return t.filter((c,l)=>l%2===0);case"odd":return t.filter((c,l)=>l%2===1);case"not":{let c=new Set(ir(s,t,n));return t.filter(l=>!c.has(l))}}}function vt(e,t,s={}){return ir(Ye(e),t,s)}function ir(e,t,s){if(t.length===0)return[];let[n,a]=tt(e),c;if(n.length){let l=xt(t,n,s);if(a.length===0)return l;l.length&&(c=new Set(l))}for(let l=0;l<a.length&&c?.size!==t.length;l++){let u=a[l];if((c?t.filter(A=>p(A)&&!c.has(A)):t).length===0)break;let _=or(u,t,s);if(_.length)if(c)_.forEach(A=>c.add(A));else{if(l===a.length-1)return _;c=new Set(_)}}return typeof c<"u"?c.size===t.length?t:t.filter(l=>c.has(l)):[]}function or(e,t,s){var n;if(e.some(fe)){let a=(n=s.root)!==null&&n!==void 0?n:ar(t[0]),c={...s,context:t,relativeSelector:!1};return e.push(aa),rt(a,e,c,!0,t.length)}return rt(t,e,s,!1,t.length)}function cr(e,t,s={},n=1/0){if(typeof e=="function")return Er(t,e);let[a,c]=tt(Ye(e)),l=c.map(u=>rt(t,u,s,!0,n));return a.length&&l.push(Ft(t,a,s,n)),l.length===0?[]:l.length===1?l[0]:Z(l.reduce((u,f)=>[...u,...f]))}function rt(e,t,s,n,a){let c=t.findIndex(Ee),l=t.slice(0,c),u=t[c],f=t.length-1===c?a:1/0,_=nr(u.name,u.data,f);if(_===0)return[];let C=(l.length===0&&!Array.isArray(e)?we(e).filter(p):l.length===0?(Array.isArray(e)?e:[e]).filter(p):n||l.some(fe)?Ft(e,[l],s,_):xt(e,[l],s)).slice(0,_),I=ia(u.name,C,u.data,s);if(I.length===0||t.length===c+1)return I;let R=t.slice(c+1),L=R.some(fe);if(L){if(fe(R[0])){let{type:M}=R[0];(M===de.Sibling||M===de.Adjacent)&&(I=Pt(I,bt,!0)),R.unshift(na)}s={...s,relativeSelector:!1,rootFunc:M=>I.includes(M)}}else s.rootFunc&&s.rootFunc!==st.trueFunc&&(s={...s,rootFunc:st.trueFunc});return R.some(Ee)?rt(I,R,s,!1,a):L?Ft(I,[R],s,a):xt(I,[R],s)}function Ft(e,t,s,n){let a=Qe(t,s,e);return Er(e,a,n)}function Er(e,t,s=1/0){let n=Pt(e,bt,t.shouldTestNextSiblings);return Os(a=>p(a)&&t(a),n,!0,s)}function xt(e,t,s){let n=(Array.isArray(e)?e:[e]).filter(p);if(n.length===0)return n;let a=Qe(t,s);return a===st.trueFunc?n:n.filter(a)}var ca=/^\s*[~+]/;function Ea(e){var t;if(!e)return this._make([]);let s=this.toArray();if(typeof e!="string"){let c=H(e)?e.toArray():[e];return this._make(c.filter(l=>s.some(u=>Mt(u,l))))}let n=ca.test(e)?s:this.children().toArray(),a={context:s,root:(t=this._root)===null||t===void 0?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(cr(e,n,a))}function Yt(e){return function(t,...s){return function(n){var a;let c=e(t,this);return n&&(c=Gt(c,n,this.options.xmlMode,(a=this._root)===null||a===void 0?void 0:a[0])),this._make(this.length>1&&c.length>1?s.reduce((l,u)=>u(l),c):c)}}}var pe=Yt((e,t)=>{let s=[];for(let n=0;n<t.length;n++){let a=e(t[n]);s.push(a)}return new Array().concat(...s)}),Qt=Yt((e,t)=>{let s=[];for(let n=0;n<t.length;n++){let a=e(t[n]);a!==null&&s.push(a)}return s});function Wt(e,...t){let s=null,n=Yt((a,c)=>{let l=[];return g(c,u=>{for(let f;(f=a(u))&&!s?.(f,l.length);u=f)l.push(f)}),l})(e,...t);return function(a,c){s=typeof a=="string"?u=>yt(u,a,this.options):a?Ie(a):null;let l=n.call(this,c);return s=null,l}}function le(e){return Array.from(new Set(e))}var la=Qt(({parent:e})=>e&&!W(e)?e:null,le),ha=pe(e=>{let t=[];for(;e.parent&&!W(e.parent);)t.push(e.parent),e=e.parent;return t},Z,e=>e.reverse()),Ta=Wt(({parent:e})=>e&&!W(e)?e:null,Z,e=>e.reverse());function ua(e){var t;let s=[];if(!e)return this._make(s);let n={xmlMode:this.options.xmlMode,root:(t=this._root)===null||t===void 0?void 0:t[0]},a=typeof e=="string"?c=>yt(c,e,n):Ie(e);return g(this,c=>{for(;c&&p(c);){if(a(c,0)){s.includes(c)||s.push(c);break}c=c.parent}}),this._make(s)}var da=Qt(e=>St(e)),fa=pe(e=>{let t=[];for(;e.next;)e=e.next,p(e)&&t.push(e);return t},le),ma=Wt(e=>St(e),le),_a=Qt(e=>Dt(e)),Aa=pe(e=>{let t=[];for(;e.prev;)e=e.prev,p(e)&&t.push(e);return t},le),Ca=Wt(e=>Dt(e),le),pa=pe(e=>gs(e).filter(t=>p(t)&&t!==e),Z),Ia=pe(e=>we(e).filter(p),le);function Na(){let e=this.toArray().reduce((t,s)=>U(s)?t.concat(s.children):t,[]);return this._make(e)}function Ra(e){let t=0,s=this.length;for(;t<s&&e.call(this[t],t,this[t])!==!1;)++t;return this}function ga(e){let t=[];for(let s=0;s<this.length;s++){let n=this[s],a=e.call(n,s,n);a!=null&&(t=t.concat(a))}return this._make(t)}function Ie(e){return typeof e=="function"?(t,s)=>e.call(t,s,t):H(e)?t=>Array.prototype.includes.call(e,t):function(t){return e===t}}function Oa(e){var t;return this._make(Gt(this.toArray(),e,this.options.xmlMode,(t=this._root)===null||t===void 0?void 0:t[0]))}function Gt(e,t,s,n){return typeof t=="string"?vt(t,e,{xmlMode:s,root:n}):e.filter(Ie(t))}function La(e){let t=this.toArray();return typeof e=="string"?wt(t.filter(p),e,this.options):e?t.some(Ie(e)):!1}function Sa(e){let t=this.toArray();if(typeof e=="string"){let s=new Set(vt(e,t,this.options));t=t.filter(n=>!s.has(n))}else{let s=Ie(e);t=t.filter((n,a)=>!s(n,a))}return this._make(t)}function Da(e){return this.filter(typeof e=="string"?`:has(${e})`:(t,s)=>this._make(s).find(e).length>0)}function ba(){return this.length>1?this._make(this[0]):this}function Pa(){return this.length>0?this._make(this[this.length-1]):this}function Ma(e){var t;return e=+e,e===0&&this.length<=1?this:(e<0&&(e=this.length+e),this._make((t=this[e])!==null&&t!==void 0?t:[]))}function Ba(e){return e==null?this.toArray():this[e<0?this.length+e:e]}function ka(){return Array.prototype.slice.call(this)}function Ha(e){let t,s;return e==null?(t=this.parent().children(),s=this[0]):typeof e=="string"?(t=this._make(e),s=this[0]):(t=this,s=H(e)?e[0]:e),Array.prototype.indexOf.call(t,s)}function Ua(e,t){return this._make(Array.prototype.slice.call(this,e,t))}function Fa(){var e;return(e=this.prevObject)!==null&&e!==void 0?e:this._make([])}function xa(e,t){let s=this._make(e,t),n=Z([...this.get(),...s.get()]);return this._make(n)}function ya(e){return this.prevObject?this.add(e?this.prevObject.filter(e):this.prevObject):this}var Kt={};$(Kt,{_makeDomArray:()=>wa,after:()=>ja,append:()=>Qa,appendTo:()=>va,before:()=>za,clone:()=>ni,empty:()=>ei,html:()=>ti,insertAfter:()=>qa,insertBefore:()=>$a,prepend:()=>Wa,prependTo:()=>Ya,remove:()=>Ja,replaceWith:()=>Za,text:()=>ri,toString:()=>si,unwrap:()=>Ka,wrap:()=>Ga,wrapAll:()=>Va,wrapInner:()=>Xa});function lr(e){return function(s,n,a,c){if(typeof Buffer<"u"&&Buffer.isBuffer(s)&&(s=s.toString()),typeof s=="string")return e(s,n,a,c);let l=s;if(!Array.isArray(l)&&W(l))return l;let u=new J([]);return K(l,u),u}}function K(e,t){let s=Array.isArray(e)?e:[e];t?t.children=s:t=null;for(let n=0;n<s.length;n++){let a=s[n];a.parent&&a.parent.children!==s&&ve(a),t?(a.prev=s[n-1]||null,a.next=s[n+1]||null):a.prev=a.next=null,a.parent=t}return t}function wa(e,t){return e==null?[]:H(e)?t?Je(e.get()):e.get():Array.isArray(e)?e.reduce((s,n)=>s.concat(this._makeDomArray(n,t)),[]):typeof e=="string"?this._parse(e,this.options,!1,null).children:t?Je([e]):[e]}function hr(e){return function(...t){let s=this.length-1;return g(this,(n,a)=>{if(!U(n))return;let c=typeof t[0]=="function"?t[0].call(n,a,this._render(n.children)):t,l=this._makeDomArray(c,a<s);e(l,n.children,n)})}}function V(e,t,s,n,a){var c,l;let u=[t,s,...n],f=t===0?null:e[t-1],_=t+s>=e.length?null:e[t+s];for(let A=0;A<n.length;++A){let C=n[A],I=C.parent;if(I){let L=I.children.indexOf(C);L>-1&&(I.children.splice(L,1),a===I&&t>L&&u[0]--)}C.parent=a,C.prev&&(C.prev.next=(c=C.next)!==null&&c!==void 0?c:null),C.next&&(C.next.prev=(l=C.prev)!==null&&l!==void 0?l:null),C.prev=A===0?f:n[A-1],C.next=A===n.length-1?_:n[A+1]}return f&&(f.next=n[0]),_&&(_.prev=n[n.length-1]),e.splice(...u)}function va(e){return(H(e)?e:this._make(e)).append(this),this}function Ya(e){return(H(e)?e:this._make(e)).prepend(this),this}var Qa=hr((e,t,s)=>{V(t,t.length,0,e,s)}),Wa=hr((e,t,s)=>{V(t,0,0,e,s)});function Tr(e){return function(t){let s=this.length-1,n=this.parents().last();for(let a=0;a<this.length;a++){let c=this[a],l=typeof t=="function"?t.call(c,a,c):typeof t=="string"&&!Ae(t)?n.find(t).clone():t,[u]=this._makeDomArray(l,a<s);if(!u||!U(u))continue;let f=u,_=0;for(;_<f.children.length;){let A=f.children[_];p(A)?(f=A,_=0):_++}e(c,f,[u])}return this}}var Ga=Tr((e,t,s)=>{let{parent:n}=e;if(!n)return;let a=n.children,c=a.indexOf(e);K([e],t),V(a,c,0,s,n)}),Xa=Tr((e,t,s)=>{U(e)&&(K(e.children,t),K(s,e))});function Ka(e){return this.parent(e).not("body").each((t,s)=>{this._make(s).replaceWith(s.children)}),this}function Va(e){let t=this[0];if(t){let s=this._make(typeof e=="function"?e.call(t,0,t):e).insertBefore(t),n;for(let c=0;c<s.length;c++)s[c].type==="tag"&&(n=s[c]);let a=0;for(;n&&a<n.children.length;){let c=n.children[a];c.type==="tag"?(n=c,a=0):a++}n&&this._make(n).append(this)}return this}function ja(...e){let t=this.length-1;return g(this,(s,n)=>{let{parent:a}=s;if(!U(s)||!a)return;let c=a.children,l=c.indexOf(s);if(l<0)return;let u=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,f=this._makeDomArray(u,n<t);V(c,l+1,0,f,a)})}function qa(e){typeof e=="string"&&(e=this._make(e)),this.remove();let t=[];return this._makeDomArray(e).forEach(s=>{let n=this.clone().toArray(),{parent:a}=s;if(!a)return;let c=a.children,l=c.indexOf(s);l<0||(V(c,l+1,0,n,a),t.push(...n))}),this._make(t)}function za(...e){let t=this.length-1;return g(this,(s,n)=>{let{parent:a}=s;if(!U(s)||!a)return;let c=a.children,l=c.indexOf(s);if(l<0)return;let u=typeof e[0]=="function"?e[0].call(s,n,this._render(s.children)):e,f=this._makeDomArray(u,n<t);V(c,l,0,f,a)})}function $a(e){let t=this._make(e);this.remove();let s=[];return g(t,n=>{let a=this.clone().toArray(),{parent:c}=n;if(!c)return;let l=c.children,u=l.indexOf(n);u<0||(V(l,u,0,a,c),s.push(...a))}),this._make(s)}function Ja(e){let t=e?this.filter(e):this;return g(t,s=>{ve(s),s.prev=s.next=s.parent=null}),this}function Za(e){return g(this,(t,s)=>{let{parent:n}=t;if(!n)return;let a=n.children,c=typeof e=="function"?e.call(t,s,t):e,l=this._makeDomArray(c);K(l,null);let u=a.indexOf(t);V(a,u,1,l,n),l.includes(t)||(t.parent=t.prev=t.next=null)})}function ei(){return g(this,e=>{U(e)&&(e.children.forEach(t=>{t.next=t.prev=t.parent=null}),e.children.length=0)})}function ti(e){if(e===void 0){let t=this[0];return!t||!U(t)?null:this._render(t.children)}return g(this,t=>{if(!U(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});let s=H(e)?e.toArray():this._parse(`${e}`,this.options,!1,t).children;K(s,t)})}function si(){return this._render(this)}function ri(e){return e===void 0?G(this):typeof e=="function"?g(this,(t,s)=>this._make(t).text(e.call(t,s,G([t])))):g(this,t=>{if(!U(t))return;t.children.forEach(n=>{n.next=n.prev=n.parent=null});let s=new Fe(`${e}`);K(s,t)})}function ni(){return this._make(Je(this.get()))}var Vt={};$(Vt,{css:()=>ai});function ai(e,t){if(e!=null&&t!=null||typeof e=="object"&&!Array.isArray(e))return g(this,(s,n)=>{p(s)&&ur(s,e,t,n)});if(this.length!==0)return dr(this[0],e)}function ur(e,t,s,n){if(typeof t=="string"){let a=dr(e),c=typeof s=="function"?s.call(e,n,a[t]):s;c===""?delete a[t]:c!=null&&(a[t]=c),e.attribs.style=ii(a)}else typeof t=="object"&&Object.keys(t).forEach((a,c)=>{ur(e,a,t[a],c)})}function dr(e,t){if(!e||!p(e))return;let s=oi(e.attribs.style);if(typeof t=="string")return s[t];if(Array.isArray(t)){let n={};return t.forEach(a=>{s[a]!=null&&(n[a]=s[a])}),n}return s}function ii(e){return Object.keys(e).reduce((t,s)=>`${t}${t?" ":""}${s}: ${e[s]};`,"")}function oi(e){if(e=(e||"").trim(),!e)return{};let t={},s;for(let n of e.split(";")){let a=n.indexOf(":");if(a<1||a===n.length-1){let c=n.trimEnd();c.length>0&&s!==void 0&&(t[s]+=`;${c}`)}else s=n.slice(0,a).trim(),t[s]=n.slice(a+1).trim()}return t}var jt={};$(jt,{serialize:()=>Ei,serializeArray:()=>li});var fr="input,select,textarea,keygen",ci=/%20/g,mr=/\r?\n/g;function Ei(){return this.serializeArray().map(s=>`${encodeURIComponent(s.name)}=${encodeURIComponent(s.value)}`).join("&").replace(ci,"+")}function li(){return this.map((e,t)=>{let s=this._make(t);return p(t)&&t.name==="form"?s.find(fr).toArray():s.filter(fr).toArray()}).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((e,t)=>{var s;let n=this._make(t),a=n.attr("name"),c=(s=n.val())!==null&&s!==void 0?s:"";return Array.isArray(c)?c.map(l=>({name:a,value:l.replace(mr,`\r
`)})):{name:a,value:c.replace(mr,`\r
`)}}).toArray()}var j=class{constructor(t,s,n){if(this.length=0,this.options=n,this._root=s,t){for(let a=0;a<t.length;a++)this[a]=t[a];this.length=t.length}}};j.prototype.cheerio="[cheerio object]";j.prototype.splice=Array.prototype.splice;j.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(j.prototype,Ut,Xt,Kt,Vt,jt);function _r(e,t){return function s(n,a,c=!0){if(n==null)throw new Error("cheerio.load() expects a string");let l={...me,..._e(a)},u=e(n,l,c,null);class f extends j{_make(C,I){let R=_(C,I);return R.prevObject=this,R}_parse(C,I,R,L){return e(C,I,R,L)}_render(C){return t(C,this.options)}}function _(A,C,I=u,R){if(A&&H(A))return A;let L={...l,..._e(R)},M=typeof I=="string"?[e(I,L,!1,null)]:"length"in I?I:[I],S=H(M)?M:new f(M,null,L);if(S._root=S,!A)return new f(void 0,S,L);let Es=typeof A=="string"&&Ae(A)?e(A,L,!1,null).children:hi(A)?[A]:Array.isArray(A)?A:void 0,ls=new f(Es,S,L);if(Es)return ls;if(typeof A!="string")throw new Error("Unexpected type of selector");let Rt=A,hs=C?typeof C=="string"?Ae(C)?new f([e(C,L,!1,null)],S,L):(Rt=`${C} ${Rt}`,S):H(C)?C:new f(Array.isArray(C)?C:[C],S,L):S;return hs?hs.find(Rt):ls}return Object.assign(_,X,{load:s,_root:u,_options:l,fn:f.prototype,prototype:f.prototype}),_}}function hi(e){return!!e.name||e.type==="root"||e.type==="text"||e.type==="comment"}var Ti=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),O="\uFFFD",i;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.NUMBER_SIGN=35]="NUMBER_SIGN",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",e[e.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_F=102]="LATIN_SMALL_F",e[e.LATIN_SMALL_X=120]="LATIN_SMALL_X",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",e[e.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(i=i||(i={}));var B={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function nt(e){return e>=55296&&e<=57343}function Ar(e){return e>=56320&&e<=57343}function Cr(e,t){return(e-55296)*1024+9216+t}function at(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function it(e){return e>=64976&&e<=65007||Ti.has(e)}var T;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(T=T||(T={}));var di=1<<16,ot=class{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=di,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t){let{line:s,col:n,offset:a}=this;return{code:t,startLine:s,endLine:s,startCol:n,endCol:n,startOffset:a,endOffset:a}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){let s=this.html.charCodeAt(this.pos+1);if(Ar(s))return this.pos++,this._addGap(),Cr(t,s)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,i.EOF;return this._err(T.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,s){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=s}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,s){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(s)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){let s=this.pos+t;if(s>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let n=this.html.charCodeAt(s);return n===i.CARRIAGE_RETURN?i.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let t=this.html.charCodeAt(this.pos);return t===i.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,i.LINE_FEED):t===i.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,nt(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===i.LINE_FEED||t===i.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){at(t)?this._err(T.controlCharacterInInputStream):it(t)&&this._err(T.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}};var N;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(N=N||(N={}));function ct(e,t){for(let s=e.attrs.length-1;s>=0;s--)if(e.attrs[s].name===t)return e.attrs[s].value;return null}var Et={};$(Et,{ATTRS:()=>x,DOCUMENT_MODE:()=>D,NS:()=>d,SPECIAL_ELEMENTS:()=>qt,TAG_ID:()=>r,TAG_NAMES:()=>h,getTagID:()=>q,hasUnescapedText:()=>zt,isNumberedHeader:()=>Ne});var d;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(d=d||(d={}));var x;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(x=x||(x={}));var D;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(D=D||(D={}));var h;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(h=h||(h={}));var r;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SECTION=94]="SECTION",e[e.SELECT=95]="SELECT",e[e.SOURCE=96]="SOURCE",e[e.SMALL=97]="SMALL",e[e.SPAN=98]="SPAN",e[e.STRIKE=99]="STRIKE",e[e.STRONG=100]="STRONG",e[e.STYLE=101]="STYLE",e[e.SUB=102]="SUB",e[e.SUMMARY=103]="SUMMARY",e[e.SUP=104]="SUP",e[e.TABLE=105]="TABLE",e[e.TBODY=106]="TBODY",e[e.TEMPLATE=107]="TEMPLATE",e[e.TEXTAREA=108]="TEXTAREA",e[e.TFOOT=109]="TFOOT",e[e.TD=110]="TD",e[e.TH=111]="TH",e[e.THEAD=112]="THEAD",e[e.TITLE=113]="TITLE",e[e.TR=114]="TR",e[e.TRACK=115]="TRACK",e[e.TT=116]="TT",e[e.U=117]="U",e[e.UL=118]="UL",e[e.SVG=119]="SVG",e[e.VAR=120]="VAR",e[e.WBR=121]="WBR",e[e.XMP=122]="XMP"})(r=r||(r={}));var mi=new Map([[h.A,r.A],[h.ADDRESS,r.ADDRESS],[h.ANNOTATION_XML,r.ANNOTATION_XML],[h.APPLET,r.APPLET],[h.AREA,r.AREA],[h.ARTICLE,r.ARTICLE],[h.ASIDE,r.ASIDE],[h.B,r.B],[h.BASE,r.BASE],[h.BASEFONT,r.BASEFONT],[h.BGSOUND,r.BGSOUND],[h.BIG,r.BIG],[h.BLOCKQUOTE,r.BLOCKQUOTE],[h.BODY,r.BODY],[h.BR,r.BR],[h.BUTTON,r.BUTTON],[h.CAPTION,r.CAPTION],[h.CENTER,r.CENTER],[h.CODE,r.CODE],[h.COL,r.COL],[h.COLGROUP,r.COLGROUP],[h.DD,r.DD],[h.DESC,r.DESC],[h.DETAILS,r.DETAILS],[h.DIALOG,r.DIALOG],[h.DIR,r.DIR],[h.DIV,r.DIV],[h.DL,r.DL],[h.DT,r.DT],[h.EM,r.EM],[h.EMBED,r.EMBED],[h.FIELDSET,r.FIELDSET],[h.FIGCAPTION,r.FIGCAPTION],[h.FIGURE,r.FIGURE],[h.FONT,r.FONT],[h.FOOTER,r.FOOTER],[h.FOREIGN_OBJECT,r.FOREIGN_OBJECT],[h.FORM,r.FORM],[h.FRAME,r.FRAME],[h.FRAMESET,r.FRAMESET],[h.H1,r.H1],[h.H2,r.H2],[h.H3,r.H3],[h.H4,r.H4],[h.H5,r.H5],[h.H6,r.H6],[h.HEAD,r.HEAD],[h.HEADER,r.HEADER],[h.HGROUP,r.HGROUP],[h.HR,r.HR],[h.HTML,r.HTML],[h.I,r.I],[h.IMG,r.IMG],[h.IMAGE,r.IMAGE],[h.INPUT,r.INPUT],[h.IFRAME,r.IFRAME],[h.KEYGEN,r.KEYGEN],[h.LABEL,r.LABEL],[h.LI,r.LI],[h.LINK,r.LINK],[h.LISTING,r.LISTING],[h.MAIN,r.MAIN],[h.MALIGNMARK,r.MALIGNMARK],[h.MARQUEE,r.MARQUEE],[h.MATH,r.MATH],[h.MENU,r.MENU],[h.META,r.META],[h.MGLYPH,r.MGLYPH],[h.MI,r.MI],[h.MO,r.MO],[h.MN,r.MN],[h.MS,r.MS],[h.MTEXT,r.MTEXT],[h.NAV,r.NAV],[h.NOBR,r.NOBR],[h.NOFRAMES,r.NOFRAMES],[h.NOEMBED,r.NOEMBED],[h.NOSCRIPT,r.NOSCRIPT],[h.OBJECT,r.OBJECT],[h.OL,r.OL],[h.OPTGROUP,r.OPTGROUP],[h.OPTION,r.OPTION],[h.P,r.P],[h.PARAM,r.PARAM],[h.PLAINTEXT,r.PLAINTEXT],[h.PRE,r.PRE],[h.RB,r.RB],[h.RP,r.RP],[h.RT,r.RT],[h.RTC,r.RTC],[h.RUBY,r.RUBY],[h.S,r.S],[h.SCRIPT,r.SCRIPT],[h.SECTION,r.SECTION],[h.SELECT,r.SELECT],[h.SOURCE,r.SOURCE],[h.SMALL,r.SMALL],[h.SPAN,r.SPAN],[h.STRIKE,r.STRIKE],[h.STRONG,r.STRONG],[h.STYLE,r.STYLE],[h.SUB,r.SUB],[h.SUMMARY,r.SUMMARY],[h.SUP,r.SUP],[h.TABLE,r.TABLE],[h.TBODY,r.TBODY],[h.TEMPLATE,r.TEMPLATE],[h.TEXTAREA,r.TEXTAREA],[h.TFOOT,r.TFOOT],[h.TD,r.TD],[h.TH,r.TH],[h.THEAD,r.THEAD],[h.TITLE,r.TITLE],[h.TR,r.TR],[h.TRACK,r.TRACK],[h.TT,r.TT],[h.U,r.U],[h.UL,r.UL],[h.SVG,r.SVG],[h.VAR,r.VAR],[h.WBR,r.WBR],[h.XMP,r.XMP]]);function q(e){var t;return(t=mi.get(e))!==null&&t!==void 0?t:r.UNKNOWN}var m=r,qt={[d.HTML]:new Set([m.ADDRESS,m.APPLET,m.AREA,m.ARTICLE,m.ASIDE,m.BASE,m.BASEFONT,m.BGSOUND,m.BLOCKQUOTE,m.BODY,m.BR,m.BUTTON,m.CAPTION,m.CENTER,m.COL,m.COLGROUP,m.DD,m.DETAILS,m.DIR,m.DIV,m.DL,m.DT,m.EMBED,m.FIELDSET,m.FIGCAPTION,m.FIGURE,m.FOOTER,m.FORM,m.FRAME,m.FRAMESET,m.H1,m.H2,m.H3,m.H4,m.H5,m.H6,m.HEAD,m.HEADER,m.HGROUP,m.HR,m.HTML,m.IFRAME,m.IMG,m.INPUT,m.LI,m.LINK,m.LISTING,m.MAIN,m.MARQUEE,m.MENU,m.META,m.NAV,m.NOEMBED,m.NOFRAMES,m.NOSCRIPT,m.OBJECT,m.OL,m.P,m.PARAM,m.PLAINTEXT,m.PRE,m.SCRIPT,m.SECTION,m.SELECT,m.SOURCE,m.STYLE,m.SUMMARY,m.TABLE,m.TBODY,m.TD,m.TEMPLATE,m.TEXTAREA,m.TFOOT,m.TH,m.THEAD,m.TITLE,m.TR,m.TRACK,m.UL,m.WBR,m.XMP]),[d.MATHML]:new Set([m.MI,m.MO,m.MN,m.MS,m.MTEXT,m.ANNOTATION_XML]),[d.SVG]:new Set([m.TITLE,m.FOREIGN_OBJECT,m.DESC]),[d.XLINK]:new Set,[d.XML]:new Set,[d.XMLNS]:new Set};function Ne(e){return e===m.H1||e===m.H2||e===m.H3||e===m.H4||e===m.H5||e===m.H6}var _i=new Set([h.STYLE,h.SCRIPT,h.XMP,h.IFRAME,h.NOEMBED,h.NOFRAMES,h.PLAINTEXT]);function zt(e,t){return _i.has(e)||t&&e===h.NOSCRIPT}var Ai=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),o;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",e[e.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",e[e.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",e[e.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",e[e.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",e[e.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(o||(o={}));var b={DATA:o.DATA,RCDATA:o.RCDATA,RAWTEXT:o.RAWTEXT,SCRIPT_DATA:o.SCRIPT_DATA,PLAINTEXT:o.PLAINTEXT,CDATA_SECTION:o.CDATA_SECTION};function ge(e){return e>=i.DIGIT_0&&e<=i.DIGIT_9}function Re(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_Z}function Ci(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_Z}function z(e){return Ci(e)||Re(e)}function $t(e){return z(e)||ge(e)}function Ir(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_F}function Nr(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_F}function pi(e){return ge(e)||Ir(e)||Nr(e)}function lt(e){return e+32}function Rr(e){return e===i.SPACE||e===i.LINE_FEED||e===i.TABULATION||e===i.FORM_FEED}function Ii(e){return e===i.EQUALS_SIGN||$t(e)}function pr(e){return Rr(e)||e===i.SOLIDUS||e===i.GREATER_THAN_SIGN}var Oe=class{constructor(t,s){this.options=t,this.handler=s,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=o.DATA,this.returnState=o.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new ot(s),this.currentLocation=this.getCurrentLocation(-1)}_err(t){var s,n;(n=(s=this.handler).onParseError)===null||n===void 0||n.call(s,this.preprocessor.getError(t))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;let t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t?.())}write(t,s,n){this.active=!0,this.preprocessor.write(t,s),this._runParsingLoop(),this.paused||n?.()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(t){this.consumedAfterSnapshot-=t,this.preprocessor.retreat(t)}_reconsumeInState(t,s){this.state=t,this._callState(s)}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let s=0;s<t;s++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,s){return this.preprocessor.startsWith(t,s)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:N.START_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:N.END_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:N.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:N.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,s){this.currentCharacterToken={type:t,chars:s,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,s;let n=this.currentToken;if(ct(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){let a=(t=(s=n.location).attrs)!==null&&t!==void 0?t:s.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(T.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){let t=this.currentToken;this.prepareToken(t),t.tagID=q(t.tagName),t.type===N.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(T.endTagWithAttributes),t.selfClosing&&this._err(T.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case N.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case N.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case N.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){let t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:N.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,s){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==t)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=s;return}this._createCharacterToken(t,s)}_emitCodePoint(t){let s=Rr(t)?N.WHITESPACE_CHARACTER:t===i.NULL?N.NULL_CHARACTER:N.CHARACTER;this._appendCharToCurrentCharacterToken(s,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(N.CHARACTER,t)}_matchNamedCharacterReference(t){let s=null,n=0,a=!1;for(let c=0,l=Q[0];c>=0&&(c=fs(Q,l,c+1,t),!(c<0));t=this._consume()){n+=1,l=Q[c];let u=l&gt.VALUE_LENGTH;if(u){let f=(u>>14)-1;if(t!==i.SEMICOLON&&this._isCharacterReferenceInAttribute()&&Ii(this.preprocessor.peek(1))?(s=[i.AMPERSAND],c+=f):(s=f===0?[Q[c]&~gt.VALUE_LENGTH]:f===1?[Q[++c]]:[Q[++c],Q[++c]],n=0,a=t!==i.SEMICOLON),f===0){this._consume();break}}}return this._unconsume(n),a&&!this.preprocessor.endOfChunkHit&&this._err(T.missingSemicolonAfterCharacterReference),this._unconsume(1),s}_isCharacterReferenceInAttribute(){return this.returnState===o.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===o.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===o.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case o.DATA:{this._stateData(t);break}case o.RCDATA:{this._stateRcdata(t);break}case o.RAWTEXT:{this._stateRawtext(t);break}case o.SCRIPT_DATA:{this._stateScriptData(t);break}case o.PLAINTEXT:{this._statePlaintext(t);break}case o.TAG_OPEN:{this._stateTagOpen(t);break}case o.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case o.TAG_NAME:{this._stateTagName(t);break}case o.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case o.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case o.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case o.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case o.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case o.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case o.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case o.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case o.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case o.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case o.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case o.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case o.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case o.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case o.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case o.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case o.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case o.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case o.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case o.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case o.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case o.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case o.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case o.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case o.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case o.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case o.BOGUS_COMMENT:{this._stateBogusComment(t);break}case o.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case o.COMMENT_START:{this._stateCommentStart(t);break}case o.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case o.COMMENT:{this._stateComment(t);break}case o.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case o.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case o.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case o.COMMENT_END:{this._stateCommentEnd(t);break}case o.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case o.DOCTYPE:{this._stateDoctype(t);break}case o.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case o.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case o.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case o.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case o.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case o.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case o.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case o.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case o.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case o.CDATA_SECTION:{this._stateCdataSection(t);break}case o.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case o.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case o.CHARACTER_REFERENCE:{this._stateCharacterReference(t);break}case o.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(t);break}case o.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}case o.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(t);break}case o.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(t);break}case o.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(t);break}case o.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(t);break}case o.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.TAG_OPEN;break}case i.AMPERSAND:{this.returnState=o.DATA,this.state=o.CHARACTER_REFERENCE;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitCodePoint(t);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case i.AMPERSAND:{this.returnState=o.RCDATA,this.state=o.CHARACTER_REFERENCE;break}case i.LESS_THAN_SIGN:{this.state=o.RCDATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitChars(O);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.RAWTEXT_LESS_THAN_SIGN;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitChars(O);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitChars(O);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitChars(O);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(z(t))this._createStartTagToken(),this.state=o.TAG_NAME,this._stateTagName(t);else switch(t){case i.EXCLAMATION_MARK:{this.state=o.MARKUP_DECLARATION_OPEN;break}case i.SOLIDUS:{this.state=o.END_TAG_OPEN;break}case i.QUESTION_MARK:{this._err(T.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t);break}case i.EOF:{this._err(T.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(T.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=o.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(z(t))this._createEndTagToken(),this.state=o.TAG_NAME,this._stateTagName(t);else switch(t){case i.GREATER_THAN_SIGN:{this._err(T.missingEndTagName),this.state=o.DATA;break}case i.EOF:{this._err(T.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(T.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this.state=o.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.tagName+=O;break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:s.tagName+=String.fromCodePoint(Re(t)?lt(t):t)}}_stateRcdataLessThanSign(t){t===i.SOLIDUS?this.state=o.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=o.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){z(t)?(this.state=o.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=o.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();let s=this.currentToken;switch(s.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=o.BEFORE_ATTRIBUTE_NAME,!1;case i.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=o.SELF_CLOSING_START_TAG,!1;case i.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=o.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===i.SOLIDUS?this.state=o.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){z(t)?(this.state=o.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case i.SOLIDUS:{this.state=o.SCRIPT_DATA_END_TAG_OPEN;break}case i.EXCLAMATION_MARK:{this.state=o.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=o.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){z(t)?(this.state=o.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===i.HYPHEN_MINUS?(this.state=o.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===i.HYPHEN_MINUS?(this.state=o.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=o.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitChars(O);break}case i.EOF:{this._err(T.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_ESCAPED,this._emitChars(O);break}case i.EOF:{this._err(T.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.GREATER_THAN_SIGN:{this.state=o.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_ESCAPED,this._emitChars(O);break}case i.EOF:{this._err(T.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===i.SOLIDUS?this.state=o.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:z(t)?(this._emitChars("<"),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){z(t)?(this.state=o.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(B.SCRIPT,!1)&&pr(this.preprocessor.peek(B.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<B.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=o.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(T.unexpectedNullCharacter),this._emitChars(O);break}case i.EOF:{this._err(T.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(O);break}case i.EOF:{this._err(T.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.GREATER_THAN_SIGN:{this.state=o.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(O);break}case i.EOF:{this._err(T.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===i.SOLIDUS?(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(B.SCRIPT,!1)&&pr(this.preprocessor.peek(B.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<B.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=o.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=o.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this.state=o.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._err(T.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=o.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=o.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this._leaveAttrName(),this.state=o.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._leaveAttrName(),this.state=o.BEFORE_ATTRIBUTE_VALUE;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:{this._err(T.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.currentAttr.name+=O;break}default:this.currentAttr.name+=String.fromCodePoint(Re(t)?lt(t):t)}}_stateAfterAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:{this.state=o.SELF_CLOSING_START_TAG;break}case i.EQUALS_SIGN:{this.state=o.BEFORE_ATTRIBUTE_VALUE;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=o.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{this.state=o.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this.state=o.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(T.missingAttributeValue),this.state=o.DATA,this.emitCurrentTagToken();break}default:this.state=o.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this.returnState=o.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=o.CHARACTER_REFERENCE;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.currentAttr.value+=O;break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case i.APOSTROPHE:{this.state=o.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this.returnState=o.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=o.CHARACTER_REFERENCE;break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.currentAttr.value+=O;break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.AMPERSAND:{this.returnState=o.ATTRIBUTE_VALUE_UNQUOTED,this.state=o.CHARACTER_REFERENCE;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=o.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(T.unexpectedNullCharacter),this.currentAttr.value+=O;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:case i.EQUALS_SIGN:case i.GRAVE_ACCENT:{this._err(T.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=o.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this._leaveAttrValue(),this.state=o.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:this._err(T.missingWhitespaceBetweenAttributes),this.state=o.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case i.GREATER_THAN_SIGN:{let s=this.currentToken;s.selfClosing=!0,this.state=o.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(T.eofInTag),this._emitEOFToken();break}default:this._err(T.unexpectedSolidusInTag),this.state=o.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this.emitCurrentComment(s),this._emitEOFToken();break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.data+=O;break}default:s.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(B.DASH_DASH,!0)?(this._createCommentToken(B.DASH_DASH.length+1),this.state=o.COMMENT_START):this._consumeSequenceIfMatch(B.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(B.DOCTYPE.length+1),this.state=o.DOCTYPE):this._consumeSequenceIfMatch(B.CDATA_START,!0)?this.inForeignNode?this.state=o.CDATA_SECTION:(this._err(T.cdataInHtmlContent),this._createCommentToken(B.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=o.BOGUS_COMMENT):this._ensureHibernation()||(this._err(T.incorrectlyOpenedComment),this._createCommentToken(2),this.state=o.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_START_DASH;break}case i.GREATER_THAN_SIGN:{this._err(T.abruptClosingOfEmptyComment),this.state=o.DATA;let s=this.currentToken;this.emitCurrentComment(s);break}default:this.state=o.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END;break}case i.GREATER_THAN_SIGN:{this._err(T.abruptClosingOfEmptyComment),this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(T.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=o.COMMENT,this._stateComment(t)}}_stateComment(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END_DASH;break}case i.LESS_THAN_SIGN:{s.data+="<",this.state=o.COMMENT_LESS_THAN_SIGN;break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.data+=O;break}case i.EOF:{this._err(T.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){let s=this.currentToken;switch(t){case i.EXCLAMATION_MARK:{s.data+="!",this.state=o.COMMENT_LESS_THAN_SIGN_BANG;break}case i.LESS_THAN_SIGN:{s.data+="<";break}default:this.state=o.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===i.HYPHEN_MINUS?this.state=o.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=o.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===i.HYPHEN_MINUS?this.state=o.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=o.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==i.GREATER_THAN_SIGN&&t!==i.EOF&&this._err(T.nestedComment),this.state=o.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=o.COMMENT_END;break}case i.EOF:{this._err(T.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=o.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentComment(s);break}case i.EXCLAMATION_MARK:{this.state=o.COMMENT_END_BANG;break}case i.HYPHEN_MINUS:{s.data+="-";break}case i.EOF:{this._err(T.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--",this.state=o.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){let s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{s.data+="--!",this.state=o.COMMENT_END_DASH;break}case i.GREATER_THAN_SIGN:{this._err(T.incorrectlyClosedComment),this.state=o.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(T.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--!",this.state=o.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=o.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case i.EOF:{this._err(T.eofInDoctype),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingWhitespaceBeforeDoctypeName),this.state=o.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(Re(t))this._createDoctypeToken(String.fromCharCode(lt(t))),this.state=o.DOCTYPE_NAME;else switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.NULL:{this._err(T.unexpectedNullCharacter),this._createDoctypeToken(O),this.state=o.DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this._err(T.missingDoctypeName),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(T.eofInDoctype),this._createDoctypeToken(null);let s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=o.DOCTYPE_NAME}}_stateDoctypeName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.AFTER_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.name+=O;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.name+=String.fromCodePoint(Re(t)?lt(t):t)}}_stateAfterDoctypeName(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(B.PUBLIC,!1)?this.state=o.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(B.SYSTEM,!1)?this.state=o.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(T.invalidCharacterSequenceAfterDoctypeName),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(T.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(T.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(T.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.publicId="",this.state=o.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(T.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){let s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.publicId+=O;break}case i.GREATER_THAN_SIGN:{this._err(T.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){let s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=o.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.publicId+=O;break}case i.GREATER_THAN_SIGN:{this._err(T.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case i.GREATER_THAN_SIGN:{this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.QUOTATION_MARK:{this._err(T.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(T.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.QUOTATION_MARK:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=o.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(T.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(T.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(T.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=o.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(T.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){let s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.systemId+=O;break}case i.GREATER_THAN_SIGN:{this._err(T.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){let s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=o.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(T.unexpectedNullCharacter),s.systemId+=O;break}case i.GREATER_THAN_SIGN:{this._err(T.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){let s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.EOF:{this._err(T.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(T.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=o.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){let s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=o.DATA;break}case i.NULL:{this._err(T.unexpectedNullCharacter);break}case i.EOF:{this.emitCurrentDoctype(s),this._emitEOFToken();break}default:}}_stateCdataSection(t){switch(t){case i.RIGHT_SQUARE_BRACKET:{this.state=o.CDATA_SECTION_BRACKET;break}case i.EOF:{this._err(T.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===i.RIGHT_SQUARE_BRACKET?this.state=o.CDATA_SECTION_END:(this._emitChars("]"),this.state=o.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case i.GREATER_THAN_SIGN:{this.state=o.DATA;break}case i.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=o.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(t){t===i.NUMBER_SIGN?this.state=o.NUMERIC_CHARACTER_REFERENCE:$t(t)?(this.state=o.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(t)):(this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._reconsumeInState(this.returnState,t))}_stateNamedCharacterReference(t){let s=this._matchNamedCharacterReference(t);if(!this._ensureHibernation())if(s){for(let n=0;n<s.length;n++)this._flushCodePointConsumedAsCharacterReference(s[n]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this.state=o.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(t){$t(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===i.SEMICOLON&&this._err(T.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,t))}_stateNumericCharacterReference(t){this.charRefCode=0,t===i.LATIN_SMALL_X||t===i.LATIN_CAPITAL_X?this.state=o.HEXADEMICAL_CHARACTER_REFERENCE_START:ge(t)?(this.state=o.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(t)):(this._err(T.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.NUMBER_SIGN),this._reconsumeInState(this.returnState,t))}_stateHexademicalCharacterReferenceStart(t){pi(t)?(this.state=o.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(t)):(this._err(T.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(t){Ir(t)?this.charRefCode=this.charRefCode*16+t-55:Nr(t)?this.charRefCode=this.charRefCode*16+t-87:ge(t)?this.charRefCode=this.charRefCode*16+t-48:t===i.SEMICOLON?this.state=o.NUMERIC_CHARACTER_REFERENCE_END:(this._err(T.missingSemicolonAfterCharacterReference),this.state=o.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateDecimalCharacterReference(t){ge(t)?this.charRefCode=this.charRefCode*10+t-48:t===i.SEMICOLON?this.state=o.NUMERIC_CHARACTER_REFERENCE_END:(this._err(T.missingSemicolonAfterCharacterReference),this.state=o.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateNumericCharacterReferenceEnd(t){if(this.charRefCode===i.NULL)this._err(T.nullCharacterReference),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(T.characterReferenceOutsideUnicodeRange),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(nt(this.charRefCode))this._err(T.surrogateCharacterReference),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(it(this.charRefCode))this._err(T.noncharacterCharacterReference);else if(at(this.charRefCode)||this.charRefCode===i.CARRIAGE_RETURN){this._err(T.controlCharacterReference);let s=Ai.get(this.charRefCode);s!==void 0&&(this.charRefCode=s)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,t)}};var Or=new Set([r.DD,r.DT,r.LI,r.OPTGROUP,r.OPTION,r.P,r.RB,r.RP,r.RT,r.RTC]),gr=new Set([...Or,r.CAPTION,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]),ht=new Map([[r.APPLET,d.HTML],[r.CAPTION,d.HTML],[r.HTML,d.HTML],[r.MARQUEE,d.HTML],[r.OBJECT,d.HTML],[r.TABLE,d.HTML],[r.TD,d.HTML],[r.TEMPLATE,d.HTML],[r.TH,d.HTML],[r.ANNOTATION_XML,d.MATHML],[r.MI,d.MATHML],[r.MN,d.MATHML],[r.MO,d.MATHML],[r.MS,d.MATHML],[r.MTEXT,d.MATHML],[r.DESC,d.SVG],[r.FOREIGN_OBJECT,d.SVG],[r.TITLE,d.SVG]]),Ni=[r.H1,r.H2,r.H3,r.H4,r.H5,r.H6],Ri=[r.TR,r.TEMPLATE,r.HTML],gi=[r.TBODY,r.TFOOT,r.THEAD,r.TEMPLATE,r.HTML],Oi=[r.TABLE,r.TEMPLATE,r.HTML],Li=[r.TD,r.TH],Tt=class{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,s,n){this.treeAdapter=s,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=r.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===r.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===d.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,s){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=s,this.currentTagId=s,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,s,!0)}pop(){let t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,s){let n=this._indexOf(t);this.items[n]=s,n===this.stackTop&&(this.current=s)}insertAfter(t,s,n){let a=this._indexOf(t)+1;this.items.splice(a,0,s),this.tagIDs.splice(a,0,n),this.stackTop++,a===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(t){let s=this.stackTop+1;do s=this.tagIDs.lastIndexOf(t,s-1);while(s>0&&this.treeAdapter.getNamespaceURI(this.items[s])!==d.HTML);this.shortenToLength(s<0?0:s)}shortenToLength(t){for(;this.stackTop>=t;){let s=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(s,this.stackTop<t)}}popUntilElementPopped(t){let s=this._indexOf(t);this.shortenToLength(s<0?0:s)}popUntilPopped(t,s){let n=this._indexOfTagNames(t,s);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(Ni,d.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Li,d.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,s){for(let n=this.stackTop;n>=0;n--)if(t.includes(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===s)return n;return-1}clearBackTo(t,s){let n=this._indexOfTagNames(t,s);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(Oi,d.HTML)}clearBackToTableBodyContext(){this.clearBackTo(gi,d.HTML)}clearBackToTableRowContext(){this.clearBackTo(Ri,d.HTML)}remove(t){let s=this._indexOf(t);s>=0&&(s===this.stackTop?this.pop():(this.items.splice(s,1),this.tagIDs.splice(s,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===r.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){let s=this._indexOf(t)-1;return s>=0?this.items[s]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===r.HTML}hasInScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s],a=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&a===d.HTML)return!0;if(ht.get(n)===a)return!1}return!0}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){let s=this.tagIDs[t],n=this.treeAdapter.getNamespaceURI(this.items[t]);if(Ne(s)&&n===d.HTML)return!0;if(ht.get(s)===n)return!1}return!0}hasInListItemScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s],a=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&a===d.HTML)return!0;if((n===r.UL||n===r.OL)&&a===d.HTML||ht.get(n)===a)return!1}return!0}hasInButtonScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s],a=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&a===d.HTML)return!0;if(n===r.BUTTON&&a===d.HTML||ht.get(n)===a)return!1}return!0}hasInTableScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s];if(this.treeAdapter.getNamespaceURI(this.items[s])===d.HTML){if(n===t)return!0;if(n===r.TABLE||n===r.TEMPLATE||n===r.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--){let s=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===d.HTML){if(s===r.TBODY||s===r.THEAD||s===r.TFOOT)return!0;if(s===r.TABLE||s===r.HTML)return!1}}return!0}hasInSelectScope(t){for(let s=this.stackTop;s>=0;s--){let n=this.tagIDs[s];if(this.treeAdapter.getNamespaceURI(this.items[s])===d.HTML){if(n===t)return!0;if(n!==r.OPTION&&n!==r.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;Or.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;gr.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&gr.has(this.currentTagId);)this.pop()}};var F;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(F=F||(F={}));var Lr={type:F.Marker},ut=class{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,s){let n=[],a=s.length,c=this.treeAdapter.getTagName(t),l=this.treeAdapter.getNamespaceURI(t);for(let u=0;u<this.entries.length;u++){let f=this.entries[u];if(f.type===F.Marker)break;let{element:_}=f;if(this.treeAdapter.getTagName(_)===c&&this.treeAdapter.getNamespaceURI(_)===l){let A=this.treeAdapter.getAttrList(_);A.length===a&&n.push({idx:u,attrs:A})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<3)return;let s=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,s);if(n.length<3)return;let a=new Map(s.map(l=>[l.name,l.value])),c=0;for(let l=0;l<n.length;l++){let u=n[l];u.attrs.every(f=>a.get(f.name)===f.value)&&(c+=1,c>=3&&this.entries.splice(u.idx,1))}}insertMarker(){this.entries.unshift(Lr)}pushElement(t,s){this._ensureNoahArkCondition(t),this.entries.unshift({type:F.Element,element:t,token:s})}insertElementAfterBookmark(t,s){let n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:F.Element,element:t,token:s})}removeEntry(t){let s=this.entries.indexOf(t);s>=0&&this.entries.splice(s,1)}clearToLastMarker(){let t=this.entries.indexOf(Lr);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){let s=this.entries.find(n=>n.type===F.Marker||this.treeAdapter.getTagName(n.element)===t);return s&&s.type===F.Element?s:null}getElementEntry(t){return this.entries.find(s=>s.type===F.Element&&s.element===t)}};function Sr(e){return{nodeName:"#text",value:e,parentNode:null}}var v={createDocument(){return{nodeName:"#document",mode:D.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,s){return{nodeName:e,tagName:e,attrs:s,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,s){let n=e.childNodes.indexOf(s);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,s,n){let a=e.childNodes.find(c=>c.nodeName==="#documentType");if(a)a.name=t,a.publicId=s,a.systemId=n;else{let c={nodeName:"#documentType",name:t,publicId:s,systemId:n,parentNode:null};v.appendChild(e,c)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){let t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){let s=e.childNodes[e.childNodes.length-1];if(v.isTextNode(s)){s.value+=t;return}}v.appendChild(e,Sr(t))},insertTextBefore(e,t,s){let n=e.childNodes[e.childNodes.indexOf(s)-1];n&&v.isTextNode(n)?n.value+=t:v.insertBefore(e,Sr(t),s)},adoptAttributes(e,t){let s=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)s.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};var br="html",Si="about:legacy-compat",Di="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Pr=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],bi=[...Pr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],Pi=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),Mr=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],Mi=[...Mr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function Dr(e,t){return t.some(s=>e.startsWith(s))}function Br(e){return e.name===br&&e.publicId===null&&(e.systemId===null||e.systemId===Si)}function kr(e){if(e.name!==br)return D.QUIRKS;let{systemId:t}=e;if(t&&t.toLowerCase()===Di)return D.QUIRKS;let{publicId:s}=e;if(s!==null){if(s=s.toLowerCase(),Pi.has(s))return D.QUIRKS;let n=t===null?bi:Pr;if(Dr(s,n))return D.QUIRKS;if(n=t===null?Mr:Mi,Dr(s,n))return D.LIMITED_QUIRKS}return D.NO_QUIRKS}var Hr={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},ki="definitionurl",Hi="definitionURL",Ui=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),Fi=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:d.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:d.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:d.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:d.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:d.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:d.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:d.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:d.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:d.XML}],["xml:space",{prefix:"xml",name:"space",namespace:d.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:d.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:d.XMLNS}]]),xi=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),yi=new Set([r.B,r.BIG,r.BLOCKQUOTE,r.BODY,r.BR,r.CENTER,r.CODE,r.DD,r.DIV,r.DL,r.DT,r.EM,r.EMBED,r.H1,r.H2,r.H3,r.H4,r.H5,r.H6,r.HEAD,r.HR,r.I,r.IMG,r.LI,r.LISTING,r.MENU,r.META,r.NOBR,r.OL,r.P,r.PRE,r.RUBY,r.S,r.SMALL,r.SPAN,r.STRONG,r.STRIKE,r.SUB,r.SUP,r.TABLE,r.TT,r.U,r.UL,r.VAR]);function Ur(e){let t=e.tagID;return t===r.FONT&&e.attrs.some(({name:n})=>n===x.COLOR||n===x.SIZE||n===x.FACE)||yi.has(t)}function Jt(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===ki){e.attrs[t].name=Hi;break}}function Zt(e){for(let t=0;t<e.attrs.length;t++){let s=Ui.get(e.attrs[t].name);s!=null&&(e.attrs[t].name=s)}}function dt(e){for(let t=0;t<e.attrs.length;t++){let s=Fi.get(e.attrs[t].name);s&&(e.attrs[t].prefix=s.prefix,e.attrs[t].name=s.name,e.attrs[t].namespace=s.namespace)}}function Fr(e){let t=xi.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=q(e.tagName))}function wi(e,t){return t===d.MATHML&&(e===r.MI||e===r.MO||e===r.MN||e===r.MS||e===r.MTEXT)}function vi(e,t,s){if(t===d.MATHML&&e===r.ANNOTATION_XML){for(let n=0;n<s.length;n++)if(s[n].name===x.ENCODING){let a=s[n].value.toLowerCase();return a===Hr.TEXT_HTML||a===Hr.APPLICATION_XML}}return t===d.SVG&&(e===r.FOREIGN_OBJECT||e===r.DESC||e===r.TITLE)}function xr(e,t,s,n){return(!n||n===d.HTML)&&vi(e,t,s)||(!n||n===d.MATHML)&&wi(e,t)}var Yi="hidden",Qi=8,Wi=3,E;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(E||(E={}));var Gi={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Qr=new Set([r.TABLE,r.TBODY,r.TFOOT,r.THEAD,r.TR]),wr={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:v,onParseError:null},he=class{constructor(t,s,n=null,a=null){this.fragmentContext=n,this.scriptHandler=a,this.currentToken=null,this.stopped=!1,this.insertionMode=E.INITIAL,this.originalInsertionMode=E.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...wr,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=s??this.treeAdapter.createDocument(),this.tokenizer=new Oe(this.options,this),this.activeFormattingElements=new ut(this.treeAdapter),this.fragmentContextID=n?q(this.treeAdapter.getTagName(n)):r.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new Tt(this.document,this.treeAdapter,this)}static parse(t,s){let n=new this(s);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,s){let n={...wr,...s};t??(t=n.treeAdapter.createElement(h.TEMPLATE,d.HTML,[]));let a=n.treeAdapter.createElement("documentmock",d.HTML,[]),c=new this(n,a,t);return c.fragmentContextID===r.TEMPLATE&&c.tmplInsertionModeStack.unshift(E.IN_TEMPLATE),c._initTokenizerForFragmentParsing(),c._insertFakeRootElement(),c._resetInsertionMode(),c._findFormInFragmentContext(),c}getFragment(){let t=this.treeAdapter.getFirstChild(this.document),s=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,s),s}_err(t,s,n){var a;if(!this.onParseError)return;let c=(a=t.location)!==null&&a!==void 0?a:Gi,l={code:s,startLine:c.startLine,startCol:c.startCol,startOffset:c.startOffset,endLine:n?c.startLine:c.endLine,endCol:n?c.startCol:c.endCol,endOffset:n?c.startOffset:c.endOffset};this.onParseError(l)}onItemPush(t,s,n){var a,c;(c=(a=this.treeAdapter).onItemPush)===null||c===void 0||c.call(a,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,s)}onItemPop(t,s){var n,a;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(a=(n=this.treeAdapter).onItemPop)===null||a===void 0||a.call(n,t,this.openElements.current),s){let c,l;this.openElements.stackTop===0&&this.fragmentContext?(c=this.fragmentContext,l=this.fragmentContextID):{current:c,currentTagId:l}=this.openElements,this._setContextModes(c,l)}}_setContextModes(t,s){let n=t===this.document||this.treeAdapter.getNamespaceURI(t)===d.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(s,t)}_switchToTextParsing(t,s){this._insertElement(t,d.HTML),this.tokenizer.state=s,this.originalInsertionMode=this.insertionMode,this.insertionMode=E.TEXT}switchToPlaintextParsing(){this.insertionMode=E.TEXT,this.originalInsertionMode=E.IN_BODY,this.tokenizer.state=b.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===h.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==d.HTML))switch(this.fragmentContextID){case r.TITLE:case r.TEXTAREA:{this.tokenizer.state=b.RCDATA;break}case r.STYLE:case r.XMP:case r.IFRAME:case r.NOEMBED:case r.NOFRAMES:case r.NOSCRIPT:{this.tokenizer.state=b.RAWTEXT;break}case r.SCRIPT:{this.tokenizer.state=b.SCRIPT_DATA;break}case r.PLAINTEXT:{this.tokenizer.state=b.PLAINTEXT;break}default:}}_setDocumentType(t){let s=t.name||"",n=t.publicId||"",a=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,s,n,a),t.location){let l=this.treeAdapter.getChildNodes(this.document).find(u=>this.treeAdapter.isDocumentTypeNode(u));l&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}}_attachElementToTree(t,s){if(this.options.sourceCodeLocationInfo){let n=s&&{...s,startTag:s};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{let n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,s){let n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,s){let n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,s){let n=this.treeAdapter.createElement(t,d.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,s)}_insertTemplate(t){let s=this.treeAdapter.createElement(t.tagName,d.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(s,n),this._attachElementToTree(s,t.location),this.openElements.push(s,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){let t=this.treeAdapter.createElement(h.HTML,d.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,r.HTML)}_appendCommentNode(t,s){let n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(s,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let s,n;if(this._shouldFosterParentOnInsertion()?({parent:s,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(s,t.chars,n):this.treeAdapter.insertText(s,t.chars)):(s=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(s,t.chars)),!t.location)return;let a=this.treeAdapter.getChildNodes(s),c=n?a.lastIndexOf(n):a.length,l=a[c-1];if(this.treeAdapter.getNodeSourceCodeLocation(l)){let{endLine:f,endCol:_,endOffset:A}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(l,{endLine:f,endCol:_,endOffset:A})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(l,t.location)}_adoptNodes(t,s){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(s,n)}_setEndLocation(t,s){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&s.location){let n=s.location,a=this.treeAdapter.getTagName(t),c=s.type===N.END_TAG&&a===s.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,c)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let s,n;return this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,n=this.fragmentContextID):{current:s,currentTagId:n}=this.openElements,t.tagID===r.SVG&&this.treeAdapter.getTagName(s)===h.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(s)===d.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===r.MGLYPH||t.tagID===r.MALIGNMARK)&&!this._isIntegrationPoint(n,s,d.HTML)}_processToken(t){switch(t.type){case N.CHARACTER:{this.onCharacter(t);break}case N.NULL_CHARACTER:{this.onNullCharacter(t);break}case N.COMMENT:{this.onComment(t);break}case N.DOCTYPE:{this.onDoctype(t);break}case N.START_TAG:{this._processStartTag(t);break}case N.END_TAG:{this.onEndTag(t);break}case N.EOF:{this.onEof(t);break}case N.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,s,n){let a=this.treeAdapter.getNamespaceURI(s),c=this.treeAdapter.getAttrList(s);return xr(t,a,c,n)}_reconstructActiveFormattingElements(){let t=this.activeFormattingElements.entries.length;if(t){let s=this.activeFormattingElements.entries.findIndex(a=>a.type===F.Marker||this.openElements.contains(a.element)),n=s<0?t-1:s-1;for(let a=n;a>=0;a--){let c=this.activeFormattingElements.entries[a];this._insertElement(c.token,this.treeAdapter.getNamespaceURI(c.element)),c.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=E.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(r.P),this.openElements.popUntilTagNamePopped(r.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case r.TR:{this.insertionMode=E.IN_ROW;return}case r.TBODY:case r.THEAD:case r.TFOOT:{this.insertionMode=E.IN_TABLE_BODY;return}case r.CAPTION:{this.insertionMode=E.IN_CAPTION;return}case r.COLGROUP:{this.insertionMode=E.IN_COLUMN_GROUP;return}case r.TABLE:{this.insertionMode=E.IN_TABLE;return}case r.BODY:{this.insertionMode=E.IN_BODY;return}case r.FRAMESET:{this.insertionMode=E.IN_FRAMESET;return}case r.SELECT:{this._resetInsertionModeForSelect(t);return}case r.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case r.HTML:{this.insertionMode=this.headElement?E.AFTER_HEAD:E.BEFORE_HEAD;return}case r.TD:case r.TH:{if(t>0){this.insertionMode=E.IN_CELL;return}break}case r.HEAD:{if(t>0){this.insertionMode=E.IN_HEAD;return}break}}this.insertionMode=E.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let s=t-1;s>0;s--){let n=this.openElements.tagIDs[s];if(n===r.TEMPLATE)break;if(n===r.TABLE){this.insertionMode=E.IN_SELECT_IN_TABLE;return}}this.insertionMode=E.IN_SELECT}_isElementCausesFosterParenting(t){return Qr.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){let s=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case r.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(s)===d.HTML)return{parent:this.treeAdapter.getTemplateContent(s),beforeElement:null};break}case r.TABLE:{let n=this.treeAdapter.getParentNode(s);return n?{parent:n,beforeElement:s}:{parent:this.openElements.items[t-1],beforeElement:null}}default:}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){let s=this._findFosterParentingLocation();s.beforeElement?this.treeAdapter.insertBefore(s.parent,t,s.beforeElement):this.treeAdapter.appendChild(s.parent,t)}_isSpecialElement(t,s){let n=this.treeAdapter.getNamespaceURI(t);return qt[n].has(s)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){Ic(this,t);return}switch(this.insertionMode){case E.INITIAL:{Le(this,t);break}case E.BEFORE_HTML:{De(this,t);break}case E.BEFORE_HEAD:{be(this,t);break}case E.IN_HEAD:{Pe(this,t);break}case E.IN_HEAD_NO_SCRIPT:{Me(this,t);break}case E.AFTER_HEAD:{Be(this,t);break}case E.IN_BODY:case E.IN_CAPTION:case E.IN_CELL:case E.IN_TEMPLATE:{Gr(this,t);break}case E.TEXT:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case E.IN_TABLE:case E.IN_TABLE_BODY:case E.IN_ROW:{es(this,t);break}case E.IN_TABLE_TEXT:{zr(this,t);break}case E.IN_COLUMN_GROUP:{mt(this,t);break}case E.AFTER_BODY:{_t(this,t);break}case E.AFTER_AFTER_BODY:{ft(this,t);break}default:}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){pc(this,t);return}switch(this.insertionMode){case E.INITIAL:{Le(this,t);break}case E.BEFORE_HTML:{De(this,t);break}case E.BEFORE_HEAD:{be(this,t);break}case E.IN_HEAD:{Pe(this,t);break}case E.IN_HEAD_NO_SCRIPT:{Me(this,t);break}case E.AFTER_HEAD:{Be(this,t);break}case E.TEXT:{this._insertCharacters(t);break}case E.IN_TABLE:case E.IN_TABLE_BODY:case E.IN_ROW:{es(this,t);break}case E.IN_COLUMN_GROUP:{mt(this,t);break}case E.AFTER_BODY:{_t(this,t);break}case E.AFTER_AFTER_BODY:{ft(this,t);break}default:}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){ts(this,t);return}switch(this.insertionMode){case E.INITIAL:case E.BEFORE_HTML:case E.BEFORE_HEAD:case E.IN_HEAD:case E.IN_HEAD_NO_SCRIPT:case E.AFTER_HEAD:case E.IN_BODY:case E.IN_TABLE:case E.IN_CAPTION:case E.IN_COLUMN_GROUP:case E.IN_TABLE_BODY:case E.IN_ROW:case E.IN_CELL:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:case E.IN_TEMPLATE:case E.IN_FRAMESET:case E.AFTER_FRAMESET:{ts(this,t);break}case E.IN_TABLE_TEXT:{Se(this,t);break}case E.AFTER_BODY:{$i(this,t);break}case E.AFTER_AFTER_BODY:case E.AFTER_AFTER_FRAMESET:{Ji(this,t);break}default:}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case E.INITIAL:{Zi(this,t);break}case E.BEFORE_HEAD:case E.IN_HEAD:case E.IN_HEAD_NO_SCRIPT:case E.AFTER_HEAD:{this._err(t,T.misplacedDoctype);break}case E.IN_TABLE_TEXT:{Se(this,t);break}default:}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,T.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?Nc(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case E.INITIAL:{Le(this,t);break}case E.BEFORE_HTML:{eo(this,t);break}case E.BEFORE_HEAD:{so(this,t);break}case E.IN_HEAD:{y(this,t);break}case E.IN_HEAD_NO_SCRIPT:{ao(this,t);break}case E.AFTER_HEAD:{oo(this,t);break}case E.IN_BODY:{P(this,t);break}case E.IN_TABLE:{Te(this,t);break}case E.IN_TABLE_TEXT:{Se(this,t);break}case E.IN_CAPTION:{nc(this,t);break}case E.IN_COLUMN_GROUP:{as(this,t);break}case E.IN_TABLE_BODY:{pt(this,t);break}case E.IN_ROW:{It(this,t);break}case E.IN_CELL:{oc(this,t);break}case E.IN_SELECT:{Zr(this,t);break}case E.IN_SELECT_IN_TABLE:{Ec(this,t);break}case E.IN_TEMPLATE:{hc(this,t);break}case E.AFTER_BODY:{uc(this,t);break}case E.IN_FRAMESET:{dc(this,t);break}case E.AFTER_FRAMESET:{mc(this,t);break}case E.AFTER_AFTER_BODY:{Ac(this,t);break}case E.AFTER_AFTER_FRAMESET:{Cc(this,t);break}default:}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?Rc(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case E.INITIAL:{Le(this,t);break}case E.BEFORE_HTML:{to(this,t);break}case E.BEFORE_HEAD:{ro(this,t);break}case E.IN_HEAD:{no(this,t);break}case E.IN_HEAD_NO_SCRIPT:{io(this,t);break}case E.AFTER_HEAD:{co(this,t);break}case E.IN_BODY:{Ct(this,t);break}case E.TEXT:{jo(this,t);break}case E.IN_TABLE:{ke(this,t);break}case E.IN_TABLE_TEXT:{Se(this,t);break}case E.IN_CAPTION:{ac(this,t);break}case E.IN_COLUMN_GROUP:{ic(this,t);break}case E.IN_TABLE_BODY:{ss(this,t);break}case E.IN_ROW:{Jr(this,t);break}case E.IN_CELL:{cc(this,t);break}case E.IN_SELECT:{en(this,t);break}case E.IN_SELECT_IN_TABLE:{lc(this,t);break}case E.IN_TEMPLATE:{Tc(this,t);break}case E.AFTER_BODY:{sn(this,t);break}case E.IN_FRAMESET:{fc(this,t);break}case E.AFTER_FRAMESET:{_c(this,t);break}case E.AFTER_AFTER_BODY:{ft(this,t);break}default:}}onEof(t){switch(this.insertionMode){case E.INITIAL:{Le(this,t);break}case E.BEFORE_HTML:{De(this,t);break}case E.BEFORE_HEAD:{be(this,t);break}case E.IN_HEAD:{Pe(this,t);break}case E.IN_HEAD_NO_SCRIPT:{Me(this,t);break}case E.AFTER_HEAD:{Be(this,t);break}case E.IN_BODY:case E.IN_TABLE:case E.IN_CAPTION:case E.IN_COLUMN_GROUP:case E.IN_TABLE_BODY:case E.IN_ROW:case E.IN_CELL:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:{jr(this,t);break}case E.TEXT:{qo(this,t);break}case E.IN_TABLE_TEXT:{Se(this,t);break}case E.IN_TEMPLATE:{tn(this,t);break}case E.AFTER_BODY:case E.IN_FRAMESET:case E.AFTER_FRAMESET:case E.AFTER_AFTER_BODY:case E.AFTER_AFTER_FRAMESET:{ns(this,t);break}default:}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===i.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case E.IN_HEAD:case E.IN_HEAD_NO_SCRIPT:case E.AFTER_HEAD:case E.TEXT:case E.IN_COLUMN_GROUP:case E.IN_SELECT:case E.IN_SELECT_IN_TABLE:case E.IN_FRAMESET:case E.AFTER_FRAMESET:{this._insertCharacters(t);break}case E.IN_BODY:case E.IN_CAPTION:case E.IN_CELL:case E.IN_TEMPLATE:case E.AFTER_BODY:case E.AFTER_AFTER_BODY:case E.AFTER_AFTER_FRAMESET:{Wr(this,t);break}case E.IN_TABLE:case E.IN_TABLE_BODY:case E.IN_ROW:{es(this,t);break}case E.IN_TABLE_TEXT:{qr(this,t);break}default:}}};function Xi(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return s?e.openElements.contains(s.element)?e.openElements.hasInScope(t.tagID)||(s=null):(e.activeFormattingElements.removeEntry(s),s=null):Vr(e,t),s}function Ki(e,t){let s=null,n=e.openElements.stackTop;for(;n>=0;n--){let a=e.openElements.items[n];if(a===t.element)break;e._isSpecialElement(a,e.openElements.tagIDs[n])&&(s=a)}return s||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),s}function Vi(e,t,s){let n=t,a=e.openElements.getCommonAncestor(t);for(let c=0,l=a;l!==s;c++,l=a){a=e.openElements.getCommonAncestor(l);let u=e.activeFormattingElements.getElementEntry(l),f=u&&c>=Wi;!u||f?(f&&e.activeFormattingElements.removeEntry(u),e.openElements.remove(l)):(l=ji(e,u),n===t&&(e.activeFormattingElements.bookmark=u),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(l,n),n=l)}return n}function ji(e,t){let s=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,s,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function qi(e,t,s){let n=e.treeAdapter.getTagName(t),a=q(n);if(e._isElementCausesFosterParenting(a))e._fosterParentElement(s);else{let c=e.treeAdapter.getNamespaceURI(t);a===r.TEMPLATE&&c===d.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,s)}}function zi(e,t,s){let n=e.treeAdapter.getNamespaceURI(s.element),{token:a}=s,c=e.treeAdapter.createElement(a.tagName,n,a.attrs);e._adoptNodes(t,c),e.treeAdapter.appendChild(t,c),e.activeFormattingElements.insertElementAfterBookmark(c,a),e.activeFormattingElements.removeEntry(s),e.openElements.remove(s.element),e.openElements.insertAfter(t,c,a.tagID)}function rs(e,t){for(let s=0;s<Qi;s++){let n=Xi(e,t);if(!n)break;let a=Ki(e,n);if(!a)break;e.activeFormattingElements.bookmark=n;let c=Vi(e,a,n.element),l=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(c),l&&qi(e,l,c),zi(e,a,n)}}function ts(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function $i(e,t){e._appendCommentNode(t,e.openElements.items[0])}function Ji(e,t){e._appendCommentNode(t,e.document)}function ns(e,t){if(e.stopped=!0,t.location){let s=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=s;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){let n=e.openElements.items[0],a=e.treeAdapter.getNodeSourceCodeLocation(n);if(a&&!a.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){let c=e.openElements.items[1],l=e.treeAdapter.getNodeSourceCodeLocation(c);l&&!l.endTag&&e._setEndLocation(c,t)}}}}function Zi(e,t){e._setDocumentType(t);let s=t.forceQuirks?D.QUIRKS:kr(t);Br(t)||e._err(t,T.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,s),e.insertionMode=E.BEFORE_HTML}function Le(e,t){e._err(t,T.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,D.QUIRKS),e.insertionMode=E.BEFORE_HTML,e._processToken(t)}function eo(e,t){t.tagID===r.HTML?(e._insertElement(t,d.HTML),e.insertionMode=E.BEFORE_HEAD):De(e,t)}function to(e,t){let s=t.tagID;(s===r.HTML||s===r.HEAD||s===r.BODY||s===r.BR)&&De(e,t)}function De(e,t){e._insertFakeRootElement(),e.insertionMode=E.BEFORE_HEAD,e._processToken(t)}function so(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.HEAD:{e._insertElement(t,d.HTML),e.headElement=e.openElements.current,e.insertionMode=E.IN_HEAD;break}default:be(e,t)}}function ro(e,t){let s=t.tagID;s===r.HEAD||s===r.BODY||s===r.HTML||s===r.BR?be(e,t):e._err(t,T.endTagWithoutMatchingOpenElement)}function be(e,t){e._insertFakeElement(h.HEAD,r.HEAD),e.headElement=e.openElements.current,e.insertionMode=E.IN_HEAD,e._processToken(t)}function y(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:{e._appendElement(t,d.HTML),t.ackSelfClosing=!0;break}case r.TITLE:{e._switchToTextParsing(t,b.RCDATA);break}case r.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,b.RAWTEXT):(e._insertElement(t,d.HTML),e.insertionMode=E.IN_HEAD_NO_SCRIPT);break}case r.NOFRAMES:case r.STYLE:{e._switchToTextParsing(t,b.RAWTEXT);break}case r.SCRIPT:{e._switchToTextParsing(t,b.SCRIPT_DATA);break}case r.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=E.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(E.IN_TEMPLATE);break}case r.HEAD:{e._err(t,T.misplacedStartTagForHeadElement);break}default:Pe(e,t)}}function no(e,t){switch(t.tagID){case r.HEAD:{e.openElements.pop(),e.insertionMode=E.AFTER_HEAD;break}case r.BODY:case r.BR:case r.HTML:{Pe(e,t);break}case r.TEMPLATE:{se(e,t);break}default:e._err(t,T.endTagWithoutMatchingOpenElement)}}function se(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==r.TEMPLATE&&e._err(t,T.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,T.endTagWithoutMatchingOpenElement)}function Pe(e,t){e.openElements.pop(),e.insertionMode=E.AFTER_HEAD,e._processToken(t)}function ao(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.BASEFONT:case r.BGSOUND:case r.HEAD:case r.LINK:case r.META:case r.NOFRAMES:case r.STYLE:{y(e,t);break}case r.NOSCRIPT:{e._err(t,T.nestedNoscriptInHead);break}default:Me(e,t)}}function io(e,t){switch(t.tagID){case r.NOSCRIPT:{e.openElements.pop(),e.insertionMode=E.IN_HEAD;break}case r.BR:{Me(e,t);break}default:e._err(t,T.endTagWithoutMatchingOpenElement)}}function Me(e,t){let s=t.type===N.EOF?T.openElementsLeftAfterEof:T.disallowedContentInNoscriptInHead;e._err(t,s),e.openElements.pop(),e.insertionMode=E.IN_HEAD,e._processToken(t)}function oo(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.BODY:{e._insertElement(t,d.HTML),e.framesetOk=!1,e.insertionMode=E.IN_BODY;break}case r.FRAMESET:{e._insertElement(t,d.HTML),e.insertionMode=E.IN_FRAMESET;break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{e._err(t,T.abandonedHeadElementChild),e.openElements.push(e.headElement,r.HEAD),y(e,t),e.openElements.remove(e.headElement);break}case r.HEAD:{e._err(t,T.misplacedStartTagForHeadElement);break}default:Be(e,t)}}function co(e,t){switch(t.tagID){case r.BODY:case r.HTML:case r.BR:{Be(e,t);break}case r.TEMPLATE:{se(e,t);break}default:e._err(t,T.endTagWithoutMatchingOpenElement)}}function Be(e,t){e._insertFakeElement(h.BODY,r.BODY),e.insertionMode=E.IN_BODY,At(e,t)}function At(e,t){switch(t.type){case N.CHARACTER:{Gr(e,t);break}case N.WHITESPACE_CHARACTER:{Wr(e,t);break}case N.COMMENT:{ts(e,t);break}case N.START_TAG:{P(e,t);break}case N.END_TAG:{Ct(e,t);break}case N.EOF:{jr(e,t);break}default:}}function Wr(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Gr(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function Eo(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function lo(e,t){let s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(s,t.attrs))}function ho(e,t){let s=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&s&&(e.treeAdapter.detachNode(s),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,d.HTML),e.insertionMode=E.IN_FRAMESET)}function To(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,d.HTML)}function uo(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),Ne(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,d.HTML)}function fo(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,d.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function mo(e,t){let s=e.openElements.tmplCount>0;(!e.formElement||s)&&(e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,d.HTML),s||(e.formElement=e.openElements.current))}function _o(e,t){e.framesetOk=!1;let s=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){let a=e.openElements.tagIDs[n];if(s===r.LI&&a===r.LI||(s===r.DD||s===r.DT)&&(a===r.DD||a===r.DT)){e.openElements.generateImpliedEndTagsWithExclusion(a),e.openElements.popUntilTagNamePopped(a);break}if(a!==r.ADDRESS&&a!==r.DIV&&a!==r.P&&e._isSpecialElement(e.openElements.items[n],a))break}e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,d.HTML)}function Ao(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,d.HTML),e.tokenizer.state=b.PLAINTEXT}function Co(e,t){e.openElements.hasInScope(r.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML),e.framesetOk=!1}function po(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(h.A);s&&(rs(e,t),e.openElements.remove(s.element),e.activeFormattingElements.removeEntry(s)),e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Io(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function No(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(r.NOBR)&&(rs(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,d.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Ro(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function go(e,t){e.treeAdapter.getDocumentMode(e.document)!==D.QUIRKS&&e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,d.HTML),e.framesetOk=!1,e.insertionMode=E.IN_TABLE}function Xr(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,d.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Kr(e){let t=ct(e,x.TYPE);return t!=null&&t.toLowerCase()===Yi}function Oo(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,d.HTML),Kr(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function Lo(e,t){e._appendElement(t,d.HTML),t.ackSelfClosing=!0}function So(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._appendElement(t,d.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Do(e,t){t.tagName=h.IMG,t.tagID=r.IMG,Xr(e,t)}function bo(e,t){e._insertElement(t,d.HTML),e.skipNextNewLine=!0,e.tokenizer.state=b.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=E.TEXT}function Po(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,b.RAWTEXT)}function Mo(e,t){e.framesetOk=!1,e._switchToTextParsing(t,b.RAWTEXT)}function vr(e,t){e._switchToTextParsing(t,b.RAWTEXT)}function Bo(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===E.IN_TABLE||e.insertionMode===E.IN_CAPTION||e.insertionMode===E.IN_TABLE_BODY||e.insertionMode===E.IN_ROW||e.insertionMode===E.IN_CELL?E.IN_SELECT_IN_TABLE:E.IN_SELECT}function ko(e,t){e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML)}function Ho(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,d.HTML)}function Uo(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(r.RTC),e._insertElement(t,d.HTML)}function Fo(e,t){e._reconstructActiveFormattingElements(),Jt(t),dt(t),t.selfClosing?e._appendElement(t,d.MATHML):e._insertElement(t,d.MATHML),t.ackSelfClosing=!0}function xo(e,t){e._reconstructActiveFormattingElements(),Zt(t),dt(t),t.selfClosing?e._appendElement(t,d.SVG):e._insertElement(t,d.SVG),t.ackSelfClosing=!0}function Yr(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.HTML)}function P(e,t){switch(t.tagID){case r.I:case r.S:case r.B:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.SMALL:case r.STRIKE:case r.STRONG:{Io(e,t);break}case r.A:{po(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{uo(e,t);break}case r.P:case r.DL:case r.OL:case r.UL:case r.DIV:case r.DIR:case r.NAV:case r.MAIN:case r.MENU:case r.ASIDE:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.DETAILS:case r.ADDRESS:case r.ARTICLE:case r.SECTION:case r.SUMMARY:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{To(e,t);break}case r.LI:case r.DD:case r.DT:{_o(e,t);break}case r.BR:case r.IMG:case r.WBR:case r.AREA:case r.EMBED:case r.KEYGEN:{Xr(e,t);break}case r.HR:{So(e,t);break}case r.RB:case r.RTC:{Ho(e,t);break}case r.RT:case r.RP:{Uo(e,t);break}case r.PRE:case r.LISTING:{fo(e,t);break}case r.XMP:{Po(e,t);break}case r.SVG:{xo(e,t);break}case r.HTML:{Eo(e,t);break}case r.BASE:case r.LINK:case r.META:case r.STYLE:case r.TITLE:case r.SCRIPT:case r.BGSOUND:case r.BASEFONT:case r.TEMPLATE:{y(e,t);break}case r.BODY:{lo(e,t);break}case r.FORM:{mo(e,t);break}case r.NOBR:{No(e,t);break}case r.MATH:{Fo(e,t);break}case r.TABLE:{go(e,t);break}case r.INPUT:{Oo(e,t);break}case r.PARAM:case r.TRACK:case r.SOURCE:{Lo(e,t);break}case r.IMAGE:{Do(e,t);break}case r.BUTTON:{Co(e,t);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{Ro(e,t);break}case r.IFRAME:{Mo(e,t);break}case r.SELECT:{Bo(e,t);break}case r.OPTION:case r.OPTGROUP:{ko(e,t);break}case r.NOEMBED:{vr(e,t);break}case r.FRAMESET:{ho(e,t);break}case r.TEXTAREA:{bo(e,t);break}case r.NOSCRIPT:{e.options.scriptingEnabled?vr(e,t):Yr(e,t);break}case r.PLAINTEXT:{Ao(e,t);break}case r.COL:case r.TH:case r.TD:case r.TR:case r.HEAD:case r.FRAME:case r.TBODY:case r.TFOOT:case r.THEAD:case r.CAPTION:case r.COLGROUP:break;default:Yr(e,t)}}function yo(e,t){if(e.openElements.hasInScope(r.BODY)&&(e.insertionMode=E.AFTER_BODY,e.options.sourceCodeLocationInfo)){let s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e._setEndLocation(s,t)}}function wo(e,t){e.openElements.hasInScope(r.BODY)&&(e.insertionMode=E.AFTER_BODY,sn(e,t))}function vo(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s))}function Yo(e){let t=e.openElements.tmplCount>0,{formElement:s}=e;t||(e.formElement=null),(s||t)&&e.openElements.hasInScope(r.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(r.FORM):s&&e.openElements.remove(s))}function Qo(e){e.openElements.hasInButtonScope(r.P)||e._insertFakeElement(h.P,r.P),e._closePElement()}function Wo(e){e.openElements.hasInListItemScope(r.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(r.LI),e.openElements.popUntilTagNamePopped(r.LI))}function Go(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s))}function Xo(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function Ko(e,t){let s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker())}function Vo(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(h.BR,r.BR),e.openElements.pop(),e.framesetOk=!1}function Vr(e,t){let s=t.tagName,n=t.tagID;for(let a=e.openElements.stackTop;a>0;a--){let c=e.openElements.items[a],l=e.openElements.tagIDs[a];if(n===l&&(n!==r.UNKNOWN||e.treeAdapter.getTagName(c)===s)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=a&&e.openElements.shortenToLength(a);break}if(e._isSpecialElement(c,l))break}}function Ct(e,t){switch(t.tagID){case r.A:case r.B:case r.I:case r.S:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.NOBR:case r.SMALL:case r.STRIKE:case r.STRONG:{rs(e,t);break}case r.P:{Qo(e);break}case r.DL:case r.UL:case r.OL:case r.DIR:case r.DIV:case r.NAV:case r.PRE:case r.MAIN:case r.MENU:case r.ASIDE:case r.BUTTON:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.ADDRESS:case r.ARTICLE:case r.DETAILS:case r.SECTION:case r.SUMMARY:case r.LISTING:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{vo(e,t);break}case r.LI:{Wo(e);break}case r.DD:case r.DT:{Go(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{Xo(e);break}case r.BR:{Vo(e);break}case r.BODY:{yo(e,t);break}case r.HTML:{wo(e,t);break}case r.FORM:{Yo(e);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{Ko(e,t);break}case r.TEMPLATE:{se(e,t);break}default:Vr(e,t)}}function jr(e,t){e.tmplInsertionModeStack.length>0?tn(e,t):ns(e,t)}function jo(e,t){var s;t.tagID===r.SCRIPT&&((s=e.scriptHandler)===null||s===void 0||s.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function qo(e,t){e._err(t,T.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function es(e,t){if(Qr.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=E.IN_TABLE_TEXT,t.type){case N.CHARACTER:{zr(e,t);break}case N.WHITESPACE_CHARACTER:{qr(e,t);break}}else He(e,t)}function zo(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,d.HTML),e.insertionMode=E.IN_CAPTION}function $o(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,d.HTML),e.insertionMode=E.IN_COLUMN_GROUP}function Jo(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(h.COLGROUP,r.COLGROUP),e.insertionMode=E.IN_COLUMN_GROUP,as(e,t)}function Zo(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,d.HTML),e.insertionMode=E.IN_TABLE_BODY}function ec(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(h.TBODY,r.TBODY),e.insertionMode=E.IN_TABLE_BODY,pt(e,t)}function tc(e,t){e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function sc(e,t){Kr(t)?e._appendElement(t,d.HTML):He(e,t),t.ackSelfClosing=!0}function rc(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,d.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function Te(e,t){switch(t.tagID){case r.TD:case r.TH:case r.TR:{ec(e,t);break}case r.STYLE:case r.SCRIPT:case r.TEMPLATE:{y(e,t);break}case r.COL:{Jo(e,t);break}case r.FORM:{rc(e,t);break}case r.TABLE:{tc(e,t);break}case r.TBODY:case r.TFOOT:case r.THEAD:{Zo(e,t);break}case r.INPUT:{sc(e,t);break}case r.CAPTION:{zo(e,t);break}case r.COLGROUP:{$o(e,t);break}default:He(e,t)}}function ke(e,t){switch(t.tagID){case r.TABLE:{e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode());break}case r.TEMPLATE:{se(e,t);break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:He(e,t)}}function He(e,t){let s=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,At(e,t),e.fosterParentingEnabled=s}function qr(e,t){e.pendingCharacterTokens.push(t)}function zr(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function Se(e,t){let s=0;if(e.hasNonWhitespacePendingCharacterToken)for(;s<e.pendingCharacterTokens.length;s++)He(e,e.pendingCharacterTokens[s]);else for(;s<e.pendingCharacterTokens.length;s++)e._insertCharacters(e.pendingCharacterTokens[s]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}var $r=new Set([r.CAPTION,r.COL,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]);function nc(e,t){let s=t.tagID;$r.has(s)?e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=E.IN_TABLE,Te(e,t)):P(e,t)}function ac(e,t){let s=t.tagID;switch(s){case r.CAPTION:case r.TABLE:{e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=E.IN_TABLE,s===r.TABLE&&ke(e,t));break}case r.BODY:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:Ct(e,t)}}function as(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.COL:{e._appendElement(t,d.HTML),t.ackSelfClosing=!0;break}case r.TEMPLATE:{y(e,t);break}default:mt(e,t)}}function ic(e,t){switch(t.tagID){case r.COLGROUP:{e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=E.IN_TABLE);break}case r.TEMPLATE:{se(e,t);break}case r.COL:break;default:mt(e,t)}}function mt(e,t){e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=E.IN_TABLE,e._processToken(t))}function pt(e,t){switch(t.tagID){case r.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,d.HTML),e.insertionMode=E.IN_ROW;break}case r.TH:case r.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(h.TR,r.TR),e.insertionMode=E.IN_ROW,It(e,t);break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE,Te(e,t));break}default:Te(e,t)}}function ss(e,t){let s=t.tagID;switch(t.tagID){case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasInTableScope(s)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE);break}case r.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE,ke(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:case r.TR:break;default:ke(e,t)}}function It(e,t){switch(t.tagID){case r.TH:case r.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,d.HTML),e.insertionMode=E.IN_CELL,e.activeFormattingElements.insertMarker();break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY,pt(e,t));break}default:Te(e,t)}}function Jr(e,t){switch(t.tagID){case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY);break}case r.TABLE:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY,ss(e,t));break}case r.TBODY:case r.TFOOT:case r.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(r.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=E.IN_TABLE_BODY,ss(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:break;default:ke(e,t)}}function oc(e,t){let s=t.tagID;$r.has(s)?(e.openElements.hasInTableScope(r.TD)||e.openElements.hasInTableScope(r.TH))&&(e._closeTableCell(),It(e,t)):P(e,t)}function cc(e,t){let s=t.tagID;switch(s){case r.TD:case r.TH:{e.openElements.hasInTableScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=E.IN_ROW);break}case r.TABLE:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(s)&&(e._closeTableCell(),Jr(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:break;default:Ct(e,t)}}function Zr(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._insertElement(t,d.HTML);break}case r.OPTGROUP:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop(),e._insertElement(t,d.HTML);break}case r.INPUT:case r.KEYGEN:case r.TEXTAREA:case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),t.tagID!==r.SELECT&&e._processStartTag(t));break}case r.SCRIPT:case r.TEMPLATE:{y(e,t);break}default:}}function en(e,t){switch(t.tagID){case r.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===r.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===r.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop();break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop();break}case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode());break}case r.TEMPLATE:{se(e,t);break}default:}}function Ec(e,t){let s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e._processStartTag(t)):Zr(e,t)}function lc(e,t){let s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?e.openElements.hasInTableScope(s)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e.onEndTag(t)):en(e,t)}function hc(e,t){switch(t.tagID){case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{y(e,t);break}case r.CAPTION:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.tmplInsertionModeStack[0]=E.IN_TABLE,e.insertionMode=E.IN_TABLE,Te(e,t);break}case r.COL:{e.tmplInsertionModeStack[0]=E.IN_COLUMN_GROUP,e.insertionMode=E.IN_COLUMN_GROUP,as(e,t);break}case r.TR:{e.tmplInsertionModeStack[0]=E.IN_TABLE_BODY,e.insertionMode=E.IN_TABLE_BODY,pt(e,t);break}case r.TD:case r.TH:{e.tmplInsertionModeStack[0]=E.IN_ROW,e.insertionMode=E.IN_ROW,It(e,t);break}default:e.tmplInsertionModeStack[0]=E.IN_BODY,e.insertionMode=E.IN_BODY,P(e,t)}}function Tc(e,t){t.tagID===r.TEMPLATE&&se(e,t)}function tn(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):ns(e,t)}function uc(e,t){t.tagID===r.HTML?P(e,t):_t(e,t)}function sn(e,t){var s;if(t.tagID===r.HTML){if(e.fragmentContext||(e.insertionMode=E.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===r.HTML){e._setEndLocation(e.openElements.items[0],t);let n=e.openElements.items[1];n&&!(!((s=e.treeAdapter.getNodeSourceCodeLocation(n))===null||s===void 0)&&s.endTag)&&e._setEndLocation(n,t)}}else _t(e,t)}function _t(e,t){e.insertionMode=E.IN_BODY,At(e,t)}function dc(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.FRAMESET:{e._insertElement(t,d.HTML);break}case r.FRAME:{e._appendElement(t,d.HTML),t.ackSelfClosing=!0;break}case r.NOFRAMES:{y(e,t);break}default:}}function fc(e,t){t.tagID===r.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==r.FRAMESET&&(e.insertionMode=E.AFTER_FRAMESET))}function mc(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.NOFRAMES:{y(e,t);break}default:}}function _c(e,t){t.tagID===r.HTML&&(e.insertionMode=E.AFTER_AFTER_FRAMESET)}function Ac(e,t){t.tagID===r.HTML?P(e,t):ft(e,t)}function ft(e,t){e.insertionMode=E.IN_BODY,At(e,t)}function Cc(e,t){switch(t.tagID){case r.HTML:{P(e,t);break}case r.NOFRAMES:{y(e,t);break}default:}}function pc(e,t){t.chars=O,e._insertCharacters(t)}function Ic(e,t){e._insertCharacters(t),e.framesetOk=!1}function rn(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==d.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function Nc(e,t){if(Ur(t))rn(e),e._startTagOutsideForeignContent(t);else{let s=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(s);n===d.MATHML?Jt(t):n===d.SVG&&(Fr(t),Zt(t)),dt(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function Rc(e,t){if(t.tagID===r.P||t.tagID===r.BR){rn(e),e._endTagOutsideForeignContent(t);return}for(let s=e.openElements.stackTop;s>0;s--){let n=e.openElements.items[s];if(e.treeAdapter.getNamespaceURI(n)===d.HTML){e._endTagOutsideForeignContent(t);break}let a=e.treeAdapter.getTagName(n);if(a.toLowerCase()===t.tagName){t.tagName=a,e.openElements.shortenToLength(s);break}}}var gc=new Set([h.AREA,h.BASE,h.BASEFONT,h.BGSOUND,h.BR,h.COL,h.EMBED,h.FRAME,h.HR,h.IMG,h.INPUT,h.KEYGEN,h.LINK,h.META,h.PARAM,h.SOURCE,h.TRACK,h.WBR]);function Oc(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===d.HTML&&gc.has(t.treeAdapter.getTagName(e))}var Lc={treeAdapter:v,scriptingEnabled:!0};function is(e,t){let s={...Lc,...t};return nn(e,s)}function Sc(e,t){let s="",n=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===h.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===d.HTML?t.treeAdapter.getTemplateContent(e):e,a=t.treeAdapter.getChildNodes(n);if(a)for(let c of a)s+=nn(c,t);return s}function nn(e,t){return t.treeAdapter.isElementNode(e)?Dc(e,t):t.treeAdapter.isTextNode(e)?Pc(e,t):t.treeAdapter.isCommentNode(e)?Mc(e,t):t.treeAdapter.isDocumentTypeNode(e)?Bc(e,t):""}function Dc(e,t){let s=t.treeAdapter.getTagName(e);return`<${s}${bc(e,t)}>${Oc(e,t)?"":`${Sc(e,t)}</${s}>`}`}function bc(e,{treeAdapter:t}){let s="";for(let n of t.getAttrList(e)){if(s+=" ",!n.namespace)s+=n.name;else switch(n.namespace){case d.XML:{s+=`xml:${n.name}`;break}case d.XMLNS:{n.name!=="xmlns"&&(s+="xmlns:"),s+=n.name;break}case d.XLINK:{s+=`xlink:${n.name}`;break}default:s+=`${n.prefix}:${n.name}`}s+=`="${ps(n.value)}"`}return s}function Pc(e,t){let{treeAdapter:s}=t,n=s.getTextNodeContent(e),a=s.getParentNode(e),c=a&&s.isElementNode(a)&&s.getTagName(a);return c&&s.getNamespaceURI(a)===d.HTML&&zt(c,t.scriptingEnabled)?n:Is(n)}function Mc(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function Bc(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function an(e,t){return he.parse(e,t)}function on(e,t,s){typeof e=="string"&&(s=t,t=e,e=null);let n=he.getFragmentParser(e,s);return n.tokenizer.write(t,!0),n.getFragment()}function cn(e){return new Fe(e)}function En(e){let t=e.includes('"')?"'":'"';return t+e+t}function kc(e,t,s){let n="!DOCTYPE ";return e&&(n+=e),t?n+=` PUBLIC ${En(t)}`:s&&(n+=" SYSTEM"),s&&(n+=` ${En(s)}`),n}var re={isCommentNode:Cs,isElementNode:p,isTextNode:xe,createDocument(){let e=new J([]);return e["x-mode"]=Et.DOCUMENT_MODE.NO_QUIRKS,e},createDocumentFragment(){return new J([])},createElement(e,t,s){let n=Object.create(null),a=Object.create(null),c=Object.create(null);for(let u=0;u<s.length;u++){let f=s[u].name;n[f]=s[u].value,a[f]=s[u].namespace,c[f]=s[u].prefix}let l=new As(e,n,[]);return l.namespace=t,l["x-attribsNamespace"]=a,l["x-attribsPrefix"]=c,l},createCommentNode(e){return new ms(e)},appendChild(e,t){let s=e.children[e.children.length-1];s&&(s.next=t,t.prev=s),e.children.push(t),t.parent=e},insertBefore(e,t,s){let n=e.children.indexOf(s),{prev:a}=s;a&&(a.next=t,t.prev=a),s.prev=t,t.next=s,e.children.splice(n,0,t),t.parent=e},setTemplateContent(e,t){re.appendChild(e,t)},getTemplateContent(e){return e.children[0]},setDocumentType(e,t,s,n){let a=kc(t,s,n),c=e.children.find(l=>Ot(l)&&l.name==="!doctype");c?c.data=a??null:(c=new _s("!doctype",a),re.appendChild(e,c)),c["x-name"]=t??void 0,c["x-publicId"]=s??void 0,c["x-systemId"]=n??void 0},setDocumentMode(e,t){e["x-mode"]=t},getDocumentMode(e){return e["x-mode"]},detachNode(e){if(e.parent){let t=e.parent.children.indexOf(e),{prev:s,next:n}=e;e.prev=null,e.next=null,s&&(s.next=n),n&&(n.prev=s),e.parent.children.splice(t,1),e.parent=null}},insertText(e,t){let s=e.children[e.children.length-1];s&&xe(s)?s.data+=t:re.appendChild(e,cn(t))},insertTextBefore(e,t,s){let n=e.children[e.children.indexOf(s)-1];n&&xe(n)?n.data+=t:re.insertBefore(e,cn(t),s)},adoptAttributes(e,t){for(let s=0;s<t.length;s++){let n=t[s].name;typeof e.attribs[n]>"u"&&(e.attribs[n]=t[s].value,e["x-attribsNamespace"][n]=t[s].namespace,e["x-attribsPrefix"][n]=t[s].prefix)}},getFirstChild(e){return e.children[0]},getChildNodes(e){return e.children},getParentNode(e){return e.parent},getAttrList(e){return e.attributes},getTagName(e){return e.name},getNamespaceURI(e){return e.namespace},getTextNodeContent(e){return e.data},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){var t;return(t=e["x-name"])!==null&&t!==void 0?t:""},getDocumentTypeNodePublicId(e){var t;return(t=e["x-publicId"])!==null&&t!==void 0?t:""},getDocumentTypeNodeSystemId(e){var t;return(t=e["x-systemId"])!==null&&t!==void 0?t:""},isDocumentTypeNode(e){return Ot(e)&&e.name==="!doctype"},setNodeSourceCodeLocation(e,t){t&&(e.startIndex=t.startOffset,e.endIndex=t.endOffset),e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){t.endOffset!=null&&(e.endIndex=t.endOffset),e.sourceCodeLocation={...e.sourceCodeLocation,...t}}};function ln(e,t,s,n){let a={scriptingEnabled:typeof t.scriptingEnabled=="boolean"?t.scriptingEnabled:!0,treeAdapter:re,sourceCodeLocationInfo:t.sourceCodeLocationInfo};return s?an(e,a):on(n,e,a)}var Hc={treeAdapter:re};function hn(e){let t="length"in e?e:[e];for(let n=0;n<t.length;n+=1){let a=t[n];W(a)&&Array.prototype.splice.call(t,n,1,...a.children)}let s="";for(let n=0;n<t.length;n+=1){let a=t[n];s+=is(a,Hc)}return s}var Uc=lr((e,t,s,n)=>t.xmlMode||t._useHtmlParser2?Ls(e,t):ln(e,t,s,n)),Fc=_r(Uc,(e,t)=>t.xmlMode||t._useHtmlParser2?Ns(e,t):hn(e)),Tn=Fc([]),{contains:Zl}=X,{merge:eh}=X,{parseHTML:th}=X,{root:sh}=X;var un=e=>new RegExp(/^(((ht|f)tps?):\/\/)?([^!@#$%^&*?.\s-]([^!@#$%^&*?.\s]{0,63}[^!@#$%^&*?.\s])?\.)+[a-z]{2,6}\/?/).test(e),xc=e=>{if(!e)return"";try{let t=/^(?:https?:\/\/)?(?:www\.)?((?:(?!www\.|\.).)+\.[-a-zA-Z0-9.]+)/gm,s=e.match(t);return(s?s[0]:"").toLowerCase()}catch{return e}},os=(e,t=16)=>{let s=xc(e)||`${e?.toLowerCase()}.com`;return`https://www.google.com/s2/favicons?sz=${t}&domain_url=${s}`},dn=e=>e?(e.search(/^http[s]?:\/\//)==-1&&(e="https://"+e),e):"";var oh=e=>e?.includes?e&&e.includes("524")?"Network error: 524":e&&e.includes("502")?"Network error: 502":e:e,fn=e=>{try{let s=new URL(e).pathname.split(".").pop()||"";return!!["doc","xls","ppt","pdf","zip","rar","apk"].includes(s)}catch{return!1}};var mn=e=>{let t=[];return e("#search #rso > div").filter((a,c)=>!!e(c).find("a > h3").text()).each((a,c)=>{let l=e(c),u=l.find("a > h3"),f=u.closest("a"),_=l.find("div.MUxGbd").text();if(_||(_=f?.parent()?.parent()?.parent().next().text().trim()),_||(_=f?.parent()?.parent()?.parent().next().next().text().trim()),!_){let L=l.find("div[style]").filter((M,S)=>!!e(S)?.attr("style")?.includes("-webkit-line-clamp"));_=e(L[0]).text().trim()}let A=u.text(),C=u.next(),I=k(f.attr("href")??""),R=C?.children()?.last()?.children()?.first()?.text();t.push({title:A,body:_||A,url:I,from:R,imgLink:C?.find("img")?.attr("src")})}),e("#rso #kp-wp-tab-overview:not([style])").length>0&&e('#rso #kp-wp-tab-overview:not([style]) div[class*="K7khPe"]').each((a,c)=>{let l=e(c),u=l.find("a > h3"),f=u.closest("a"),_=l.find("div.MUxGbd").text();if(!_){let L=l.find("div[style]").filter((M,S)=>!!e(S)?.attr("style")?.includes("-webkit-line-clamp"));_=e(L[0]).text().trim()}let A=u.next(),C=k(f.attr("href")??""),I=A?.children()?.last()?.children()?.first()?.text(),R=u.text();R&&t.push({title:R,body:_||R,url:C,from:I,imgLink:A?.find("img")?.attr("src")})}),e("#search #rso > div a[data-ved]").filter((a,c)=>!!e(c).find("div[role=heading]").text()).each((a,c)=>{let l=e(c),u=l.find("div[role=heading]"),f=u.text(),_=u.next().text(),A=u.prev(),C=k(l.attr("href")??"");t.push({title:f,body:_||f,url:C,from:A.text(),imgLink:A.find("img")?.attr("src")})}),e('#search #rso div[role="tabpanel"] div[jscontroller="SC7lYd"]').each((a,c)=>{let l=e(c),u=l.find("a > h3"),f=u.text(),_=u.closest("a"),A=l.find('div[style="-webkit-line-clamp:2"]').text(),C=u.next(),I=k(_.attr("href")??""),R=C.find("span.VuuXrf").text();t.push({title:f,body:A||f,url:I,from:R,imgLink:C.find("img")?.attr("src")})}),t};var _n=e=>{let t=[];return e("ol#b_results li.b_algo").each((s,n)=>{let a=e(n),c=a.find("h2 > a"),l=a.find(".b_algoSlug").text();l||(l=a.find(".b_wikiRichcard .tab-content").text().trim()),t.push({title:c.text()??"",body:l??"",url:k(c.attr("href")??""),from:a.find("a .tptt").text(),imgLink:a.find("img.rms_img").attr("src")})}),t};function ph({html:e,searchEngine:t}){try{return yc(e,t).filter(a=>fn(a.url)?!1:a.url&&(a.body||a.title))}catch{return[]}}function k(e){let t=e.match(/RU=([^/]+)/);return t&&t[1]?decodeURIComponent(t[1]):e}var yc=(e,t)=>{try{let s=Tn.load(e),n=[];switch(t){case"google":{n=mn(s);break}case"baidu":{s("div#content_left div[class^=result]").each((l,u)=>{let f=s(u),_=f.find("h3"),A=_.find("a"),C=f.find("div[class*=description_]").text();C||(C=f.find(".op_dict_content").text()),C||(C=f.find("div[class*=basis-info_]").text()),C||(C=f.find(".c-color-text").text()),C||(C=_.next().next().text());let I=f.find("a[class^=siteLink]");n.push({title:_.text(),body:C??"",url:k(A.attr("href")??""),from:I.text(),imgLink:I.find("img")?.attr("src")})});break}case"duckduckgo":{s("ol.react-results--main li[data-layout=organic]").each((l,u)=>{let f=s(u),_=f.find("h2 > a"),A=f.find("a[data-testid=result-extras-url-link]"),C=A.parent(),I=k(_.attr("href")??"");n.push({title:_.text(),body:f.find("div[data-result=snippet]").text(),url:I,from:ue(I)||A.children().first().text(),imgLink:C.find("a > img")?.attr("src")})});break}case"yahoo":{s('.algo:not([class*="ad"])').each((l,u)=>{let f=s(u),_=f.find("h3.title a"),A=k(_.attr("href")??""),C=_.find("span").text().split(" \u203A ");n.push({title:_.attr("aria-label")??"",body:f.find(".compText").text(),url:A,from:ue(A)||C[0]})});break}case"naver":{s("ul.lst_total > li.bx").each((l,u)=>{let f=s(u),_=f.find("a.link_tit");(!_||_.length<=0)&&(_=f.find("a.total_tit"));let A=k(_.attr("href")??""),C=f.find("a.thumb img").attr("src");n.push({title:_.text(),body:f.find(".dsc_txt").text(),url:A,from:ue(A),imgLink:C})});break}case"yandex":{s(".content__left ul.serp-list > li.serp-item").each((l,u)=>{let f=s(u),_=f.find("a.organic__url"),A=k(_.attr("href")??""),I=f.find(".Favicon-Icon").css("background-image")?.slice(5).slice(0,-2);n.push({title:_.text(),body:f.find(".organic__content-wrapper").text(),url:A,imgLink:I,from:ue(A)})});break}case"sogou":{s(".results div.vrwrap").each((l,u)=>{let f=s(u),_=f.find("h3.vr-title a"),A=f.find(".text-layout").text();A||(A=f.find(".word-result").text()),A||(A=f.find(".space-txt").text());let C=k(_.attr("href")??"");C=C.startsWith("/")?location.origin+C:C;let R=f.find(".citeurl").text().replace(/\n\s*/g,"").split("-").find(M=>{try{let S=M.trim().replace("...","");return S.includes("/")&&(S=S.split("/")[0]),un(S)}catch{return!1}}),L=ue(R||"");n.push({title:_.text(),body:A,url:C,from:L,imgLink:os(L)})});break}case"brave":{s("#results > .snippet[data-type=web]").each((l,u)=>{let f=s(u),_=f.find(".snippet-title"),A=_.text(),C=_.closest("a"),I=f.find("img.favicon").attr("src");A||(_=f.find("a > div.url"),A=_.text(),C=_.closest("a"));let R=f.find(".snippet-content").text();R||(R=f.find(".snippet-description").text());let M=f.find(".snippet-url").children().first().text();f.attr("id")==="discussions"&&(A=f.find(".question > p.title").text(),R=f.find(".faq-a").text(),C=f.find("a.source").first(),M=f.find("img.forum-name").text());let S=k(C.attr("href")??"");n.push({title:A,body:R,url:S,imgLink:I,from:M})});break}case"bing":{n=_n(s);break}default:return[]}n=n.map(l=>{let u={...l};return u.from||(u.from=ue(u.url)),u.from&&(u.from=u.from.replace(/\.[^.]*$/,"")),!u.imgLink&&u.url&&(u.imgLink=os(u.url)),u.from=cs(u.from),u.body=cs(u.body),u.title=cs(u.title),u});let a=new Map;return n.filter(l=>a.has(l.url)?!1:(a.set(l.url,!0),!0))}catch{return[]}};function cs(e){return e.trim().replaceAll(`
`,"")||""}function ue(e){try{let t=dn(e.trim().replaceAll("...","")),n=new URL(t).host.split(".");return n.length>=3?n[1]:n[0]}catch{return e}}export{xs as a,sE as b,rE as c,nE as d,aE as e,iE as f,fE as g,oh as h,un as i,ph as j,wn as k,Gn as l,Wc as m};
