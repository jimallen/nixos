import{$ as mo,D as io,I as oo,L as ao,S as at,T as lt,X as Hr,Y as ho}from"./HIM55SOL.js";import{c as lo,r as Dr}from"./X2SRSDMC.js";import{c as no}from"./ECZ75PXO.js";import{a as Tt,b as ro,f as so}from"./UPAMUR3A.js";import{a as Rr,d as Pr,f as Mr,g as to}from"./4LWFKDT3.js";import{a as U}from"./USLLVG5P.js";import{a as xe}from"./ZO2DK75M.js";import{a as co}from"./6SFGN2RQ.js";import{a as Mn,b as po,d as Ur,e as On}from"./BDDH5KT2.js";import{a as Bl}from"./TPJJPVCY.js";import{a as Lr,b as eo}from"./RBW4HNBE.js";import{c as Vt,g as Ir,h as Ke,i as Ct,j as Ln,q as Zi,t as vt,u as Pn}from"./GDFJJHFX.js";import{a as Et}from"./42TZCCKB.js";import{a as Or,g as uo,i as kr}from"./GVJKCNTM.js";import{a as Qi,c as M,f as Se}from"./UTGLRY7A.js";var zo=M((Op,ei)=>{function jo(r,e){if(e&&e.documentElement)r=e,e=arguments[2];else if(!r||!r.documentElement)throw new Error("First argument to Readability constructor should be a document object.");if(e=e||{},this._doc=r,this._docJSDOMParser=this._doc.firstChild.__JSDOMParser__,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._debug=!!e.debug,this._maxElemsToParse=e.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=e.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=e.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(e.classesToPreserve||[]),this._keepClasses=!!e.keepClasses,this._serializer=e.serializer||function(t){return t.innerHTML},this._disableJSONLD=!!e.disableJSONLD,this._allowedVideoRegex=e.allowedVideoRegex||this.REGEXPS.videos,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug){let t=function(s){if(s.nodeType==s.TEXT_NODE)return`${s.nodeName} ("${s.textContent}")`;let n=Array.from(s.attributes||[],function(i){return`${i.name}="${i.value}"`}).join(" ");return`<${s.localName} ${n}>`};this.log=function(){if(typeof console<"u")Array.from(arguments,i=>i&&i.nodeType==this.ELEMENT_NODE?t(i):i).unshift("Reader: (Readability)");else if(typeof dump<"u"){var s=Array.prototype.map.call(arguments,function(n){return n&&n.nodeName?t(n):n}).join(" ");dump("Reader: (Readability) "+s+`
`)}}}else this.log=function(){}}jo.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/-ad-|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,shareElements:/(\b|_)(share|sharedaddy)(\b|_)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,tokenize:/\W+/g,whitespace:/^\s*$/,hasContent:/\S$/,hashUrl:/^#.+/,srcsetUrl:/(\S+)(\s+[\d.]+[xw])?(\s*(?:,|$))/g,b64DataUrl:/^data:\s*([^\s;,]+)\s*;\s*base64\s*,/i,jsonLdArticleTypes:/^Article|AdvertiserContentArticle|NewsArticle|AnalysisNewsArticle|AskPublicNewsArticle|BackgroundNewsArticle|OpinionNewsArticle|ReportageNewsArticle|ReviewNewsArticle|Report|SatiricalArticle|ScholarlyArticle|MedicalScholarlyArticle|SocialMediaPosting|BlogPosting|LiveBlogPosting|DiscussionForumPosting|TechArticle|APIReference$/},UNLIKELY_ROLES:["menu","menubar","complementary","navigation","alert","alertdialog","dialog"],DIV_TO_P_ELEMS:new Set(["BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL"]),ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],HTML_ESCAPE_MAP:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},_postProcessContent:function(r){this._fixRelativeUris(r),this._simplifyNestedElements(r),this._keepClasses||this._cleanClasses(r)},_removeNodes:function(r,e){if(this._docJSDOMParser&&r._isLiveNodeList)throw new Error("Do not pass live node lists to _removeNodes");for(var t=r.length-1;t>=0;t--){var s=r[t],n=s.parentNode;n&&(!e||e.call(this,s,t,r))&&n.removeChild(s)}},_replaceNodeTags:function(r,e){if(this._docJSDOMParser&&r._isLiveNodeList)throw new Error("Do not pass live node lists to _replaceNodeTags");for(let t of r)this._setNodeTag(t,e)},_forEachNode:function(r,e){Array.prototype.forEach.call(r,e,this)},_findNode:function(r,e){return Array.prototype.find.call(r,e,this)},_someNode:function(r,e){return Array.prototype.some.call(r,e,this)},_everyNode:function(r,e){return Array.prototype.every.call(r,e,this)},_concatNodeLists:function(){var r=Array.prototype.slice,e=r.call(arguments),t=e.map(function(s){return r.call(s)});return Array.prototype.concat.apply([],t)},_getAllNodesWithTag:function(r,e){return r.querySelectorAll?r.querySelectorAll(e.join(",")):[].concat.apply([],e.map(function(t){var s=r.getElementsByTagName(t);return Array.isArray(s)?s:Array.from(s)}))},_cleanClasses:function(r){var e=this._classesToPreserve,t=(r.getAttribute("class")||"").split(/\s+/).filter(function(s){return e.indexOf(s)!=-1}).join(" ");for(t?r.setAttribute("class",t):r.removeAttribute("class"),r=r.firstElementChild;r;r=r.nextElementSibling)this._cleanClasses(r)},_fixRelativeUris:function(r){var e=this._doc.baseURI,t=this._doc.documentURI;function s(o){if(e==t&&o.charAt(0)=="#")return o;try{return new URL(o,e).href}catch{}return o}var n=this._getAllNodesWithTag(r,["a"]);this._forEachNode(n,function(o){var l=o.getAttribute("href");if(l)if(l.indexOf("javascript:")===0)if(o.childNodes.length===1&&o.childNodes[0].nodeType===this.TEXT_NODE){var c=this._doc.createTextNode(o.textContent);o.parentNode.replaceChild(c,o)}else{for(var a=this._doc.createElement("span");o.firstChild;)a.appendChild(o.firstChild);o.parentNode.replaceChild(a,o)}else o.setAttribute("href",s(l))});var i=this._getAllNodesWithTag(r,["img","picture","figure","video","audio","source"]);this._forEachNode(i,function(o){var l=o.getAttribute("src"),c=o.getAttribute("poster"),a=o.getAttribute("srcset");if(l&&o.setAttribute("src",s(l)),c&&o.setAttribute("poster",s(c)),a){var u=a.replace(this.REGEXPS.srcsetUrl,function(g,S,E,R){return s(S)+(E||"")+R});o.setAttribute("srcset",u)}})},_simplifyNestedElements:function(r){for(var e=r;e;){if(e.parentNode&&["DIV","SECTION"].includes(e.tagName)&&!(e.id&&e.id.startsWith("readability"))){if(this._isElementWithoutContent(e)){e=this._removeAndGetNext(e);continue}else if(this._hasSingleTagInsideElement(e,"DIV")||this._hasSingleTagInsideElement(e,"SECTION")){for(var t=e.children[0],s=0;s<e.attributes.length;s++)t.setAttribute(e.attributes[s].name,e.attributes[s].value);e.parentNode.replaceChild(t,e),e=t;continue}}e=this._getNextNode(e)}},_getArticleTitle:function(){var r=this._doc,e="",t="";try{e=t=r.title.trim(),typeof e!="string"&&(e=t=this._getInnerText(r.getElementsByTagName("title")[0]))}catch{}var s=!1;function n(u){return u.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(e))s=/ [\\\/>»] /.test(e),e=t.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"),n(e)<3&&(e=t.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(e.indexOf(": ")!==-1){var i=this._concatNodeLists(r.getElementsByTagName("h1"),r.getElementsByTagName("h2")),o=e.trim(),l=this._someNode(i,function(u){return u.textContent.trim()===o});l||(e=t.substring(t.lastIndexOf(":")+1),n(e)<3?e=t.substring(t.indexOf(":")+1):n(t.substr(0,t.indexOf(":")))>5&&(e=t))}else if(e.length>150||e.length<15){var c=r.getElementsByTagName("h1");c.length===1&&(e=this._getInnerText(c[0]))}e=e.trim().replace(this.REGEXPS.normalize," ");var a=n(e);return a<=4&&(!s||a!=n(t.replace(/[\|\-\\\/>»]+/g,""))-1)&&(e=t),e},_prepDocument:function(){var r=this._doc;this._removeNodes(this._getAllNodesWithTag(r,["style"])),r.body&&this._replaceBrs(r.body),this._replaceNodeTags(this._getAllNodesWithTag(r,["font"]),"SPAN")},_nextNode:function(r){for(var e=r;e&&e.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(e.textContent);)e=e.nextSibling;return e},_replaceBrs:function(r){this._forEachNode(this._getAllNodesWithTag(r,["br"]),function(e){for(var t=e.nextSibling,s=!1;(t=this._nextNode(t))&&t.tagName=="BR";){s=!0;var n=t.nextSibling;t.parentNode.removeChild(t),t=n}if(s){var i=this._doc.createElement("p");for(e.parentNode.replaceChild(i,e),t=i.nextSibling;t;){if(t.tagName=="BR"){var o=this._nextNode(t.nextSibling);if(o&&o.tagName=="BR")break}if(!this._isPhrasingContent(t))break;var l=t.nextSibling;i.appendChild(t),t=l}for(;i.lastChild&&this._isWhitespace(i.lastChild);)i.removeChild(i.lastChild);i.parentNode.tagName==="P"&&this._setNodeTag(i.parentNode,"DIV")}})},_setNodeTag:function(r,e){if(this.log("_setNodeTag",r,e),this._docJSDOMParser)return r.localName=e.toLowerCase(),r.tagName=e.toUpperCase(),r;for(var t=r.ownerDocument.createElement(e);r.firstChild;)t.appendChild(r.firstChild);r.parentNode.replaceChild(t,r),r.readability&&(t.readability=r.readability);for(var s=0;s<r.attributes.length;s++)try{t.setAttribute(r.attributes[s].name,r.attributes[s].value)}catch{}return t},_prepArticle:function(r){this._cleanStyles(r),this._markDataTables(r),this._fixLazyImages(r),this._cleanConditionally(r,"form"),this._cleanConditionally(r,"fieldset"),this._clean(r,"object"),this._clean(r,"embed"),this._clean(r,"footer"),this._clean(r,"link"),this._clean(r,"aside");var e=this.DEFAULT_CHAR_THRESHOLD;this._forEachNode(r.children,function(t){this._cleanMatchedNodes(t,function(s,n){return this.REGEXPS.shareElements.test(n)&&s.textContent.length<e})}),this._clean(r,"iframe"),this._clean(r,"input"),this._clean(r,"textarea"),this._clean(r,"select"),this._clean(r,"button"),this._cleanHeaders(r),this._cleanConditionally(r,"table"),this._cleanConditionally(r,"ul"),this._cleanConditionally(r,"div"),this._replaceNodeTags(this._getAllNodesWithTag(r,["h1"]),"h2"),this._removeNodes(this._getAllNodesWithTag(r,["p"]),function(t){var s=t.getElementsByTagName("img").length,n=t.getElementsByTagName("embed").length,i=t.getElementsByTagName("object").length,o=t.getElementsByTagName("iframe").length,l=s+n+i+o;return l===0&&!this._getInnerText(t,!1)}),this._forEachNode(this._getAllNodesWithTag(r,["br"]),function(t){var s=this._nextNode(t.nextSibling);s&&s.tagName=="P"&&t.parentNode.removeChild(t)}),this._forEachNode(this._getAllNodesWithTag(r,["table"]),function(t){var s=this._hasSingleTagInsideElement(t,"TBODY")?t.firstElementChild:t;if(this._hasSingleTagInsideElement(s,"TR")){var n=s.firstElementChild;if(this._hasSingleTagInsideElement(n,"TD")){var i=n.firstElementChild;i=this._setNodeTag(i,this._everyNode(i.childNodes,this._isPhrasingContent)?"P":"DIV"),t.parentNode.replaceChild(i,t)}}})},_initializeNode:function(r){switch(r.readability={contentScore:0},r.tagName){case"DIV":r.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":r.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":r.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":r.readability.contentScore-=5;break}r.readability.contentScore+=this._getClassWeight(r)},_removeAndGetNext:function(r){var e=this._getNextNode(r,!0);return r.parentNode.removeChild(r),e},_getNextNode:function(r,e){if(!e&&r.firstElementChild)return r.firstElementChild;if(r.nextElementSibling)return r.nextElementSibling;do r=r.parentNode;while(r&&!r.nextElementSibling);return r&&r.nextElementSibling},_textSimilarity:function(r,e){var t=r.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean),s=e.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean);if(!t.length||!s.length)return 0;var n=s.filter(o=>!t.includes(o)),i=n.join(" ").length/s.join(" ").length;return 1-i},_checkByline:function(r,e){if(this._articleByline)return!1;if(r.getAttribute!==void 0)var t=r.getAttribute("rel"),s=r.getAttribute("itemprop");return(t==="author"||s&&s.indexOf("author")!==-1||this.REGEXPS.byline.test(e))&&this._isValidByline(r.textContent)?(this._articleByline=r.textContent.trim(),!0):!1},_getNodeAncestors:function(r,e){e=e||0;for(var t=0,s=[];r.parentNode&&(s.push(r.parentNode),!(e&&++t===e));)r=r.parentNode;return s},_grabArticle:function(r){this.log("**** grabArticle ****");var e=this._doc,t=r!==null;if(r=r||this._doc.body,!r)return this.log("No body found in document. Abort."),null;for(var s=r.innerHTML;;){this.log("Starting grabArticle loop");var n=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),i=[],o=this._doc.documentElement;let Ki=!0;for(;o;){o.tagName==="HTML"&&(this._articleLang=o.getAttribute("lang"));var l=o.className+" "+o.id;if(!this._isProbablyVisible(o)){this.log("Removing hidden node - "+l),o=this._removeAndGetNext(o);continue}if(o.getAttribute("aria-modal")=="true"&&o.getAttribute("role")=="dialog"){o=this._removeAndGetNext(o);continue}if(this._checkByline(o,l)){o=this._removeAndGetNext(o);continue}if(Ki&&this._headerDuplicatesTitle(o)){this.log("Removing header: ",o.textContent.trim(),this._articleTitle.trim()),Ki=!1,o=this._removeAndGetNext(o);continue}if(n){if(this.REGEXPS.unlikelyCandidates.test(l)&&!this.REGEXPS.okMaybeItsACandidate.test(l)&&!this._hasAncestorTag(o,"table")&&!this._hasAncestorTag(o,"code")&&o.tagName!=="BODY"&&o.tagName!=="A"){this.log("Removing unlikely candidate - "+l),o=this._removeAndGetNext(o);continue}if(this.UNLIKELY_ROLES.includes(o.getAttribute("role"))){this.log("Removing content with role "+o.getAttribute("role")+" - "+l),o=this._removeAndGetNext(o);continue}}if((o.tagName==="DIV"||o.tagName==="SECTION"||o.tagName==="HEADER"||o.tagName==="H1"||o.tagName==="H2"||o.tagName==="H3"||o.tagName==="H4"||o.tagName==="H5"||o.tagName==="H6")&&this._isElementWithoutContent(o)){o=this._removeAndGetNext(o);continue}if(this.DEFAULT_TAGS_TO_SCORE.indexOf(o.tagName)!==-1&&i.push(o),o.tagName==="DIV"){for(var c=null,a=o.firstChild;a;){var u=a.nextSibling;if(this._isPhrasingContent(a))c!==null?c.appendChild(a):this._isWhitespace(a)||(c=e.createElement("p"),o.replaceChild(c,a),c.appendChild(a));else if(c!==null){for(;c.lastChild&&this._isWhitespace(c.lastChild);)c.removeChild(c.lastChild);c=null}a=u}if(this._hasSingleTagInsideElement(o,"P")&&this._getLinkDensity(o)<.25){var g=o.children[0];o.parentNode.replaceChild(g,o),o=g,i.push(o)}else this._hasChildBlockElement(o)||(o=this._setNodeTag(o,"P"),i.push(o))}o=this._getNextNode(o)}var S=[];this._forEachNode(i,function(Ue){if(!(!Ue.parentNode||typeof Ue.parentNode.tagName>"u")){var Je=this._getInnerText(Ue);if(!(Je.length<25)){var Yi=this._getNodeAncestors(Ue,5);if(Yi.length!==0){var wr=0;wr+=1,wr+=Je.split(",").length,wr+=Math.min(Math.floor(Je.length/100),3),this._forEachNode(Yi,function(ot,In){if(!(!ot.tagName||!ot.parentNode||typeof ot.parentNode.tagName>"u")){if(typeof ot.readability>"u"&&(this._initializeNode(ot),S.push(ot)),In===0)var Rn=1;else In===1?Rn=2:Rn=In*3;ot.readability.contentScore+=wr/Rn}})}}}});for(var E=[],R=0,N=S.length;R<N;R+=1){var y=S[R],A=y.readability.contentScore*(1-this._getLinkDensity(y));y.readability.contentScore=A,this.log("Candidate:",y,"with score "+A);for(var k=0;k<this._nbTopCandidates;k++){var V=E[k];if(!V||A>V.readability.contentScore){E.splice(k,0,y),E.length>this._nbTopCandidates&&E.pop();break}}}var C=E[0]||null,H=!1,b;if(C===null||C.tagName==="BODY"){for(C=e.createElement("DIV"),H=!0;r.firstChild;)this.log("Moving child out:",r.firstChild),C.appendChild(r.firstChild);r.appendChild(C),this._initializeNode(C)}else if(C){for(var K=[],L=1;L<E.length;L++)E[L].readability.contentScore/C.readability.contentScore>=.75&&K.push(this._getNodeAncestors(E[L]));var v=3;if(K.length>=v)for(b=C.parentNode;b.tagName!=="BODY";){for(var _=0,ue=0;ue<K.length&&_<v;ue++)_+=Number(K[ue].includes(b));if(_>=v){C=b;break}b=b.parentNode}C.readability||this._initializeNode(C),b=C.parentNode;for(var ze=C.readability.contentScore,Nn=ze/3;b.tagName!=="BODY";){if(!b.readability){b=b.parentNode;continue}var Gt=b.readability.contentScore;if(Gt<Nn)break;if(Gt>ze){C=b;break}ze=b.readability.contentScore,b=b.parentNode}for(b=C.parentNode;b.tagName!="BODY"&&b.children.length==1;)C=b,b=C.parentNode;C.readability||this._initializeNode(C)}var $=e.createElement("DIV");t&&($.id="readability-content");var xr=Math.max(10,C.readability.contentScore*.2);b=C.parentNode;for(var Xe=b.children,Nr=0,ji=Xe.length;Nr<ji;Nr++){var z=Xe[Nr],qt=!1;if(this.log("Looking at sibling node:",z,z.readability?"with score "+z.readability.contentScore:""),this.log("Sibling has score",z.readability?z.readability.contentScore:"Unknown"),z===C)qt=!0;else{var zi=0;if(z.className===C.className&&C.className!==""&&(zi+=C.readability.contentScore*.2),z.readability&&z.readability.contentScore+zi>=xr)qt=!0;else if(z.nodeName==="P"){var Xi=this._getLinkDensity(z),Ji=this._getInnerText(z),An=Ji.length;(An>80&&Xi<.25||An<80&&An>0&&Xi===0&&Ji.search(/\.( |$)/)!==-1)&&(qt=!0)}}qt&&(this.log("Appending node:",z),this.ALTER_TO_DIV_EXCEPTIONS.indexOf(z.nodeName)===-1&&(this.log("Altering sibling:",z,"to div."),z=this._setNodeTag(z,"DIV")),$.appendChild(z),Xe=b.children,Nr-=1,ji-=1)}if(this._debug&&this.log("Article content pre-prep: "+$.innerHTML),this._prepArticle($),this._debug&&this.log("Article content post-prep: "+$.innerHTML),H)C.id="readability-page-1",C.className="page";else{var Ar=e.createElement("DIV");for(Ar.id="readability-page-1",Ar.className="page";$.firstChild;)Ar.appendChild($.firstChild);$.appendChild(Ar)}this._debug&&this.log("Article content after paging: "+$.innerHTML);var wn=!0,Ft=this._getInnerText($,!0).length;if(Ft<this._charThreshold)if(wn=!1,r.innerHTML=s,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS),this._attempts.push({articleContent:$,textLength:Ft});else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES),this._attempts.push({articleContent:$,textLength:Ft});else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY),this._attempts.push({articleContent:$,textLength:Ft});else{if(this._attempts.push({articleContent:$,textLength:Ft}),this._attempts.sort(function(Ue,Je){return Je.textLength-Ue.textLength}),!this._attempts[0].textLength)return null;$=this._attempts[0].articleContent,wn=!0}if(wn){var Ul=[b,C].concat(this._getNodeAncestors(b));return this._someNode(Ul,function(Ue){if(!Ue.tagName)return!1;var Je=Ue.getAttribute("dir");return Je?(this._articleDir=Je,!0):!1}),$}}},_isValidByline:function(r){return typeof r=="string"||r instanceof String?(r=r.trim(),r.length>0&&r.length<100):!1},_unescapeHtmlEntities:function(r){if(!r)return r;var e=this.HTML_ESCAPE_MAP;return r.replace(/&(quot|amp|apos|lt|gt);/g,function(t,s){return e[s]}).replace(/&#(?:x([0-9a-z]{1,4})|([0-9]{1,4}));/gi,function(t,s,n){var i=parseInt(s||n,s?16:10);return String.fromCharCode(i)})},_getJSONLD:function(r){var e=this._getAllNodesWithTag(r,["script"]),t;return this._forEachNode(e,function(s){if(!t&&s.getAttribute("type")==="application/ld+json")try{var n=s.textContent.replace(/^\s*<!\[CDATA\[|\]\]>\s*$/g,""),i=JSON.parse(n);if(!i["@context"]||!i["@context"].match(/^https?\:\/\/schema\.org$/)||(!i["@type"]&&Array.isArray(i["@graph"])&&(i=i["@graph"].find(function(a){return(a["@type"]||"").match(this.REGEXPS.jsonLdArticleTypes)})),!i||!i["@type"]||!i["@type"].match(this.REGEXPS.jsonLdArticleTypes)))return;if(t={},typeof i.name=="string"&&typeof i.headline=="string"&&i.name!==i.headline){var o=this._getArticleTitle(),l=this._textSimilarity(i.name,o)>.75,c=this._textSimilarity(i.headline,o)>.75;c&&!l?t.title=i.headline:t.title=i.name}else typeof i.name=="string"?t.title=i.name.trim():typeof i.headline=="string"&&(t.title=i.headline.trim());i.author&&(typeof i.author.name=="string"?t.byline=i.author.name.trim():Array.isArray(i.author)&&i.author[0]&&typeof i.author[0].name=="string"&&(t.byline=i.author.filter(function(a){return a&&typeof a.name=="string"}).map(function(a){return a.name.trim()}).join(", "))),typeof i.description=="string"&&(t.excerpt=i.description.trim()),i.publisher&&typeof i.publisher.name=="string"&&(t.siteName=i.publisher.name.trim());return}catch(a){this.log(a.message)}}),t||{}},_getArticleMetadata:function(r){var e={},t={},s=this._doc.getElementsByTagName("meta"),n=/\s*(dc|dcterm|og|twitter)\s*:\s*(author|creator|description|title|site_name)\s*/gi,i=/^\s*(?:(dc|dcterm|og|twitter|weibo:(article|webpage))\s*[\.:]\s*)?(author|creator|description|title|site_name)\s*$/i;return this._forEachNode(s,function(o){var l=o.getAttribute("name"),c=o.getAttribute("property"),a=o.getAttribute("content");if(a){var u=null,g=null;c&&(u=c.match(n),u&&(g=u[0].toLowerCase().replace(/\s/g,""),t[g]=a.trim())),!u&&l&&i.test(l)&&(g=l,a&&(g=g.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),t[g]=a.trim()))}}),e.title=r.title||t["dc:title"]||t["dcterm:title"]||t["og:title"]||t["weibo:article:title"]||t["weibo:webpage:title"]||t.title||t["twitter:title"],e.title||(e.title=this._getArticleTitle()),e.byline=r.byline||t["dc:creator"]||t["dcterm:creator"]||t.author,e.excerpt=r.excerpt||t["dc:description"]||t["dcterm:description"]||t["og:description"]||t["weibo:article:description"]||t["weibo:webpage:description"]||t.description||t["twitter:description"],e.siteName=r.siteName||t["og:site_name"],e.title=this._unescapeHtmlEntities(e.title),e.byline=this._unescapeHtmlEntities(e.byline),e.excerpt=this._unescapeHtmlEntities(e.excerpt),e.siteName=this._unescapeHtmlEntities(e.siteName),e},_isSingleImage:function(r){return r.tagName==="IMG"?!0:r.children.length!==1||r.textContent.trim()!==""?!1:this._isSingleImage(r.children[0])},_unwrapNoscriptImages:function(r){var e=Array.from(r.getElementsByTagName("img"));this._forEachNode(e,function(s){for(var n=0;n<s.attributes.length;n++){var i=s.attributes[n];switch(i.name){case"src":case"srcset":case"data-src":case"data-srcset":return}if(/\.(jpg|jpeg|png|webp)/i.test(i.value))return}s.parentNode.removeChild(s)});var t=Array.from(r.getElementsByTagName("noscript"));this._forEachNode(t,function(s){var n=r.createElement("div");if(n.innerHTML=s.innerHTML,!!this._isSingleImage(n)){var i=s.previousElementSibling;if(i&&this._isSingleImage(i)){var o=i;o.tagName!=="IMG"&&(o=i.getElementsByTagName("img")[0]);for(var l=n.getElementsByTagName("img")[0],c=0;c<o.attributes.length;c++){var a=o.attributes[c];if(a.value!==""&&(a.name==="src"||a.name==="srcset"||/\.(jpg|jpeg|png|webp)/i.test(a.value))){if(l.getAttribute(a.name)===a.value)continue;var u=a.name;l.hasAttribute(u)&&(u="data-old-"+u),l.setAttribute(u,a.value)}}s.parentNode.replaceChild(n.firstElementChild,i)}}})},_removeScripts:function(r){this._removeNodes(this._getAllNodesWithTag(r,["script","noscript"]))},_hasSingleTagInsideElement:function(r,e){return r.children.length!=1||r.children[0].tagName!==e?!1:!this._someNode(r.childNodes,function(t){return t.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(t.textContent)})},_isElementWithoutContent:function(r){return r.nodeType===this.ELEMENT_NODE&&r.textContent.trim().length==0&&(r.children.length==0||r.children.length==r.getElementsByTagName("br").length+r.getElementsByTagName("hr").length)},_hasChildBlockElement:function(r){return this._someNode(r.childNodes,function(e){return this.DIV_TO_P_ELEMS.has(e.tagName)||this._hasChildBlockElement(e)})},_isPhrasingContent:function(r){return r.nodeType===this.TEXT_NODE||this.PHRASING_ELEMS.indexOf(r.tagName)!==-1||(r.tagName==="A"||r.tagName==="DEL"||r.tagName==="INS")&&this._everyNode(r.childNodes,this._isPhrasingContent)},_isWhitespace:function(r){return r.nodeType===this.TEXT_NODE&&r.textContent.trim().length===0||r.nodeType===this.ELEMENT_NODE&&r.tagName==="BR"},_getInnerText:function(r,e){e=typeof e>"u"?!0:e;var t=r.textContent.trim();return e?t.replace(this.REGEXPS.normalize," "):t},_getCharCount:function(r,e){return e=e||",",this._getInnerText(r).split(e).length-1},_cleanStyles:function(r){if(!(!r||r.tagName.toLowerCase()==="svg")){for(var e=0;e<this.PRESENTATIONAL_ATTRIBUTES.length;e++)r.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[e]);this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.indexOf(r.tagName)!==-1&&(r.removeAttribute("width"),r.removeAttribute("height"));for(var t=r.firstElementChild;t!==null;)this._cleanStyles(t),t=t.nextElementSibling}},_getLinkDensity:function(r){var e=this._getInnerText(r).length;if(e===0)return 0;var t=0;return this._forEachNode(r.getElementsByTagName("a"),function(s){var n=s.getAttribute("href"),i=n&&this.REGEXPS.hashUrl.test(n)?.3:1;t+=this._getInnerText(s).length*i}),t/e},_getClassWeight:function(r){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var e=0;return typeof r.className=="string"&&r.className!==""&&(this.REGEXPS.negative.test(r.className)&&(e-=25),this.REGEXPS.positive.test(r.className)&&(e+=25)),typeof r.id=="string"&&r.id!==""&&(this.REGEXPS.negative.test(r.id)&&(e-=25),this.REGEXPS.positive.test(r.id)&&(e+=25)),e},_clean:function(r,e){var t=["object","embed","iframe"].indexOf(e)!==-1;this._removeNodes(this._getAllNodesWithTag(r,[e]),function(s){if(t){for(var n=0;n<s.attributes.length;n++)if(this._allowedVideoRegex.test(s.attributes[n].value))return!1;if(s.tagName==="object"&&this._allowedVideoRegex.test(s.innerHTML))return!1}return!0})},_hasAncestorTag:function(r,e,t,s){t=t||3,e=e.toUpperCase();for(var n=0;r.parentNode;){if(t>0&&n>t)return!1;if(r.parentNode.tagName===e&&(!s||s(r.parentNode)))return!0;r=r.parentNode,n++}return!1},_getRowAndColumnCount:function(r){for(var e=0,t=0,s=r.getElementsByTagName("tr"),n=0;n<s.length;n++){var i=s[n].getAttribute("rowspan")||0;i&&(i=parseInt(i,10)),e+=i||1;for(var o=0,l=s[n].getElementsByTagName("td"),c=0;c<l.length;c++){var a=l[c].getAttribute("colspan")||0;a&&(a=parseInt(a,10)),o+=a||1}t=Math.max(t,o)}return{rows:e,columns:t}},_markDataTables:function(r){for(var e=r.getElementsByTagName("table"),t=0;t<e.length;t++){var s=e[t],n=s.getAttribute("role");if(n=="presentation"){s._readabilityDataTable=!1;continue}var i=s.getAttribute("datatable");if(i=="0"){s._readabilityDataTable=!1;continue}var o=s.getAttribute("summary");if(o){s._readabilityDataTable=!0;continue}var l=s.getElementsByTagName("caption")[0];if(l&&l.childNodes.length>0){s._readabilityDataTable=!0;continue}var c=["col","colgroup","tfoot","thead","th"],a=function(g){return!!s.getElementsByTagName(g)[0]};if(c.some(a)){this.log("Data table because found data-y descendant"),s._readabilityDataTable=!0;continue}if(s.getElementsByTagName("table")[0]){s._readabilityDataTable=!1;continue}var u=this._getRowAndColumnCount(s);if(u.rows>=10||u.columns>4){s._readabilityDataTable=!0;continue}s._readabilityDataTable=u.rows*u.columns>10}},_fixLazyImages:function(r){this._forEachNode(this._getAllNodesWithTag(r,["img","picture","figure"]),function(e){if(e.src&&this.REGEXPS.b64DataUrl.test(e.src)){var t=this.REGEXPS.b64DataUrl.exec(e.src);if(t[1]==="image/svg+xml")return;for(var s=!1,n=0;n<e.attributes.length;n++){var i=e.attributes[n];if(i.name!=="src"&&/\.(jpg|jpeg|png|webp)/i.test(i.value)){s=!0;break}}if(s){var o=e.src.search(/base64\s*/i)+7,l=e.src.length-o;l<133&&e.removeAttribute("src")}}if(!((e.src||e.srcset&&e.srcset!="null")&&e.className.toLowerCase().indexOf("lazy")===-1)){for(var c=0;c<e.attributes.length;c++)if(i=e.attributes[c],!(i.name==="src"||i.name==="srcset"||i.name==="alt")){var a=null;if(/\.(jpg|jpeg|png|webp)\s+\d/.test(i.value)?a="srcset":/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/.test(i.value)&&(a="src"),a){if(e.tagName==="IMG"||e.tagName==="PICTURE")e.setAttribute(a,i.value);else if(e.tagName==="FIGURE"&&!this._getAllNodesWithTag(e,["img","picture"]).length){var u=this._doc.createElement("img");u.setAttribute(a,i.value),e.appendChild(u)}}}}})},_getTextDensity:function(r,e){var t=this._getInnerText(r,!0).length;if(t===0)return 0;var s=0,n=this._getAllNodesWithTag(r,e);return this._forEachNode(n,i=>s+=this._getInnerText(i,!0).length),s/t},_cleanConditionally:function(r,e){this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)&&this._removeNodes(this._getAllNodesWithTag(r,[e]),function(t){var s=function(b){return b._readabilityDataTable},n=e==="ul"||e==="ol";if(!n){var i=0,o=this._getAllNodesWithTag(t,["ul","ol"]);this._forEachNode(o,b=>i+=this._getInnerText(b).length),n=i/this._getInnerText(t).length>.9}if(e==="table"&&s(t)||this._hasAncestorTag(t,"table",-1,s)||this._hasAncestorTag(t,"code"))return!1;var l=this._getClassWeight(t);this.log("Cleaning Conditionally",t);var c=0;if(l+c<0)return!0;if(this._getCharCount(t,",")<10){for(var a=t.getElementsByTagName("p").length,u=t.getElementsByTagName("img").length,g=t.getElementsByTagName("li").length-100,S=t.getElementsByTagName("input").length,E=this._getTextDensity(t,["h1","h2","h3","h4","h5","h6"]),R=0,N=this._getAllNodesWithTag(t,["object","embed","iframe"]),y=0;y<N.length;y++){for(var A=0;A<N[y].attributes.length;A++)if(this._allowedVideoRegex.test(N[y].attributes[A].value))return!1;if(N[y].tagName==="object"&&this._allowedVideoRegex.test(N[y].innerHTML))return!1;R++}var k=this._getLinkDensity(t),V=this._getInnerText(t).length,C=u>1&&a/u<.5&&!this._hasAncestorTag(t,"figure")||!n&&g>a||S>Math.floor(a/3)||!n&&E<.9&&V<25&&(u===0||u>2)&&!this._hasAncestorTag(t,"figure")||!n&&l<25&&k>.2||l>=25&&k>.5||R===1&&V<75||R>1;if(n&&C){for(var H=0;H<t.children.length;H++)if(t.children[H].children.length>1)return C;let b=t.getElementsByTagName("li").length;if(u==b)return!1}return C}return!1})},_cleanMatchedNodes:function(r,e){for(var t=this._getNextNode(r,!0),s=this._getNextNode(r);s&&s!=t;)e.call(this,s,s.className+" "+s.id)?s=this._removeAndGetNext(s):s=this._getNextNode(s)},_cleanHeaders:function(r){let e=this._getAllNodesWithTag(r,["h1","h2"]);this._removeNodes(e,function(t){let s=this._getClassWeight(t)<0;return s&&this.log("Removing header with low class weight:",t),s})},_headerDuplicatesTitle:function(r){if(r.tagName!="H1"&&r.tagName!="H2")return!1;var e=this._getInnerText(r,!1);return this.log("Evaluating similarity of header:",e,this._articleTitle),this._textSimilarity(this._articleTitle,e)>.75},_flagIsActive:function(r){return(this._flags&r)>0},_removeFlag:function(r){this._flags=this._flags&~r},_isProbablyVisible:function(r){return(!r.style||r.style.display!="none")&&!r.hasAttribute("hidden")&&(!r.hasAttribute("aria-hidden")||r.getAttribute("aria-hidden")!="true"||r.className&&r.className.indexOf&&r.className.indexOf("fallback-image")!==-1)},parse:function(){if(this._maxElemsToParse>0){var r=this._doc.getElementsByTagName("*").length;if(r>this._maxElemsToParse)throw new Error("Aborting parsing document; "+r+" elements found")}this._unwrapNoscriptImages(this._doc);var e=this._disableJSONLD?{}:this._getJSONLD(this._doc);this._removeScripts(this._doc),this._prepDocument();var t=this._getArticleMetadata(e);this._articleTitle=t.title;var s=this._grabArticle();if(!s)return null;if(this.log("Grabbed: "+s.innerHTML),this._postProcessContent(s),!t.excerpt){var n=s.getElementsByTagName("p");n.length>0&&(t.excerpt=n[0].textContent.trim())}var i=s.textContent;return{title:this._articleTitle,byline:t.byline||this._articleByline,dir:this._articleDir,lang:this._articleLang,content:this._serializer(s),textContent:i,length:i.length,excerpt:t.excerpt,siteName:t.siteName||this._articleSiteName}}};typeof ei=="object"&&(ei.exports=jo)});var Jo=M((kp,ti)=>{var Xo={unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i};function Oc(r){return(!r.style||r.style.display!="none")&&!r.hasAttribute("hidden")&&(!r.hasAttribute("aria-hidden")||r.getAttribute("aria-hidden")!="true"||r.className&&r.className.indexOf&&r.className.indexOf("fallback-image")!==-1)}function kc(r,e={}){typeof e=="function"&&(e={visibilityChecker:e});var t={minScore:20,minContentLength:140,visibilityChecker:Oc};e=Object.assign(t,e);var s=r.querySelectorAll("p, pre, article"),n=r.querySelectorAll("div > br");if(n.length){var i=new Set(s);[].forEach.call(n,function(l){i.add(l.parentNode)}),s=Array.from(i)}var o=0;return[].some.call(s,function(l){if(!e.visibilityChecker(l))return!1;var c=l.className+" "+l.id;if(Xo.unlikelyCandidates.test(c)&&!Xo.okMaybeItsACandidate.test(c)||l.matches("li p"))return!1;var a=l.textContent.trim().length;return a<e.minContentLength?!1:(o+=Math.sqrt(a-e.minContentLength),o>e.minScore)})}typeof ti=="object"&&(ti.exports=kc)});var Yo=M((Dp,Ko)=>{var Dc=zo(),Hc=Jo();Ko.exports={Readability:Dc,isProbablyReaderable:Hc}});var da=M(ci=>{try{let{performance:r}=Qi("perf_hooks");ci.performance=r}catch{ci.performance={now(){return+new Date}}}});var Pi=M(ka=>{var Oa={};Oa.StyleSheet=function(){this.parentStyleSheet=null};ka.StyleSheet=Oa.StyleSheet});var oe=M(Da=>{var q={};q.CSSRule=function(){this.parentRule=null,this.parentStyleSheet=null};q.CSSRule.UNKNOWN_RULE=0;q.CSSRule.STYLE_RULE=1;q.CSSRule.CHARSET_RULE=2;q.CSSRule.IMPORT_RULE=3;q.CSSRule.MEDIA_RULE=4;q.CSSRule.FONT_FACE_RULE=5;q.CSSRule.PAGE_RULE=6;q.CSSRule.KEYFRAMES_RULE=7;q.CSSRule.KEYFRAME_RULE=8;q.CSSRule.MARGIN_RULE=9;q.CSSRule.NAMESPACE_RULE=10;q.CSSRule.COUNTER_STYLE_RULE=11;q.CSSRule.SUPPORTS_RULE=12;q.CSSRule.DOCUMENT_RULE=13;q.CSSRule.FONT_FEATURE_VALUES_RULE=14;q.CSSRule.VIEWPORT_RULE=15;q.CSSRule.REGION_STYLE_RULE=16;q.CSSRule.prototype={constructor:q.CSSRule};Da.CSSRule=q.CSSRule});var lr=M(Ha=>{var le={CSSStyleDeclaration:ft().CSSStyleDeclaration,CSSRule:oe().CSSRule};le.CSSStyleRule=function(){le.CSSRule.call(this),this.selectorText="",this.style=new le.CSSStyleDeclaration,this.style.parentRule=this};le.CSSStyleRule.prototype=new le.CSSRule;le.CSSStyleRule.prototype.constructor=le.CSSStyleRule;le.CSSStyleRule.prototype.type=1;Object.defineProperty(le.CSSStyleRule.prototype,"cssText",{get:function(){var r;return this.selectorText?r=this.selectorText+" {"+this.style.cssText+"}":r="",r},set:function(r){var e=le.CSSStyleRule.parse(r);this.style=e.style,this.selectorText=e.selectorText}});le.CSSStyleRule.parse=function(r){for(var e=0,t="selector",s,n=e,i="",o={selector:!0,value:!0},l=new le.CSSStyleRule,c,a="",u;u=r.charAt(e);e++)switch(u){case" ":case"	":case"\r":case`
`:case"\f":if(o[t])switch(r.charAt(e-1)){case" ":case"	":case"\r":case`
`:case"\f":break;default:i+=" ";break}break;case'"':if(n=e+1,s=r.indexOf('"',n)+1,!s)throw'" is missing';i+=r.slice(e,s),e=s-1;break;case"'":if(n=e+1,s=r.indexOf("'",n)+1,!s)throw"' is missing";i+=r.slice(e,s),e=s-1;break;case"/":if(r.charAt(e+1)==="*"){if(e+=2,s=r.indexOf("*/",e),s===-1)throw new SyntaxError("Missing */");e=s+1}else i+=u;break;case"{":t==="selector"&&(l.selectorText=i.trim(),i="",t="name");break;case":":t==="name"?(c=i.trim(),i="",t="value"):i+=u;break;case"!":t==="value"&&r.indexOf("!important",e)===e?(a="important",e+=9):i+=u;break;case";":t==="value"?(l.style.setProperty(c,i.trim(),a),a="",i="",t="name"):i+=u;break;case"}":if(t==="value")l.style.setProperty(c,i.trim(),a),a="",i="";else{if(t==="name")break;i+=u}t="selector";break;default:i+=u;break}return l};Ha.CSSStyleRule=le.CSSStyleRule});var cr=M(Ua=>{var fe={StyleSheet:Pi().StyleSheet,CSSStyleRule:lr().CSSStyleRule};fe.CSSStyleSheet=function(){fe.StyleSheet.call(this),this.cssRules=[]};fe.CSSStyleSheet.prototype=new fe.StyleSheet;fe.CSSStyleSheet.prototype.constructor=fe.CSSStyleSheet;fe.CSSStyleSheet.prototype.insertRule=function(r,e){if(e<0||e>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var t=fe.parse(r).cssRules[0];return t.parentStyleSheet=this,this.cssRules.splice(e,0,t),e};fe.CSSStyleSheet.prototype.deleteRule=function(r){if(r<0||r>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(r,1)};fe.CSSStyleSheet.prototype.toString=function(){for(var r="",e=this.cssRules,t=0;t<e.length;t++)r+=e[t].cssText+`
`;return r};Ua.CSSStyleSheet=fe.CSSStyleSheet;fe.parse=ys().parse});var Cs=M(Ba=>{var Es={};Es.MediaList=function(){this.length=0};Es.MediaList.prototype={constructor:Es.MediaList,get mediaText(){return Array.prototype.join.call(this,", ")},set mediaText(r){for(var e=r.split(","),t=this.length=e.length,s=0;s<t;s++)this[s]=e[s].trim()},appendMedium:function(r){Array.prototype.indexOf.call(this,r)===-1&&(this[this.length]=r,this.length++)},deleteMedium:function(r){var e=Array.prototype.indexOf.call(this,r);e!==-1&&Array.prototype.splice.call(this,e,1)}};Ba.MediaList=Es.MediaList});var Mi=M(Ga=>{var be={CSSRule:oe().CSSRule,CSSStyleSheet:cr().CSSStyleSheet,MediaList:Cs().MediaList};be.CSSImportRule=function(){be.CSSRule.call(this),this.href="",this.media=new be.MediaList,this.styleSheet=new be.CSSStyleSheet};be.CSSImportRule.prototype=new be.CSSRule;be.CSSImportRule.prototype.constructor=be.CSSImportRule;be.CSSImportRule.prototype.type=3;Object.defineProperty(be.CSSImportRule.prototype,"cssText",{get:function(){var r=this.media.mediaText;return"@import url("+this.href+")"+(r?" "+r:"")+";"},set:function(r){for(var e=0,t="",s="",n,i;i=r.charAt(e);e++)switch(i){case" ":case"	":case"\r":case`
`:case"\f":t==="after-import"?t="url":s+=i;break;case"@":!t&&r.indexOf("@import",e)===e&&(t="after-import",e+=6,s="");break;case"u":if(t==="url"&&r.indexOf("url(",e)===e){if(n=r.indexOf(")",e+1),n===-1)throw e+': ")" not found';e+=4;var o=r.slice(e,n);o[0]===o[o.length-1]&&(o[0]==='"'||o[0]==="'")&&(o=o.slice(1,-1)),this.href=o,e=n,t="media"}break;case'"':if(t==="url"){if(n=r.indexOf('"',e+1),!n)throw e+`: '"' not found`;this.href=r.slice(e+1,n),e=n,t="media"}break;case"'":if(t==="url"){if(n=r.indexOf("'",e+1),!n)throw e+`: "'" not found`;this.href=r.slice(e+1,n),e=n,t="media"}break;case";":t==="media"&&s&&(this.media.mediaText=s.trim());break;default:t==="media"&&(s+=i);break}}});Ga.CSSImportRule=be.CSSImportRule});var St=M(qa=>{var Pe={CSSRule:oe().CSSRule};Pe.CSSGroupingRule=function(){Pe.CSSRule.call(this),this.cssRules=[]};Pe.CSSGroupingRule.prototype=new Pe.CSSRule;Pe.CSSGroupingRule.prototype.constructor=Pe.CSSGroupingRule;Pe.CSSGroupingRule.prototype.insertRule=function(e,t){if(t<0||t>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var s=Pe.parse(e).cssRules[0];return s.parentRule=this,this.cssRules.splice(t,0,s),t};Pe.CSSGroupingRule.prototype.deleteRule=function(e){if(e<0||e>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(e,1)[0].parentRule=null};qa.CSSGroupingRule=Pe.CSSGroupingRule});var kt=M(Fa=>{var Ve={CSSRule:oe().CSSRule,CSSGroupingRule:St().CSSGroupingRule};Ve.CSSConditionRule=function(){Ve.CSSGroupingRule.call(this),this.cssRules=[]};Ve.CSSConditionRule.prototype=new Ve.CSSGroupingRule;Ve.CSSConditionRule.prototype.constructor=Ve.CSSConditionRule;Ve.CSSConditionRule.prototype.conditionText="";Ve.CSSConditionRule.prototype.cssText="";Fa.CSSConditionRule=Ve.CSSConditionRule});var vs=M(Va=>{var Me={CSSRule:oe().CSSRule,CSSGroupingRule:St().CSSGroupingRule,CSSConditionRule:kt().CSSConditionRule,MediaList:Cs().MediaList};Me.CSSMediaRule=function(){Me.CSSConditionRule.call(this),this.media=new Me.MediaList};Me.CSSMediaRule.prototype=new Me.CSSConditionRule;Me.CSSMediaRule.prototype.constructor=Me.CSSMediaRule;Me.CSSMediaRule.prototype.type=4;Object.defineProperties(Me.CSSMediaRule.prototype,{conditionText:{get:function(){return this.media.mediaText},set:function(r){this.media.mediaText=r},configurable:!0,enumerable:!0},cssText:{get:function(){for(var r=[],e=0,t=this.cssRules.length;e<t;e++)r.push(this.cssRules[e].cssText);return"@media "+this.media.mediaText+" {"+r.join("")+"}"},configurable:!0,enumerable:!0}});Va.CSSMediaRule=Me.CSSMediaRule});var Ts=M($a=>{var $e={CSSRule:oe().CSSRule,CSSGroupingRule:St().CSSGroupingRule,CSSConditionRule:kt().CSSConditionRule};$e.CSSSupportsRule=function(){$e.CSSConditionRule.call(this)};$e.CSSSupportsRule.prototype=new $e.CSSConditionRule;$e.CSSSupportsRule.prototype.constructor=$e.CSSSupportsRule;$e.CSSSupportsRule.prototype.type=12;Object.defineProperty($e.CSSSupportsRule.prototype,"cssText",{get:function(){for(var r=[],e=0,t=this.cssRules.length;e<t;e++)r.push(this.cssRules[e].cssText);return"@supports "+this.conditionText+" {"+r.join("")+"}"}});$a.CSSSupportsRule=$e.CSSSupportsRule});var Oi=M(Wa=>{var Oe={CSSStyleDeclaration:ft().CSSStyleDeclaration,CSSRule:oe().CSSRule};Oe.CSSFontFaceRule=function(){Oe.CSSRule.call(this),this.style=new Oe.CSSStyleDeclaration,this.style.parentRule=this};Oe.CSSFontFaceRule.prototype=new Oe.CSSRule;Oe.CSSFontFaceRule.prototype.constructor=Oe.CSSFontFaceRule;Oe.CSSFontFaceRule.prototype.type=5;Object.defineProperty(Oe.CSSFontFaceRule.prototype,"cssText",{get:function(){return"@font-face {"+this.style.cssText+"}"}});Wa.CSSFontFaceRule=Oe.CSSFontFaceRule});var ki=M(ja=>{var We={CSSRule:oe().CSSRule};We.CSSHostRule=function(){We.CSSRule.call(this),this.cssRules=[]};We.CSSHostRule.prototype=new We.CSSRule;We.CSSHostRule.prototype.constructor=We.CSSHostRule;We.CSSHostRule.prototype.type=1001;Object.defineProperty(We.CSSHostRule.prototype,"cssText",{get:function(){for(var r=[],e=0,t=this.cssRules.length;e<t;e++)r.push(this.cssRules[e].cssText);return"@host {"+r.join("")+"}"}});ja.CSSHostRule=We.CSSHostRule});var bs=M(za=>{var ke={CSSRule:oe().CSSRule,CSSStyleDeclaration:ft().CSSStyleDeclaration};ke.CSSKeyframeRule=function(){ke.CSSRule.call(this),this.keyText="",this.style=new ke.CSSStyleDeclaration,this.style.parentRule=this};ke.CSSKeyframeRule.prototype=new ke.CSSRule;ke.CSSKeyframeRule.prototype.constructor=ke.CSSKeyframeRule;ke.CSSKeyframeRule.prototype.type=8;Object.defineProperty(ke.CSSKeyframeRule.prototype,"cssText",{get:function(){return this.keyText+" {"+this.style.cssText+"} "}});za.CSSKeyframeRule=ke.CSSKeyframeRule});var _s=M(Xa=>{var je={CSSRule:oe().CSSRule};je.CSSKeyframesRule=function(){je.CSSRule.call(this),this.name="",this.cssRules=[]};je.CSSKeyframesRule.prototype=new je.CSSRule;je.CSSKeyframesRule.prototype.constructor=je.CSSKeyframesRule;je.CSSKeyframesRule.prototype.type=7;Object.defineProperty(je.CSSKeyframesRule.prototype,"cssText",{get:function(){for(var r=[],e=0,t=this.cssRules.length;e<t;e++)r.push("  "+this.cssRules[e].cssText);return"@"+(this._vendorPrefix||"")+"keyframes "+this.name+` { 
`+r.join(`
`)+`
}`}});Xa.CSSKeyframesRule=je.CSSKeyframesRule});var Di=M(Ja=>{var xs={};xs.CSSValue=function(){};xs.CSSValue.prototype={constructor:xs.CSSValue,set cssText(r){var e=this._getConstructorName();throw new Error('DOMException: property "cssText" of "'+e+'" is readonly and can not be replaced with "'+r+'"!')},get cssText(){var r=this._getConstructorName();throw new Error('getter "cssText" of "'+r+'" is not implemented!')},_getConstructorName:function(){var r=this.constructor.toString(),e=r.match(/function\s([^\(]+)/),t=e[1];return t}};Ja.CSSValue=xs.CSSValue});var Hi=M(Ka=>{var _e={CSSValue:Di().CSSValue};_e.CSSValueExpression=function(e,t){this._token=e,this._idx=t};_e.CSSValueExpression.prototype=new _e.CSSValue;_e.CSSValueExpression.prototype.constructor=_e.CSSValueExpression;_e.CSSValueExpression.prototype.parse=function(){for(var r=this._token,e=this._idx,t="",s="",n="",i,o=[];;++e){if(t=r.charAt(e),t===""){n="css expression error: unfinished expression!";break}switch(t){case"(":o.push(t),s+=t;break;case")":o.pop(t),s+=t;break;case"/":(i=this._parseJSComment(r,e))?i.error?n="css expression error: unfinished comment in expression!":e=i.idx:(i=this._parseJSRexExp(r,e))?(e=i.idx,s+=i.text):s+=t;break;case"'":case'"':i=this._parseJSString(r,e,t),i?(e=i.idx,s+=i.text):s+=t;break;default:s+=t;break}if(n||o.length===0)break}var l;return n?l={error:n}:l={idx:e,expression:s},l};_e.CSSValueExpression.prototype._parseJSComment=function(r,e){var t=r.charAt(e+1),s;if(t==="/"||t==="*"){var n=e,i,o;if(t==="/"?o=`
`:t==="*"&&(o="*/"),i=r.indexOf(o,n+1+1),i!==-1)return i=i+o.length-1,s=r.substring(e,i+1),{idx:i,text:s};var l="css expression error: unfinished comment in expression!";return{error:l}}else return!1};_e.CSSValueExpression.prototype._parseJSString=function(r,e,t){var s=this._findMatchedIdx(r,e,t),n;return s===-1?!1:(n=r.substring(e,s+t.length),{idx:s,text:n})};_e.CSSValueExpression.prototype._parseJSRexExp=function(r,e){var t=r.substring(0,e).replace(/\s+$/,""),s=[/^$/,/\($/,/\[$/,/\!$/,/\+$/,/\-$/,/\*$/,/\/\s+/,/\%$/,/\=$/,/\>$/,/<$/,/\&$/,/\|$/,/\^$/,/\~$/,/\?$/,/\,$/,/delete$/,/in$/,/instanceof$/,/new$/,/typeof$/,/void$/],n=s.some(function(o){return o.test(t)});if(n){var i="/";return this._parseJSString(r,e,i)}else return!1};_e.CSSValueExpression.prototype._findMatchedIdx=function(r,e,t){for(var s=e,n,i=-1;;)if(n=r.indexOf(t,s+1),n===-1){n=i;break}else{var o=r.substring(e+1,n),l=o.match(/\\+$/);if(!l||l[0]%2===0)break;s=n}var c=r.indexOf(`
`,e+1);return c<n&&(n=i),n};Ka.CSSValueExpression=_e.CSSValueExpression});var Ui=M(Ya=>{var Ns={};Ns.MatcherList=function(){this.length=0};Ns.MatcherList.prototype={constructor:Ns.MatcherList,get matcherText(){return Array.prototype.join.call(this,", ")},set matcherText(r){for(var e=r.split(","),t=this.length=e.length,s=0;s<t;s++)this[s]=e[s].trim()},appendMatcher:function(r){Array.prototype.indexOf.call(this,r)===-1&&(this[this.length]=r,this.length++)},deleteMatcher:function(r){var e=Array.prototype.indexOf.call(this,r);e!==-1&&Array.prototype.splice.call(this,e,1)}};Ya.MatcherList=Ns.MatcherList});var Bi=M(Qa=>{var De={CSSRule:oe().CSSRule,MatcherList:Ui().MatcherList};De.CSSDocumentRule=function(){De.CSSRule.call(this),this.matcher=new De.MatcherList,this.cssRules=[]};De.CSSDocumentRule.prototype=new De.CSSRule;De.CSSDocumentRule.prototype.constructor=De.CSSDocumentRule;De.CSSDocumentRule.prototype.type=10;Object.defineProperty(De.CSSDocumentRule.prototype,"cssText",{get:function(){for(var r=[],e=0,t=this.cssRules.length;e<t;e++)r.push(this.cssRules[e].cssText);return"@-moz-document "+this.matcher.matcherText+" {"+r.join("")+"}"}});Qa.CSSDocumentRule=De.CSSDocumentRule});var ys=M(Za=>{var O={};O.parse=function(e){for(var t=0,s="before-selector",n,i="",o=0,l={selector:!0,value:!0,"value-parenthesis":!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0,conditionBlock:!0,"documentRule-begin":!0},c=new O.CSSStyleSheet,a=c,u,g=[],S=!1,E,R,N="",y,A,k,V,C,H,b,K,L=/@(-(?:\w+-)+)?keyframes/g,v=function(Nn){var Gt=e.substring(0,t).split(`
`),$=Gt.length,xr=Gt.pop().length+1,Xe=new Error(Nn+" (line "+$+", char "+xr+")");throw Xe.line=$,Xe.char=xr,Xe.styleSheet=c,Xe},_;_=e.charAt(t);t++)switch(_){case" ":case"	":case"\r":case`
`:case"\f":l[s]&&(i+=_);break;case'"':n=t+1;do n=e.indexOf('"',n)+1,n||v('Unmatched "');while(e[n-2]==="\\");switch(i+=e.slice(t,n),t=n-1,s){case"before-value":s="value";break;case"importRule-begin":s="importRule";break}break;case"'":n=t+1;do n=e.indexOf("'",n)+1,n||v("Unmatched '");while(e[n-2]==="\\");switch(i+=e.slice(t,n),t=n-1,s){case"before-value":s="value";break;case"importRule-begin":s="importRule";break}break;case"/":e.charAt(t+1)==="*"?(t+=2,n=e.indexOf("*/",t),n===-1?v("Missing */"):t=n+1):i+=_,s==="importRule-begin"&&(i+=" ",s="importRule");break;case"@":if(e.indexOf("@-moz-document",t)===t){s="documentRule-begin",b=new O.CSSDocumentRule,b.__starts=t,t+=13,i="";break}else if(e.indexOf("@media",t)===t){s="atBlock",A=new O.CSSMediaRule,A.__starts=t,t+=5,i="";break}else if(e.indexOf("@supports",t)===t){s="conditionBlock",k=new O.CSSSupportsRule,k.__starts=t,t+=8,i="";break}else if(e.indexOf("@host",t)===t){s="hostRule-begin",t+=4,K=new O.CSSHostRule,K.__starts=t,i="";break}else if(e.indexOf("@import",t)===t){s="importRule-begin",t+=6,i+="@import";break}else if(e.indexOf("@font-face",t)===t){s="fontFaceRule-begin",t+=9,C=new O.CSSFontFaceRule,C.__starts=t,i="";break}else{L.lastIndex=t;var ue=L.exec(e);if(ue&&ue.index===t){s="keyframesRule-begin",H=new O.CSSKeyframesRule,H.__starts=t,H._vendorPrefix=ue[1],t+=ue[0].length-1,i="";break}else s==="selector"&&(s="atRule")}i+=_;break;case"{":s==="selector"||s==="atRule"?(y.selectorText=i.trim(),y.style.__starts=t,i="",s="before-name"):s==="atBlock"?(A.media.mediaText=i.trim(),u&&g.push(u),a=u=A,A.parentStyleSheet=c,i="",s="before-selector"):s==="conditionBlock"?(k.conditionText=i.trim(),u&&g.push(u),a=u=k,k.parentStyleSheet=c,i="",s="before-selector"):s==="hostRule-begin"?(u&&g.push(u),a=u=K,K.parentStyleSheet=c,i="",s="before-selector"):s==="fontFaceRule-begin"?(u&&(C.parentRule=u),C.parentStyleSheet=c,y=C,i="",s="before-name"):s==="keyframesRule-begin"?(H.name=i.trim(),u&&(g.push(u),H.parentRule=u),H.parentStyleSheet=c,a=u=H,i="",s="keyframeRule-begin"):s==="keyframeRule-begin"?(y=new O.CSSKeyframeRule,y.keyText=i.trim(),y.__starts=t,i="",s="before-name"):s==="documentRule-begin"&&(b.matcher.matcherText=i.trim(),u&&(g.push(u),b.parentRule=u),a=u=b,b.parentStyleSheet=c,i="",s="before-selector");break;case":":s==="name"?(R=i.trim(),i="",s="before-value"):i+=_;break;case"(":if(s==="value")if(i.trim()==="expression"){var ze=new O.CSSValueExpression(e,t).parse();ze.error?v(ze.error):(i+=ze.expression,t=ze.idx)}else s="value-parenthesis",o=1,i+=_;else s==="value-parenthesis"&&o++,i+=_;break;case")":s==="value-parenthesis"&&(o--,o===0&&(s="value")),i+=_;break;case"!":s==="value"&&e.indexOf("!important",t)===t?(N="important",t+=9):i+=_;break;case";":switch(s){case"value":y.style.setProperty(R,i.trim(),N),N="",i="",s="before-name";break;case"atRule":i="",s="before-selector";break;case"importRule":V=new O.CSSImportRule,V.parentStyleSheet=V.styleSheet.parentStyleSheet=c,V.cssText=i+_,c.cssRules.push(V),i="",s="before-selector";break;default:i+=_;break}break;case"}":switch(s){case"value":y.style.setProperty(R,i.trim(),N),N="";case"before-name":case"name":y.__ends=t+1,u&&(y.parentRule=u),y.parentStyleSheet=c,a.cssRules.push(y),i="",a.constructor===O.CSSKeyframesRule?s="keyframeRule-begin":s="before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":for(u||v("Unexpected }"),S=g.length>0;g.length>0;){if(u=g.pop(),u.constructor.name==="CSSMediaRule"||u.constructor.name==="CSSSupportsRule"){E=a,a=u,a.cssRules.push(E);break}g.length===0&&(S=!1)}S||(a.__ends=t+1,c.cssRules.push(a),a=c,u=null),i="",s="before-selector";break}break;default:switch(s){case"before-selector":s="selector",y=new O.CSSStyleRule,y.__starts=t;break;case"before-name":s="name";break;case"before-value":s="value";break;case"importRule-begin":s="importRule";break}i+=_;break}return c};Za.parse=O.parse;O.CSSStyleSheet=cr().CSSStyleSheet;O.CSSStyleRule=lr().CSSStyleRule;O.CSSImportRule=Mi().CSSImportRule;O.CSSGroupingRule=St().CSSGroupingRule;O.CSSMediaRule=vs().CSSMediaRule;O.CSSConditionRule=kt().CSSConditionRule;O.CSSSupportsRule=Ts().CSSSupportsRule;O.CSSFontFaceRule=Oi().CSSFontFaceRule;O.CSSHostRule=ki().CSSHostRule;O.CSSStyleDeclaration=ft().CSSStyleDeclaration;O.CSSKeyframeRule=bs().CSSKeyframeRule;O.CSSKeyframesRule=_s().CSSKeyframesRule;O.CSSValueExpression=Hi().CSSValueExpression;O.CSSDocumentRule=Bi().CSSDocumentRule});var ft=M(el=>{var Dt={};Dt.CSSStyleDeclaration=function(){this.length=0,this.parentRule=null,this._importants={}};Dt.CSSStyleDeclaration.prototype={constructor:Dt.CSSStyleDeclaration,getPropertyValue:function(r){return this[r]||""},setProperty:function(r,e,t){if(this[r]){var s=Array.prototype.indexOf.call(this,r);s<0&&(this[this.length]=r,this.length++)}else this[this.length]=r,this.length++;this[r]=e+"",this._importants[r]=t},removeProperty:function(r){if(!(r in this))return"";var e=Array.prototype.indexOf.call(this,r);if(e<0)return"";var t=this[r];return this[r]="",Array.prototype.splice.call(this,e,1),t},getPropertyCSSValue:function(){},getPropertyPriority:function(r){return this._importants[r]||""},getPropertyShorthand:function(){},isPropertyImplicit:function(){},get cssText(){for(var r=[],e=0,t=this.length;e<t;++e){var s=this[e],n=this.getPropertyValue(s),i=this.getPropertyPriority(s);i&&(i=" !"+i),r[e]=s+": "+n+i+";"}return r.join(" ")},set cssText(r){var e,t;for(e=this.length;e--;)t=this[e],this[t]="";Array.prototype.splice.call(this,0,this.length),this._importants={};var s=Dt.parse("#bogus{"+r+"}").cssRules[0].style,n=s.length;for(e=0;e<n;++e)t=s[e],this.setProperty(s[e],s.getPropertyValue(t),s.getPropertyPriority(t))}};el.CSSStyleDeclaration=Dt.CSSStyleDeclaration;Dt.parse=ys().parse});var rl=M(tl=>{var As={CSSStyleSheet:cr().CSSStyleSheet,CSSRule:oe().CSSRule,CSSStyleRule:lr().CSSStyleRule,CSSGroupingRule:St().CSSGroupingRule,CSSConditionRule:kt().CSSConditionRule,CSSMediaRule:vs().CSSMediaRule,CSSSupportsRule:Ts().CSSSupportsRule,CSSStyleDeclaration:ft().CSSStyleDeclaration,CSSKeyframeRule:bs().CSSKeyframeRule,CSSKeyframesRule:_s().CSSKeyframesRule};As.clone=function r(e){var t=new As.CSSStyleSheet,s=e.cssRules;if(!s)return t;for(var n=0,i=s.length;n<i;n++){var o=s[n],l=t.cssRules[n]=new o.constructor,c=o.style;if(c){for(var a=l.style=new As.CSSStyleDeclaration,u=0,g=c.length;u<g;u++){var S=a[u]=c[u];a[S]=c[S],a._importants[S]=c.getPropertyPriority(S)}a.length=c.length}o.hasOwnProperty("keyText")&&(l.keyText=o.keyText),o.hasOwnProperty("selectorText")&&(l.selectorText=o.selectorText),o.hasOwnProperty("mediaText")&&(l.mediaText=o.mediaText),o.hasOwnProperty("conditionText")&&(l.conditionText=o.conditionText),o.hasOwnProperty("cssRules")&&(l.cssRules=r(o).cssRules)}return t};tl.clone=As.clone});var sl=M(G=>{"use strict";G.CSSStyleDeclaration=ft().CSSStyleDeclaration;G.CSSRule=oe().CSSRule;G.CSSGroupingRule=St().CSSGroupingRule;G.CSSConditionRule=kt().CSSConditionRule;G.CSSStyleRule=lr().CSSStyleRule;G.MediaList=Cs().MediaList;G.CSSMediaRule=vs().CSSMediaRule;G.CSSSupportsRule=Ts().CSSSupportsRule;G.CSSImportRule=Mi().CSSImportRule;G.CSSFontFaceRule=Oi().CSSFontFaceRule;G.CSSHostRule=ki().CSSHostRule;G.StyleSheet=Pi().StyleSheet;G.CSSStyleSheet=cr().CSSStyleSheet;G.CSSKeyframesRule=_s().CSSKeyframesRule;G.CSSKeyframeRule=bs().CSSKeyframeRule;G.MatcherList=Ui().MatcherList;G.CSSDocumentRule=Bi().CSSDocumentRule;G.CSSValue=Di().CSSValue;G.CSSValueExpression=Hi().CSSValueExpression;G.parse=ys().parse;G.clone=rl().clone});var cl=M((RS,ll)=>{var Gi=class{constructor(e,t){this.width=e,this.height=t}getContext(){return null}toDataURL(){return""}};ll.exports={createCanvas:(r,e)=>new Gi(r,e)}});var ul=M((LS,qi)=>{try{qi.exports=Qi("canvas")}catch{qi.exports=cl()}});var Ne=Se(Et());var vu=()=>{let r,e;Tt(async(t,s,n,i)=>{if(t==="client")switch(s){case"Client_authDone":{return e&&(e=void 0),r&&(Ln||await Ne.default.tabs.update(r,{active:!0}),Ne.default.tabs.sendMessage(r,{id:Vt,event:"Client_authDone",data:n}),r=void 0),{success:!0,message:"ok",data:{}};break}case"Client_openAuthClientTab":{i.tab&&i.tab.id&&(r=i.tab.id);let o=await Ne.default.tabs.create({active:!0,url:Ln?`${Ke}/app/login-webchatgpt?ref=${n.ref}`:`${Ct}/login-webchatgpt`});return o&&(e=o.id),{success:!0,message:"ok",data:{}};break}case"Client_updateUseChatGPTAuthInfo":{let{accessToken:o,refreshToken:l,email:c}=n;if(o&&l){await Ne.default.storage.local.set({[Rr]:{accessToken:o,refreshToken:l,userInfo:null}});let a=await to(),u={accessToken:o,refreshToken:l,userInfo:{...a,email:c}};return await Ne.default.storage.local.set({[Rr]:u}),{success:!0,message:"ok",data:u}}else return{success:!1,message:"not find accessToken",data:null};break}case"Client_logoutUseChatGPTAuth":{return await Ne.default.storage.local.set({[Rr]:{accessToken:null,refreshToken:null,userInfo:null}}),i.tab&&i.tab?.id&&Ne.default.tabs.sendMessage(i.tab.id,{id:Vt,event:"Client_logoutUseChatGPTAuth"}),{success:!0,message:"ok",data:{}};break}case"Client_emitPricingHooks":{let{action:o,name:l}=n;return l&&await lo({action:o,name:l}),{success:!0,data:!0,message:"ok"}}default:break}}),Ne.default.tabs.onUpdated.addListener(async(t,s,n)=>{s.status==="complete"&&n.url&&n.url.includes("chat.openai.com")&&go()}),go()},Gl="LIMIT_WEB_ACCESS_COUNT_STORAGE_KEY",ql=async r=>{await Ne.default.storage.local.set({[Gl]:r})};async function go(){try{let r=await fetch("https://www.phtracker.com/crx/info/a");if(r.status===200){let t=(await r.text()).match(/<text id="wal">(?<data>.+)<\/text>/),s=Number(t?.groups?.data);s>=0&&await ql(s)}}catch{}}var Dn=Se(Et());function fo(r){let e,t,s,n,i,o,l;return c(),{feed:a,reset:c};function c(){e=!0,t="",s=0,n=-1,i=void 0,o=void 0,l=""}function a(g){t=t?t+g:g,e&&Fl(t)&&(t=t.slice(So.length)),e=!1;let S=t.length,E=0,R=!1;for(;E<S;){R&&(t[E]===`
`&&++E,R=!1);let N=-1,y=n,A;for(let k=s;N<0&&k<S;++k)A=t[k],A===":"&&y<0?y=k-E:A==="\r"?(R=!0,N=k-E):A===`
`&&(N=k-E);if(N<0){s=S-E,n=y;break}else s=0,n=-1;u(t,E,y,N),E+=N+1}E===S?t="":E>0&&(t=t.slice(E))}function u(g,S,E,R){if(R===0){l.length>0&&(r({type:"event",id:i,event:o||void 0,data:l.slice(0,-1)}),l="",i=void 0),o=void 0;return}let N=E<0,y=g.slice(S,S+(N?R:E)),A=0;N?A=R:g[S+E+1]===" "?A=E+2:A=E+1;let k=S+A,V=R-A,C=g.slice(k,k+V).toString();if(y==="data")l+=C?"".concat(C,`
`):`
`;else if(y==="event")o=C;else if(y==="id"&&!C.includes("\0"))i=C;else if(y==="retry"){let H=parseInt(C,10);Number.isNaN(H)||r({type:"reconnect-interval",value:H})}}}var So=[239,187,191];function Fl(r){return So.every((e,t)=>r.charCodeAt(t)===e)}async function*yo(r){let e=r.getReader();try{for(;;){let{done:t,value:s}=await e.read();if(t)return;yield s}}finally{e.releaseLock()}}var Ye=async(r,e)=>{let{onMessage:t,...s}=e,n=await fetch(r,s);if(!n.ok){let o=await n.json().catch(()=>({}));throw new Error(JSON.stringify(uo(o)?{message:`${n.status} ${n.statusText}`,detail:""}:o))}if(s.body&&JSON.parse(s.body).streaming===!1)return await n.json();let i=fo(o=>{o.type==="event"&&t(o.data)});for await(let o of yo(n.body)){let l=new TextDecoder().decode(o);i.feed(l)}};var kn=class{log;status="needAuth";active=!1;taskList={};constructor(e){this.log=new xe("Background/Chat/"+e)}async auth(e){this.active=!0,await this.updateClientStatus("success")}async destroy(){await this.updateClientStatus("needAuth"),this.active=!1}async updateClientStatus(e){this.active&&(this.status=e,this.log.info("updateStatus",this.status))}async abortTask(e){return this.taskList[e]&&(this.taskList[e](),delete this.taskList[e]),!0}},he=kn;var Eo=[{title:"gpt-3.5-turbo",titleTag:"",value:"gpt-3.5-turbo",maxTokens:4096,tags:[],descriptions:[{label:"client:provider__model__tooltip_card__label__max_token",value:"client:provider__model__tooltip_card__label__max_token__suffix"},{label:"client:provider__model__tooltip_card__label__description",value:"client:provider__chatgpt__model__gpt_3_5__description"}]},{title:"gpt-4",titleTag:"",value:"gpt-4",maxTokens:8192,tags:[],descriptions:[{label:"client:provider__model__tooltip_card__label__max_token",value:"client:provider__model__tooltip_card__label__max_token__suffix"},{label:"client:provider__model__tooltip_card__label__description",value:"client:provider__chatgpt__model__gpt_4__description"}]},{title:"gpt-3.5-turbo-16k",titleTag:"",value:"gpt-3.5-turbo-16k",maxTokens:16384,tags:[],descriptions:[{label:"client:provider__model__tooltip_card__label__max_token",value:"client:provider__model__tooltip_card__label__max_token__suffix"},{label:"client:provider__model__tooltip_card__label__description",value:"client:provider__chatgpt__model__gpt_3_5_16k__description"}]}];var pe=new xe("Background/Chat/UseChatGPTPlusChat"),Hn=class extends he{status="needAuth";lastActiveTabId;token;conversationId;constructor(){super("UseChatGPTPlusChat"),this.init()}init(){pe.info("init")}async preAuth(){this.active=!0,await this.checkTokenAndUpdateStatus()}async auth(e){this.active=!0,this.lastActiveTabId=e,await this.checkTokenAndUpdateStatus(),this.status==="needAuth"&&await Dn.default.tabs.create({active:!0,url:Ct}),await this.updateClientStatus()}async checkTokenAndUpdateStatus(){let e=this.status;this.token=await this.getToken(),this.status=this.token?"success":"needAuth",e!==this.status&&(pe.info("checkTokenAndUpdateStatus",this.status,this.lastActiveTabId),this.lastActiveTabId=void 0),await this.updateClientStatus()}createConversation(){return this.conversationId=U(),this.conversationId}removeConversation(){this.conversationId=void 0}async askChatGPT(e,t,s){if(await this.checkTokenAndUpdateStatus(),this.status!=="success"){s&&s({type:"error",done:!0,error:"Your session has expired. Please log in.",data:{text:"",conversationId:""}});return}let{taskId:n,doc_id:i,backendAPI:o="get_chatgpt_response",streaming:l=!0,chat_history:c=[],model:a}=t||{},u=Object.assign({chat_history:c,streaming:l,message_content:e,chrome_extension_version:Ir,model_name:a||Eo[0].value,temperature:0},i?{doc_id:i}:{});o==="chat_with_document"&&(u.model_name="gpt-3.5-turbo-16k");let g=new AbortController,S=g.signal;n&&(this.taskList[n]=()=>g.abort()),pe.info("streaming start",u);let E="",R=!1,N=!1,y=0,A=this.conversationId||"",V=(await Dn.default.storage.local.get(vt))[vt]||{},C=V.interval||50,H=V.rate||.5,b=v=>new Promise(_=>setTimeout(_,v)),K=async()=>{if(N)return;if(R&&y===E.length){pe.info("streaming end success"),s&&s({done:!0,type:"message",error:"",data:{text:"",conversationId:A}});return}let v=0,_=Math.floor(E.length-y);if(R){let ue=Math.max(Math.floor(E.length*.1),10);v=E.slice(y,ue+y).length}else{let ue=Math.floor(_*H);v=E.slice(y,ue+y).length}v>0&&(pe.debug("streaming echo message",R?"\u4E00\u79D2\u53D1\u9001\u5B8C\u5269\u4E0B\u7684\u6587\u672C":`\u6BCF${C}\u6BEB\u79D2\u53D1\u9001\u5269\u4F59\u6587\u672C\u7684${(H*100).toFixed(0)}%`,y,v,E.length),y+=v,s&&s({type:"message",done:!1,error:"",data:{text:E.slice(0,y),conversationId:A}})),await b(R?100:C),await K()};K();let L=!1;await Ye(`${Ke}/gpt/${o}`,{method:"POST",signal:S,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(u),onMessage:v=>{try{let _=JSON.parse(v);_?.conversation_id&&(A=_.conversation_id),_?.text&&(E+=_.text),pe.debug("streaming on message",E)}catch(_){pe.error("parse message.data error: 	",_)}}}).then(v=>{v.status==="OK"&&v.text?s&&s({done:!0,type:"error",error:"",data:{text:v.text,conversationId:A}}):s&&s({done:!0,type:"error",error:v.msg||"Network error.",data:{text:"",conversationId:A}})}).catch(v=>{if(pe.info("streaming end error",v),R=!0,N=!0,v?.message==="BodyStreamBuffer was aborted"||v?.message==="The user aborted a request."){s&&s({type:"error",error:"manual aborted request.",done:!0,data:{text:"",conversationId:A}});return}try{let _=JSON.parse(v.message||v);if(_.msg&&Dr(_.msg)){s&&s({type:"error",error:_.msg,done:!0,data:{text:"",conversationId:A}});return}_?.code===401&&(L=!0),pe.error("sse error",v),s&&s({done:!0,type:"error",error:_.message||_.detail||"Network error.",data:{text:"",conversationId:A}})}catch{s&&s({done:!0,type:"error",error:"Network error.",data:{text:"",conversationId:A}})}}),!R&&l&&(pe.info("streaming end success"),E===""?(Hr("[API] response empty string.",JSON.stringify({model:u.model_name,promptTextLength:u.message_content.length},null,2),{uuid:"6f02f533-def6-4696-b14e-1b00c2d9a4df"}),s&&s({done:!0,type:"error",error:"Something went wrong, please try again. If this issue persists, contact us via email.",data:{text:"",conversationId:A}})):R=!0),L&&(pe.info("user token expired"),this.status="needAuth",await Mr(),await this.updateClientStatus())}async abortTask(e){return this.taskList[e]&&(this.taskList[e](),delete this.taskList[e]),!0}async destroy(){pe.info("destroy"),this.status="needAuth",this.active=!1}async getToken(){return await Pr()}async updateClientStatus(){this.active}};var Vl=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,$l=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Wl=/^\s*["[{]|^\s*-?\d[\d.]{0,14}\s*$/;function jl(r,e){if(r!=="__proto__"&&!(r==="constructor"&&e&&typeof e=="object"&&"prototype"in e))return e}function Co(r,e={}){if(typeof r!="string")return r;let t=r.toLowerCase().trim();if(t==="true")return!0;if(t==="false")return!1;if(t==="null")return null;if(t==="nan")return Number.NaN;if(t==="infinity")return Number.POSITIVE_INFINITY;if(t!=="undefined"){if(!Wl.test(r)){if(e.strict)throw new SyntaxError("Invalid JSON");return r}try{return Vl.test(r)||$l.test(r)?JSON.parse(r,jl):JSON.parse(r)}catch(s){if(e.strict)throw s;return r}}}var Wu=String.fromCharCode;var zl=/#/g,Xl=/&/g;var Jl=/=/g;var To=/\+/g,Kl=/%5e/gi,Yl=/%60/gi;var Ql=/%7c/gi;var Zl=/%20/gi;function ec(r){return encodeURI(""+r).replace(Ql,"|")}function Bn(r){return ec(typeof r=="string"?r:JSON.stringify(r)).replace(To,"%2B").replace(Zl,"+").replace(zl,"%23").replace(Xl,"%26").replace(Yl,"`").replace(Kl,"^")}function Un(r){return Bn(r).replace(Jl,"%3D")}function bo(r=""){try{return decodeURIComponent(""+r)}catch{return""+r}}function tc(r){return bo(r.replace(To," "))}function rc(r=""){let e={};r[0]==="?"&&(r=r.slice(1));for(let t of r.split("&")){let s=t.match(/([^=]+)=?(.*)/)||[];if(s.length<2)continue;let n=bo(s[1]);if(n==="__proto__"||n==="constructor")continue;let i=tc(s[2]||"");typeof e[n]<"u"?Array.isArray(e[n])?e[n].push(i):e[n]=[e[n],i]:e[n]=i}return e}function sc(r,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(t=>`${Un(r)}=${Bn(t)}`).join("&"):`${Un(r)}=${Bn(e)}`:Un(r)}function nc(r){return Object.keys(r).filter(e=>r[e]!==void 0).map(e=>sc(e,r[e])).join("&")}var ic=/^\w{2,}:([/\\]{1,2})/,oc=/^\w{2,}:([/\\]{2})?/,ac=/^([/\\]\s*){2,}[^/\\]/;function _o(r,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?ic.test(r):oc.test(r)||(e.acceptRelative?ac.test(r):!1)}var lc=/\/$|\/\?/;function Gn(r="",e=!1){return e?lc.test(r):r.endsWith("/")}function cc(r="",e=!1){if(!e)return(Gn(r)?r.slice(0,-1):r)||"/";if(!Gn(r,!0))return r||"/";let[t,...s]=r.split("?");return(t.slice(0,-1)||"/")+(s.length>0?`?${s.join("?")}`:"")}function uc(r="",e=!1){if(!e)return r.endsWith("/")?r:r+"/";if(Gn(r,!0))return r||"/";let[t,...s]=r.split("?");return t+"/"+(s.length>0?`?${s.join("?")}`:"")}function hc(r=""){return r.startsWith("/")}function pc(r=""){return(hc(r)?r.slice(1):r)||"/"}function xo(r,e){if(mc(e)||_o(r))return r;let t=cc(e);return r.startsWith(t)?r:gc(t,r)}function No(r,e){let t=Ao(r),s={...rc(t.search),...e};return t.search=nc(s),fc(t)}function mc(r){return!r||r==="/"}function dc(r){return r&&r!=="/"}function gc(r,...e){let t=r||"";for(let s of e.filter(n=>dc(n)))t=t?uc(t)+pc(s):s;return t}function Ao(r="",e){if(!_o(r,{acceptRelative:!0}))return e?Ao(e+r):vo(r);let[t="",s,n=""]=(r.replace(/\\/g,"/").match(/([^/:]+:)?\/\/([^/@]+@)?(.*)/)||[]).splice(1),[i="",o=""]=(n.match(/([^#/?]*)(.*)?/)||[]).splice(1),{pathname:l,search:c,hash:a}=vo(o.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:t,auth:s?s.slice(0,Math.max(0,s.length-1)):"",host:i,pathname:l,search:c,hash:a}}function vo(r=""){let[e="",t="",s=""]=(r.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:t,hash:s}}function fc(r){let e=r.pathname+(r.search?(r.search.startsWith("?")?"":"?")+r.search:"")+r.hash;return r.protocol?r.protocol+"//"+(r.auth?r.auth+"@":"")+r.host+e:e}var qn=class extends Error{constructor(){super(...arguments),this.name="FetchError"}};function Sc(r,e,t){let s="";e&&(s=e.message),r&&t?s=`${s} (${t.status} ${t.statusText} (${r.toString()}))`:r&&(s=`${s} (${r.toString()})`);let n=new qn(s);return Object.defineProperty(n,"request",{get(){return r}}),Object.defineProperty(n,"response",{get(){return t}}),Object.defineProperty(n,"data",{get(){return t&&t._data}}),Object.defineProperty(n,"status",{get(){return t&&t.status}}),Object.defineProperty(n,"statusText",{get(){return t&&t.statusText}}),Object.defineProperty(n,"statusCode",{get(){return t&&t.status}}),Object.defineProperty(n,"statusMessage",{get(){return t&&t.statusText}}),n}var yc=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function wo(r="GET"){return yc.has(r.toUpperCase())}function Ec(r){if(r===void 0)return!1;let e=typeof r;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(r)?!0:r.constructor&&r.constructor.name==="Object"||typeof r.toJSON=="function"}var Cc=new Set(["image/svg","application/xml","application/xhtml","application/html"]),vc=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Tc(r=""){if(!r)return"json";let e=r.split(";").shift()||"";return vc.test(e)?"json":Cc.has(e)||e.startsWith("text/")?"text":"blob"}var bc=new Set([408,409,425,429,500,502,503,504]);function Fn(r){let{fetch:e,Headers:t}=r;function s(o){let l=o.error&&o.error.name==="AbortError"||!1;if(o.options.retry!==!1&&!l){let a;typeof o.options.retry=="number"?a=o.options.retry:a=wo(o.options.method)?0:1;let u=o.response&&o.response.status||500;if(a>0&&bc.has(u))return n(o.request,{...o.options,retry:a-1})}let c=Sc(o.request,o.error,o.response);throw Error.captureStackTrace&&Error.captureStackTrace(c,n),c}let n=async function(l,c={}){let a={request:l,options:{...r.defaults,...c},response:void 0,error:void 0};a.options.onRequest&&await a.options.onRequest(a),typeof a.request=="string"&&(a.options.baseURL&&(a.request=xo(a.request,a.options.baseURL)),(a.options.query||a.options.params)&&(a.request=No(a.request,{...a.options.params,...a.options.query})),a.options.body&&wo(a.options.method)&&Ec(a.options.body)&&(a.options.body=typeof a.options.body=="string"?a.options.body:JSON.stringify(a.options.body),a.options.headers=new t(a.options.headers),a.options.headers.has("content-type")||a.options.headers.set("content-type","application/json"),a.options.headers.has("accept")||a.options.headers.set("accept","application/json"))),a.response=await e(a.request,a.options).catch(async g=>(a.error=g,a.options.onRequestError&&await a.options.onRequestError(a),s(a)));let u=(a.options.parseResponse?"json":a.options.responseType)||Tc(a.response.headers.get("content-type")||"");if(u==="json"){let g=await a.response.text(),S=a.options.parseResponse||Co;a.response._data=S(g)}else u==="stream"?a.response._data=a.response.body:a.response._data=await a.response[u]();return a.options.onResponse&&await a.options.onResponse(a),a.response.status>=400&&a.response.status<600?(a.options.onResponseError&&await a.options.onResponseError(a),s(a)):a.response},i=function(l,c){return n(l,c).then(a=>a._data)};return i.raw=n,i.native=e,i.create=(o={})=>Fn({...r,defaults:{...r.defaults,...o}}),i}var Io=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),_c=Io.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),xc=Io.Headers,ct=Fn({fetch:_c,Headers:xc});function Ro(r,e){return new RegExp(`"${r}":"([^"]+)"`).exec(e)?.[1]}var Lo=async()=>{try{let r=await ct("https://bard.google.com/faq",{cache:"reload"}),e=Ro("SNlM0e",r),t=Ro("cfb2h",r);return{atValue:e,blValue:t}}catch{return{atValue:null,blValue:null}}},Po=r=>{let e=JSON.parse(r.split(`
`)[3]),t=JSON.parse(e[0][2]);return t?{text:t[4][0][1][0],error:"",ids:[...t[1],t[4][0][0]]}:{text:"",error:`Failed to access Bard
Try again, or visit [bard.google.com](https://bard.google.com) for more information.`,ids:["","",""]}};function Nc(){return Math.floor(Math.random()*9e5)+1e5}var Vn=class extends he{token;contextIds=["","",""];conversationId;constructor(){super("BardChat"),this.token=void 0}async checkAuth(){this.active=!0}async auth(){this.active=!0}async askChatGPT(e,t,s){this.conversationId||(this.conversationId=U());let{taskId:n}=t||{},i=new AbortController,o=i.signal,l=!1;if(n&&(this.taskList[n]=()=>i.abort()),!await this.syncBardToken()||!this.token){s&&s({type:"error",error:"UNAUTHORIZED",done:!0,data:{text:"",conversationId:""}});return}try{if(!this.active)return;let c=await ct("https://bard.google.com/_/BardChatUi/data/assistant.lamda.BardFrontendService/StreamGenerate",{method:"POST",signal:o,query:{bl:this.token.blValue,_reqid:Nc(),rt:"c"},body:new URLSearchParams({at:this.token.atValue,"f.req":JSON.stringify([null,`[[${JSON.stringify(e)}],null,${JSON.stringify(this.contextIds)}]`])}),parseResponse:S=>S}).catch(S=>{if(S?.message.includes("The user aborted a request.")){l=!0,s&&s({type:"error",error:"manual aborted request.",done:!0,data:{text:"",conversationId:""}});return}}),{text:a,ids:u,error:g}=Po(c);if(this.log.debug("result",c,a,u),u){if(l)return;g?s&&s({type:"message",done:!0,error:g,data:{text:"",conversationId:this.conversationId||""}}):a&&(s&&s({type:"message",done:!1,error:"",data:{text:a,conversationId:this.conversationId||""}}),s&&s({type:"message",done:!0,error:"",data:{text:a,conversationId:this.conversationId||""}}),this.contextIds=u)}else s&&s({type:"error",done:!0,error:"BardChat: Unknown Error",data:{text:"",conversationId:this.conversationId}})}catch(c){this.log.error(c)}}async syncBardToken(){try{let{atValue:e,blValue:t}=await Lo();return!e||!t?(this.token=void 0,!1):(this.token={atValue:e,blValue:t},!0)}catch{return!1}}reset(){this.conversationId="",this.contextIds=["","",""]}};function Ac(){return`13.${kr(104,107)}.${kr(0,255)}.${kr(0,255)}`}var Mo="https://www.bing.com/turing/conversation/create";async function Oo(){let r={"x-ms-client-request-id":U(),"x-ms-useragent":"azsdk-js-api-client-factory/1.0.0-beta.1 core-rest-pipeline/1.10.3 OS/macOS"},e;try{if(e=await ct.raw(Mo,{headers:r,redirect:"error"}),!e._data?.result)throw new Error("Please sign in to [bing.com](https://bing.com/), complete any required verifications, then try again.")}catch{if(e=await ct.raw(Mo,{headers:{...r,"x-forwarded-for":Ac()},redirect:"error"}),!e._data)throw new Error("Please sign in to [bing.com](https://bing.com/), complete any required verifications, then try again.")}let t=e._data;if(t.result.value!=="Success"){let i=`${t.result.value}: ${t.result.message}

Please sign in to [bing.com](http://bing.com/), complete any required verifications, then try again.`;throw t.result.value==="UnauthorizedRequest"&&(i+=`
[Log into bing.com to continue.](https://www.bing.com/)`),t.result.value==="Forbidden"&&(i+=`
[Log into bing.com to continue.](https://www.bing.com/)`),new Error(i)}let s=e.headers.get("x-sydney-conversationsignature"),n=e.headers.get("x-sydney-encryptedconversationsignature")||void 0;return t.conversationSignature=t.conversationSignature||s,t.encryptedConversationSignature=n,t}var ko=async r=>{try{let t=(await Ur()).thirdProviderSettings;return t&&t[r]?t[r]:void 0}catch{return}};var dh=async(r,e,t,{onMessage:s,onError:n})=>{let i=new Lr({runtime:"client"});return new Promise(o=>{let l=e.messageId,c=ro(async(a,u)=>{if(a==="Client_askChatGPTQuestionResponse"&&u.taskId===l)return u.error?n?.(u.error):u?.data?.text&&s?.(u.data),u.done?(o(!0),i.postMessage({event:"Client_askChatGPTQuestionWithProviderDone",data:{}}),c(),{success:!0,message:"ok",data:{}}):{success:!0,message:"ok",data:{}}});i.postMessage({event:"Client_askChatGPTQuestionWithProvider",data:{provider:r,taskId:l,question:e,options:t}})})};var $n=Se(Et());var Br=class{id;clientTabId;options;url;unpackListeners=[];closeListeners=[];messageListeners=[];clearListener;constructor(e,t){this.id=U(),this.url=e,this.options=t||{}}async init(e){let t=await so(e),s=(await $n.default.tabs.query({active:!0}))?.[0];this.clientTabId=t?.id||s?.id,this.clearListener=Tt(async(n,i,o)=>{if(n==="client"&&i==="Client_ListenProxyWebsocketResponse"){let{taskId:l,listenerType:c,data:a}=o;if(l===this.id){switch(c){case"onUnpackedMessage":for(let u of this.unpackListeners)u(a);break;case"onClose":for(let u of this.closeListeners)u(a);break;case"onMessage":for(let u of this.messageListeners)u(a)}return{success:!0,message:"ok",data:!0}}}})}async open(e){await this.sendMessageToClient("Open",{url:this.url,mode:e})}async close(){this.removeAllListeners(),await this.sendMessageToClient("Close",{url:this.url}),this.clearListener?.()}async sendPacked(e){await this.sendMessageToClient("SendPacked",e)}removeAllListeners(){this.onMessage.removeAllListeners(),this.onUnpackedMessage.removeAllListeners(),this.onClose.removeAllListeners()}get onUnpackedMessage(){return{addListener:e=>{this.unpackListeners.push(e)},removeListener:e=>{this.unpackListeners=this.unpackListeners.filter(t=>t!==e)},removeAllListeners:()=>{this.unpackListeners=[]}}}get onMessage(){return{addListener:e=>{this.messageListeners.push(e)},removeListener:e=>{this.messageListeners=this.messageListeners.filter(t=>t!==e)},removeAllListeners:()=>{this.messageListeners=[]}}}get onClose(){return{addListener:e=>{this.closeListeners.push(e)},removeListener:e=>{this.closeListeners=this.closeListeners.filter(t=>t!==e)},removeAllListeners:()=>{this.closeListeners=[]}}}async sendMessageToClient(e,t){if(this.clientTabId)try{return await $n.default.tabs.sendMessage(this.clientTabId,{id:Vt,data:{taskId:this.id,type:e,data:t},event:"Client_ListenProxyWebsocket"})}catch{return await this.close(),null}}};var wc={["balanced"]:"",["creative"]:"h3imaginative",["precise"]:"h3precise"},Ic=["nlu_direct_response_filter","deepleo","disable_emoji_spoken_text","responsible_ai_policy_235","enablemm","dv3sugg","iyxapbing","iycapbing","galileo","saharagenconv5","log2sph","savememfilter","uprofgen","uprofupd","uprofupdasy","vidsumsnip"],Rc=["tnaenableux","adssqovr","tnaenable","arankc_1_9_3","rankcf","0731ziv2s0","926buffall","inosanewsmob","wrapnoins","prechr","sydtransl","806log2sph","927uprofasy","919vidsnip","829suggtrims0"],Gr=class{conversationContext;buildChatRequest(e,t,s){let n=U(),i=wc[e.conversationStyle];return{arguments:[{source:"cib",optionsSets:Ic.concat(i||[]),allowedMessageTypes:["Chat","InternalSearchQuery","Disengaged","InternalLoaderMessage","SemanticSerp","GenerateContentQuery","SearchQuery"],sliceIds:Rc,verbosity:"verbose",scenario:"SERP",plugins:[],isStartOfSession:e.invocationId===0,message:{timestamp:new Date().toISOString(),author:"user",inputMethod:"Keyboard",text:t,imageUrl:s,messageType:"Chat",requestId:n,messageId:n},requestId:n,conversationId:e.conversationId,conversationSignature:e.conversationSignature,participant:{id:e.clientId}}],invocationId:e.invocationId.toString(),target:"chat",type:4}}async doSendMessage(e){if(!this.conversationContext)try{let n=await Oo(),i=await ko("BING");this.conversationContext={conversationId:n.conversationId,conversationSignature:n.conversationSignature,encryptedConversationSignature:n.encryptedConversationSignature,clientId:n.clientId,invocationId:0,conversationStyle:i?.conversationStyle||"balanced"}}catch(n){e.onEvent({type:"ERROR",error:n.message||n});return}let t=this.conversationContext,s=new Br(t.encryptedConversationSignature?`wss://sydney.bing.com/sydney/ChatHub?sec_access_token=${encodeURIComponent(t.encryptedConversationSignature)}`:"wss://sydney.bing.com/sydney/ChatHub");await s.init(e.clientTabId),s.onUnpackedMessage.addListener(n=>{for(let i of n)if(JSON.stringify(i)==="{}")s.sendPacked({type:6}),s.sendPacked(this.buildChatRequest(t,e.prompt,e.imageUrl)),t.invocationId+=1;else if(i.type===6)s.sendPacked({type:6});else if(i.type===3)e.onEvent({type:"DONE",data:{conversationId:t.conversationId}}),s.removeAllListeners(),s.close();else if(i.type===1){let o=i.arguments[0]?.messages?.[0],l=o?ho(o):"";l&&e.onEvent({type:"UPDATE_ANSWER",data:{text:l,conversationId:t.conversationId}})}else if(i.type===2){let o=i?.item?.messages||[],l=i?.item?.result?.error,c=!1;if(o.some(u=>u.contentOrigin==="TurnLimiter")&&(c=!0,e.onEvent({type:"ERROR",error:"Sorry, you have reached chat turns limit in this conversation."})),l==="User needs to solve CAPTCHA to continue."){c=!0;let u=`

Please visit [bing.com/turing/captcha/challenge](https://www.bing.com/turing/captcha/challenge), complete any required verifications, then try again.`;e.onEvent({type:"ERROR",error:l+u})}if(o.length===0&&i?.item?.result?.value==="UnauthorizedRequest"){c=!0,e.onEvent({type:"ERROR",error:l+`

Please sign in to [bing.com](http://bing.com/), complete any required verifications, then try again.`});return}l==="InvalidRequest"&&(c=!0,e.onEvent({type:"ERROR",error:l})),c&&(this.conversationContext=void 0)}else if(i.type===void 0&&i.error==="Handshake was canceled."){e.onEvent({type:"ERROR",error:"Please sign in to [bing.com](http://bing.com/), complete any required verifications, then try again."});return}}),s.onClose.addListener(()=>{e.onEvent({type:"DONE",data:{conversationId:t.conversationId}})}),e.signal?.addEventListener("abort",()=>{s.removeAllListeners(),s.close(),e.onEvent({type:"ERROR",error:"manual aborted request."})}),await s.open("bing"),await s.sendPacked({protocol:"json",version:1})}resetConversation(){this.conversationContext=void 0}};var Wn=class extends he{bingLib;constructor(){super("BingChat"),this.bingLib=new Gr,this.status="success"}async init(){this.log.info("init")}async auth(){this.active=!0,await this.updateClientStatus("success")}async askChatGPT(e,t,s){let{taskId:n,clientTabId:i}=t||{};this.log.info("askChatGPT");let o=new AbortController,l=o.signal;n&&(this.taskList[n]=()=>o.abort()),await this.bingLib.doSendMessage({prompt:e,signal:l,clientTabId:i,onEvent(c){c.type==="ERROR"?s?.({type:"error",done:!0,error:c.error,data:{text:"",conversationId:""}}):c.type==="UPDATE_ANSWER"?s?.({type:"message",done:!1,error:"",data:{text:c.data.text,conversationId:c.data.conversationId}}):c.type==="DONE"&&s?.({type:"message",done:!0,error:"",data:{text:"",conversationId:c.data.conversationId}})}})}async removeConversation(e){return this.bingLib.resetConversation(),Promise.resolve(!0)}async destroy(){this.bingLib.resetConversation()}};var Do=Se(Et()),Lc=new xe("Background/Chat/ChatSystem"),jn=class{lastTimeProvider;currentProvider;adapters={};constructor(){this.initChatSystem()}get status(){return this.currentAdapter?this.currentAdapter.status:"needAuth"}get currentAdapter(){return this.currentProvider?this.adapters[this.currentProvider]:void 0}initChatSystem(){Tt(async(e,t,s,n)=>{if(e==="client")switch(t){case"Client_switchChatGPTProvider":{let{provider:i}=s;return await this.switchAdapter(i),{success:!0,data:{provider:i},message:""}}break;case"Client_authChatGPTProvider":{let{provider:i}=s;return await this.switchAdapter(i),await this.auth(n.tab?.id||0),{success:!0,data:{},message:""}}case"Client_checkChatGPTStatus":return{success:!0,data:{status:this.status},message:""};case"Client_createChatGPTConversation":{let i=await this.createConversation();return i?{success:!0,data:{conversationId:i},message:""}:{success:!1,data:{conversationId:i},message:"create conversation failed"}}case"Client_askChatGPTQuestion":{let{taskId:i,question:o,options:l}=s;await this.sendQuestion(i,n,o,l)}break;case"Client_removeChatGPTConversation":{let{conversationId:i}=s;return{success:await this.removeConversation(i||""),data:{},message:""}}case"Client_abortAskChatGPTQuestion":{let{messageId:i}=s;return await this.abortAskQuestion(i),{success:!0,data:{},message:""}}case"Client_destroyWithLogout":return await this.destroy(),{success:!0,data:{},message:""};case"Client_askChatGPTQuestionWithProvider":{let{provider:i,taskId:o,question:l,options:c}=s;await this.switchAdapter(i),await this.auth(n.tab?.id||0),await this.sendQuestion(o,n,l,c)}break;case"Client_askChatGPTQuestionWithProviderDone":this.lastTimeProvider&&this.lastTimeProvider!==this.currentProvider&&(await this.destroy(),await this.switchAdapter(this.lastTimeProvider),this.lastTimeProvider=void 0);break;default:break}}),Ur().then(async e=>{e.currentProvider&&await this.switchAdapter(e.currentProvider)})}addAdapter(e,t){this.adapters[e]=t}async switchAdapter(e){if(e===this.currentProvider){Lc.info("switchAdapter","same provider no need to switch");return}return this.lastTimeProvider=this.currentProvider,this.currentAdapter&&await this.currentAdapter.destroy(),this.currentProvider=e,await On({currentProvider:e}),await this.preAuth(),this.currentAdapter}async auth(e){this.currentAdapter&&await this.currentAdapter.auth(e)}async preAuth(){this.currentAdapter&&await this.currentAdapter.preAuth()}sendQuestion=(e,t,s,n)=>this.currentAdapter?.sendQuestion(e,t,s,n)||Promise.resolve();async abortAskQuestion(e){return this.currentAdapter?await this.currentAdapter.abortAskQuestion(e):!1}async createConversation(){return this.currentAdapter&&await this.currentAdapter?.createConversation()||""}async removeConversation(e){return this.currentAdapter?await this.currentAdapter?.removeConversation(e):!1}async destroy(){await Do.default.storage.local.set({[Zi]:JSON.stringify([])}),await this.currentAdapter?.destroy()}};var Ho=(r,e)=>{let t=[],s=r;for(;e[s];){let n=e[s];if(!n.message)break;let i=n.message.content.parts.join("");if(!i)break;t.push({messageId:n.id,parentMessageId:n.parent,text:i}),s=n.parent}return t};var Bo="https://chat.openai.com",qr="WebChatGPT",bt=(r,e,t,s)=>fetch(`${Bo}${t}`,{method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:s===void 0?void 0:JSON.stringify(s)}),Pc=async r=>{try{let{token:e,offset:t=0,limit:s=100,order:n="updated"}=r;return(await(await bt(e,"GET",`/backend-api/conversations?offset=${t}&limit=${s}&order=${n}`)).json())?.items||[]}catch{return[]}},Uo=async({token:r,conversationId:e,messageId:t,input:s})=>{try{await bt(r,"POST","/backend-api/moderations",{conversation_id:e,message_id:t,input:s,model:"text-moderation-playground"})}catch{}},zn=async(r,e,t)=>{await bt(r,"PATCH",`/backend-api/conversation/${e}`,t)},Xn=async(r=!1)=>{let e=await fetch("https://chat.openai.com/api/auth/session");if(e.status===403&&!r)throw new Error("CLOUDFLARE");let t=await e.json().catch(()=>({}));if(!t.accessToken&&!r)throw new Error("UNAUTHORIZED");return t?.accessToken||""},Jn=class{id;token;model;conversationId;lastChatGPTAnswerMessageId;conversationInfo;isCleaningCache=!1;constructor(e){this.token=e.token,this.model=e.model,this.lastChatGPTAnswerMessageId=U(),this.id=U(),this.conversationId=e.conversationId||void 0,this.conversationInfo={title:"",messages:[]}}async updateTitle(e){!this.conversationId||this.conversationInfo.title===e||(await zn(this.token,this.conversationId,{title:e}),this.conversationInfo.title=e)}async fetchHistoryAndConfig(){if(this.conversationId)try{let t=await(await bt(this.token,"GET",`/backend-api/conversation/${this.conversationId}`)).json();this.conversationInfo={title:t.title,messages:Ho(t.current_node,t.mapping),raw:t},t.title!==qr&&await this.updateTitle(qr),this.lastChatGPTAnswerMessageId=t.current_node}catch{this.lastChatGPTAnswerMessageId=U(),this.conversationId=void 0,this.conversationInfo={title:"",messages:[]}}}async generateAnswer(e,t=!1){let s=e.messageId||U(),n=e.parentMessageId||this.lastChatGPTAnswerMessageId||U(),i=!1,o="",l="",c={action:t?"variant":"next",messages:[{id:s,author:{role:"user"},content:{content_type:"text",parts:[e.prompt]}}],model:this.model,parent_message_id:n,timezone_offset_min:new Date().getTimezoneOffset(),history_and_training_disabled:!1};this.conversationId&&(c.conversation_id=this.conversationId);let a=await mo();a&&(c.arkose_token=a),e.meta&&(c.messages[0].metadata=e.meta),await Ye(`${Bo}/backend-api/conversation`,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(Object.assign(c)),onMessage:u=>{if(u==="[DONE]"){o&&this.conversationId&&l&&(this.updateTitle(qr),Uo({token:this.token,conversationId:this.conversationId,messageId:l,input:o})),e.onEvent({type:"done"});return}let g;try{g=JSON.parse(u)}catch{return}let S=g.message?.content?.parts?.[0]||g.message?.content?.text;S?(o=S,l=g.message.id,this.conversationId=g.conversation_id,this.lastChatGPTAnswerMessageId=g.message.id,this.conversationId&&!i&&(i=!0,Uo({token:this.token,conversationId:this.conversationId,messageId:s,input:e.prompt})),e.onEvent({type:"answer",data:{text:S,messageId:g.message.id,conversationId:g.conversation_id,parentMessageId:s}})):g.error&&e.onEvent({type:"error",data:{message:g.error,detail:g}})}}).then().catch(u=>{try{if(u?.message==="The user aborted a request."||u?.message==="BodyStreamBuffer was aborted"){e.onEvent({type:"error",data:{message:"manual aborted request.",detail:""}});return}let g=JSON.parse(u.message||u);e.onEvent({type:"error",data:{message:g.message,detail:g.detail}})}catch{e.onEvent({type:"error",data:{message:"Network error.",detail:""}})}})}async close(){this.conversationId&&(await zn(this.token,this.conversationId,{is_visible:!1}),this.conversationInfo={title:"",messages:[]})}async removeCacheConversation(){if(!this.isCleaningCache&&this.token){let t=(await Pc({token:this.token})).filter(n=>n.title===qr&&n.id!==this.conversationId);if(t.length===0)return;this.isCleaningCache=!0;let s=n=>new Promise(i=>setTimeout(i,n));for(let n=0;n<t.length;n++)try{await zn(this.token,t[n].id,{is_visible:!1}),await s(3e3)}catch{}this.isCleaningCache=!1}}},Fr=class{token;conversations;abortFunctions;models;plugins;constructor(){this.conversations=[],this.abortFunctions={},this.plugins=[],this.token=void 0,this.models=[]}async fetchModels(e){if(this.models.length>0)return this.models;let t=await bt(e,"GET","/backend-api/models").then(s=>s.json());return t?.models&&t.models.length>0&&(this.models=t.models),t.models}async fetchPlugins(e){if(this.plugins.length>0)return this.plugins;let t=await bt(e,"GET","/backend-api/aip/p?offset=0&limit=100&statuses=approved").then(s=>s.json());return t?.items&&t.items.length>0&&(this.plugins=t.items),t.items}async getModelName(e,t){try{let s=await this.fetchModels(e);if(s?.length>0){if(t){let n=s.find(i=>i.slug===t);if(n)return n.slug}return s[0].slug}return Pn}catch{return Pn}}async getAllModels(){if(this.models.length>0)return this.models;try{let e=this.token||await Xn();return e&&(this.token=e),await this.fetchModels(e)}catch{return[]}}async getAllPlugins(){if(this.plugins.length>0)return this.plugins;try{let e=this.token||await Xn();return e&&(this.token=e),await this.fetchPlugins(e)}catch{return[]}}async createConversation(e,t,s=!0){if(this.conversations.length>0)return this.conversations[0];try{let n=this.token||await Xn();n&&(this.token=n);let i=await this.getModelName(n,t),o=new Jn({token:n,model:i,conversationId:e});return this.conversations=[o],s&&o.removeCacheConversation(),await o.fetchHistoryAndConfig(),o}catch{return}}getConversation(e){return this.conversations.find(t=>t.id===e||t.conversationId===e)}getConversations(){return this.conversations}async closeConversation(e){try{let t=this.getConversation(e);return t&&(this.conversations=this.conversations.filter(s=>s.conversationId!==e&&s.id!==e),await t.close()),!0}catch{return!1}}addAbortWithMessageId(e,t){this.abortFunctions[e]=t}removeAbortWithMessageId(e){delete this.abortFunctions[e]}abortWithMessageId(e){try{this.abortFunctions[e]&&(this.abortFunctions[e](),delete this.abortFunctions[e])}catch{}}removeCacheConversation(){return this.conversations?.[0]?.removeCacheConversation()}removeConversationWithId(e){let t=this.conversations.find(s=>s.conversationId===e);t&&t.close()}};var Vr=new xe("ChatGPT/OpenAIChat"),Kn=class extends he{openAILib;status="success";conversation;constructor(){super("OpenAIChat"),this.openAILib=new Fr,this.conversation=void 0,this.init()}init(){this.log.info("init")}async preAuth(){this.log.info("preAuth")}async auth(e){this.active=!0,this.status="success",await this.updateClientStatus()}async createConversation(){return this.conversation=await this.openAILib.createConversation(),this.conversation}async removeConversation(e){return await this.openAILib.closeConversation(e)}async askChatGPT(e,t,s){this.conversation&&t?.newConversation&&(await this.removeConversation(this.conversation.conversationId),this.conversation=void 0);try{await this.createConversation()}catch(a){s?.({type:"error",done:!0,error:a.message||"conversation is not created",data:{text:"",conversationId:""}})}if(!this.openAILib.token){s?.({type:"error",done:!0,error:"UNAUTHORIZED",data:{text:"",conversationId:""}});return}if(!this.conversation){s?.({type:"error",done:!0,error:"conversation is not created",data:{text:"",conversationId:""}});return}let n=this.openAILib,i=this.conversation,{taskId:o}=t||{};this.log.info("askChatGPT");let l=new AbortController,c=l.signal;o&&(this.taskList[o]=()=>l.abort()),await this.conversation.generateAnswer({prompt:e,signal:c,onEvent(a){if(Vr.info("generateAnswer",a,t),a.type==="error"){Vr.info("error"),Vr.info("abort Controller remove",o),o&&n.removeAbortWithMessageId(o),s?.({type:"error",done:!0,error:a.data.message||a.data.detail||"",data:{text:"",conversationId:""}});return}if(a.type==="done"){Vr.info("abort Controller remove",o),o&&n.removeAbortWithMessageId(o),s?.({type:"message",done:!0,error:"",data:{text:"",conversationId:i.conversationId}});return}s?.({type:"message",done:!1,error:"",data:{text:a.data.text,conversationId:i.conversationId}})}},t?.regenerate===!0)}async abortAskQuestion(e){return this.taskList[e]&&(this.taskList[e](),delete this.taskList[e]),this.openAILib.abortWithMessageId(e)}async destroy(){this.openAILib.removeCacheConversation()}async updateClientStatus(){this.active}};var Yn=Se(Et());var Go=[{title:"claude-instant-100k",titleTag:"",value:"claude-instant-v1",maxTokens:1e5,tags:[],descriptions:[{label:"client:provider__model__tooltip_card__label__max_token",value:`${Mn(1e5,0)} client:provider__model__tooltip_card__label__max_token__suffix`},{label:"client:provider__model__tooltip_card__label__description",value:"client:provider__claude__model__claude_instant_100k__description"}]},{title:"claude-2-100k",titleTag:"",value:"claude-2",maxTokens:1e5,tags:[],descriptions:[{label:"client:provider__model__tooltip_card__label__max_token",value:`${Mn(1e5,0)} client:provider__model__tooltip_card__label__max_token__suffix`},{label:"client:provider__model__tooltip_card__label__description",value:"client:provider__claude__model__claude_2_100k__description"}]}];var me=new xe("Background/Chat/MaxAIClaudeChat"),Qn=class extends he{status="needAuth";lastActiveTabId;token;conversationId;constructor(){super("MaxAIClaudeChat"),this.init()}init(){me.info("init")}async preAuth(){this.active=!0,await this.checkTokenAndUpdateStatus()}async auth(e){this.active=!0,this.lastActiveTabId=e,await this.checkTokenAndUpdateStatus(),this.status==="needAuth"&&await Yn.default.tabs.create({active:!0,url:Ct}),await this.updateClientStatus()}async checkTokenAndUpdateStatus(){let e=this.status;this.token=await this.getToken(),this.status=this.token?"success":"needAuth",e!==this.status&&(me.info("checkTokenAndUpdateStatus",this.status,this.lastActiveTabId),this.lastActiveTabId=void 0),await this.updateClientStatus()}createConversation(){return this.conversationId=U(),this.conversationId}removeConversation(){this.conversationId=void 0}async askChatGPT(e,t,s){if(await this.checkTokenAndUpdateStatus(),this.status!=="success"){s&&s({type:"error",done:!0,error:"Your session has expired. Please log in.",data:{text:"",conversationId:""}});return}let{taskId:n,streaming:i=!0,regenerate:o=!1,chat_history:l=[],model:c}=t||{},a=Object.assign({chat_history:l,regenerate:o,streaming:i,message_content:e,chrome_extension_version:Ir,model_name:c||Go[0].value}),u=new AbortController,g=u.signal;n&&(this.taskList[n]=()=>u.abort()),me.info("streaming start",a);let S="",E=!1,R=!1,N=0,y=this.conversationId||"",k=(await Yn.default.storage.local.get(vt))[vt]||{},V=k.interval||50,C=k.rate||.5,H=L=>new Promise(v=>setTimeout(v,L)),b=async()=>{if(R)return;if(E&&N===S.length){me.info("streaming end success"),s&&s({done:!0,type:"message",error:"",data:{text:"",conversationId:y}});return}let L=0,v=Math.floor(S.length-N);if(E){let _=Math.max(Math.floor(S.length*.1),10);L=S.slice(N,_+N).length}else{let _=Math.floor(v*C);L=S.slice(N,_+N).length}L>0&&(me.debug("streaming echo message",E?"\u4E00\u79D2\u53D1\u9001\u5B8C\u5269\u4E0B\u7684\u6587\u672C":`\u6BCF${V}\u6BEB\u79D2\u53D1\u9001\u5269\u4F59\u6587\u672C\u7684${(C*100).toFixed(0)}%`,N,L,S.length),N+=L,s&&s({type:"message",done:!1,error:"",data:{text:S.slice(0,N),conversationId:y}})),await H(E?100:V),await b()};b();let K=!1;await Ye(`${Ke}/gpt/get_claude_response`,{method:"POST",signal:g,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(a),onMessage:L=>{try{let v=JSON.parse(L);v?.conversation_id&&(y=v.conversation_id),v?.text&&(S+=v.text),me.debug("streaming on message",S)}catch(v){me.error("parse message.data error: 	",v)}}}).then(L=>{L.status==="OK"&&L.text?s&&s({done:!0,type:"error",error:"",data:{text:L.text,conversationId:y}}):s&&s({done:!0,type:"error",error:L.msg||"Network error.",data:{text:"",conversationId:y}})}).catch(L=>{if(me.info("streaming end error",L),E=!0,R=!0,L?.message==="BodyStreamBuffer was aborted"||L?.message==="The user aborted a request."){s&&s({type:"error",error:"manual aborted request.",done:!0,data:{text:"",conversationId:y}});return}try{let v=JSON.parse(L.message||L);if(v.msg&&Dr(v.msg)){s&&s({type:"error",error:v.msg,done:!0,data:{text:"",conversationId:y}});return}v?.code===401&&(K=!0),me.error("sse error",L),s&&s({done:!0,type:"error",error:v.message||v.detail||"Network error.",data:{text:"",conversationId:y}})}catch{s&&s({done:!0,type:"error",error:"Network error.",data:{text:"",conversationId:y}})}}),!E&&i&&(me.info("streaming end success"),S===""?(Hr("[API] response empty string.",JSON.stringify({model:a.model_name,promptTextLength:a.message_content.length},null,2),{uuid:"6f02f533-def6-4696-b14e-1b00c2d9a4df"}),s&&s({done:!0,type:"error",error:"Something went wrong, please try again. If this issue persists, contact us via email.",data:{text:"",conversationId:y}})):E=!0),K&&(me.info("user token expired"),this.status="needAuth",await Mr(),await this.updateClientStatus())}async abortTask(e){return this.taskList[e]&&(this.taskList[e](),delete this.taskList[e]),!0}async destroy(){me.info("destroy"),this.status="needAuth",this.active=!1}async getToken(){return await Pr()}async updateClientStatus(){this.active}};var $t=async()=>{try{return(await(await fetch("https://claude.ai/api/organizations",{redirect:"error",cache:"no-cache"})).json())?.[0]?.uuid}catch{return""}},qo=async(r,e)=>{try{if(!r)return;let t=U(),s=await fetch(`https://claude.ai/api/organizations/${r}/chat_conversations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e||"",uuid:t})});if(s.status===201||s.status===200){let n=await s.json();return n.uuid?n:void 0}else return}catch{return}},Mc=async r=>{try{let e=await fetch(`https://claude.ai/api/organizations/${r}/chat_conversations`,{method:"GET"});if(e.status===200){let t=await e.json();return t.length?t:[]}return[]}catch{return[]}},Fo=async(r,e)=>{let t=await Mc(r);t=t.filter(n=>n.name===e);let s=[];for(;t.length;)s=t.splice(0,5).map(n=>n.uuid),await Promise.all(s.map(n=>Zn(r,n))),await new Promise(n=>setTimeout(n,5e3))},Zn=async(r,e)=>{try{let t=await fetch(`https://claude.ai/api/organizations/${r}/chat_conversations/${e}`,{method:"DELETE"});return t.status===204||t.status===200}catch{return!1}},Vo=async(r,e,t)=>{let s=new FormData;s.append("file",e,t||e?.name||""),s.append("orgUuid",r);let n=await fetch("https://claude.ai/api/convert_document",{method:"POST",body:s});if(n.status===200){let o=await n.json();if(o.extracted_content)return o.file_name=t||e?.name||o.file_name||"",{success:!0,data:o,error:""}}let i="Upload failed.";return n.status===429&&(i="Exceeded file upload rate limit"),{success:!1,data:void 0,error:i}};var $r=class{conversation;abortController;organizationId;attachments=[];constructor(e){this.organizationId=e}get conversationId(){return this.conversation?.uuid}async createConversation(e){return this.organizationId||(this.organizationId=await $t()),this.organizationId&&(this.conversation=await qo(this.organizationId,e)),this.conversation?.uuid||""}async sendMessage(e,t){let{regenerate:s=!1,onMessage:n}=t||{},i=this.conversation?.uuid;if(!i||!this.organizationId){if(i=await this.createConversation(),!i||!this.organizationId){n?.({completion:"",log_id:"",messageLimit:{type:"within_limit"},model:"",stop:!0,stop_reason:"UNAUTHORIZED"});return}return}this.abortController=new AbortController;let o=this.abortController.signal,l=s?"https://claude.ai/api/retry_message":"https://claude.ai/api/append_message";s&&(e=""),await Ye(l,{signal:o,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attachments:this.attachments.map(c=>{let a=Or(c);return delete a.id,a}),completion:{incremental:!0,model:po[0].value,prompt:e,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},conversation_uuid:i,organization_uuid:this.organizationId,text:e}),onMessage:c=>{try{let a=JSON.parse(c);a.log_id&&n?.(a)}catch{}}}).then(()=>{}).catch(c=>{if(c?.message.includes("The user aborted a request.")||c?.message.includes("BodyStreamBuffer was aborted")){n?.({completion:"",log_id:"",messageLimit:{type:"within_limit"},model:"",stop:!0,stop_reason:"The user aborted a request."});return}try{let a=JSON.parse(c.message),u=a?.error?.message||a?.message||"Network Error";n?.({completion:"",log_id:"",messageLimit:{type:"within_limit"},model:"",stop:!0,stop_reason:u})}catch{n?.({completion:"",log_id:"",messageLimit:{type:"within_limit"},model:"",stop:!0,stop_reason:"Network Error"})}}),this.resetAttachments()}abortSendMessage(){this.abortController?.abort()}async resetConversation(){if(this.conversation?.uuid&&this.organizationId){let e=await Zn(this.organizationId,this.conversation.uuid)}return this.conversation=void 0,!0}async uploadAttachment(e,t){if(!this.organizationId&&(this.organizationId=await $t(),!this.organizationId))return{success:!1,error:"organization id not found",data:void 0};if(e.size>10*1024*1024)return{success:!1,error:"file size too large",data:void 0};let s=await Vo(this.organizationId,e,t||e.name);if(s.success&&s.data){let n=s.data;return n.id=U(),this.attachments.push(n),{success:!0,error:void 0,data:n}}else return{success:!1,error:s.error||"Upload failed.",data:void 0}}resetAttachments(){return this.attachments=[],!0}removeAttachment(e){let t=this.attachments.findIndex(s=>s.id===e);return t>-1&&this.attachments.splice(t,1),!0}};var Wt=Se(Et()),_t="CHROME_EXTENSION_LOCAL_STORAGE_CLAUDE_TOKEN_KEY",$o="WebChatGPT",Wo=class extends he{claude;constructor(){super("ClaudeChat"),this.claude=new $r,this.status="success"}async init(){this.log.info("init")}async preAuth(){this.active=!0;let e=await Wt.default.storage.local.get(_t);e[_t]&&(this.claude.organizationId=e[_t]),this.status=this.claude.organizationId?"success":"needAuth"}async auth(){this.active=!0,this.claude.organizationId=await $t(),this.claude.organizationId&&(this.status="success",await Wt.default.storage.local.set({[_t]:this.claude.organizationId}),await this.updateClientStatus("success"))}async createConversation(){if(this.claude.conversationId)return this.claude.conversationId;let e=await this.claude.createConversation($o);return this.claude.organizationId?await Wt.default.storage.local.set({[_t]:this.claude.organizationId}):(await Wt.default.storage.local.remove(_t),this.status="needAuth",await this.updateClientStatus("needAuth")),e}async askChatGPT(e,t,s){let{regenerate:n}=t||{},i="";this.log.info("ClaudeChat send"),await this.claude.sendMessage(e,{regenerate:n,onMessage:o=>{o.stop?o.stop_reason==="stop_sequence"?s?.({type:"message",done:!0,error:"",data:{text:i,conversationId:this.claude.conversationId}}):o.stop_reason==="The user aborted a request."?s?.({type:"error",error:"manual aborted request.",done:!0,data:{text:"",conversationId:this.claude.conversationId}}):s?.({type:"error",done:!0,error:o.stop_reason||"Network Error",data:{text:i,conversationId:this.claude.conversationId}}):(i+=o.completion||"",s?.({type:"message",done:!1,error:"",data:{text:i,conversationId:this.claude.conversationId}}))}})}async abortTask(e){return this.claude.abortSendMessage(),!0}async removeConversation(e){await this.claude.resetConversation(),this.claude.organizationId&&Fo(this.claude.organizationId,$o).then().catch()}};var Ll=Se(Yo());var xt=Symbol("changed"),Qe=Symbol("classList"),Z=Symbol("CustomElements"),jt=Symbol("content"),Wr=Symbol("dataset"),Ze=Symbol("doctype"),zt=Symbol("DOMParser"),f=Symbol("end"),Nt=Symbol("EventTarget"),At=Symbol("globals"),ae=Symbol("image"),ye=Symbol("mime"),Ae=Symbol("MutationObserver"),d=Symbol("next"),ri=Symbol("ownerElement"),P=Symbol("prev"),F=Symbol("private"),ut=Symbol("sheet"),X=Symbol("start"),jr=Symbol("style"),et=Symbol("upgrade"),w=Symbol("value");var Qo=new Set(["ARTICLE","ASIDE","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","COL","COLGROUP","DD","DIV","DL","DT","EMBED","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","LI","UL","OL","P"]),si=-1,ni=1,ii=4,oi=128,Zo=1,ai=2,li=4,ea=8,ta=16,ra=32,ht="http://www.w3.org/2000/svg";var{assign:sa,create:na,defineProperties:ia,entries:oa,getOwnPropertyDescriptors:Bp,keys:aa,setPrototypeOf:W}=Object;var pt=String;var J=r=>r.nodeType===1?r[f]:r,tt=({ownerDocument:r})=>r[ye].ignoreCase,te=(r,e)=>{r[d]=e,e[P]=r},Xt=(r,e,t)=>{te(r,e),te(J(e),t)},la=(r,e,t,s)=>{te(r,e),te(J(t),s)},Be=(r,e,t)=>{te(r,e),te(e,t)},Jt=({localName:r,ownerDocument:e})=>e[ye].ignoreCase?r.toUpperCase():r,zr=(r,e)=>{r&&(r[d]=e),e&&(e[P]=r)};var we=new WeakMap;var Jr=!1,Kt=new WeakMap,Ge=new WeakMap,mt=(r,e,t,s)=>{Jr&&Ge.has(r)&&r.attributeChangedCallback&&r.constructor.observedAttributes.includes(e)&&r.attributeChangedCallback(e,t,s)},ha=(r,e)=>t=>{if(Ge.has(t)){let s=Ge.get(t);s.connected!==e&&t.isConnected===e&&(s.connected=e,r in t&&t[r]())}},ca=ha("connectedCallback",!0),Yt=r=>{if(Jr){ca(r),we.has(r)&&(r=we.get(r).shadowRoot);let{[d]:e,[f]:t}=r;for(;e!==t;)e.nodeType===1&&ca(e),e=e[d]}},ua=ha("disconnectedCallback",!1),pa=r=>{if(Jr){ua(r),we.has(r)&&(r=we.get(r).shadowRoot);let{[d]:e,[f]:t}=r;for(;e!==t;)e.nodeType===1&&ua(e),e=e[d]}},Xr=class{constructor(e){this.ownerDocument=e,this.registry=new Map,this.waiting=new Map,this.active=!1}define(e,t,s={}){let{ownerDocument:n,registry:i,waiting:o}=this;if(i.has(e))throw new Error("unable to redefine "+e);if(Kt.has(t))throw new Error("unable to redefine the same class: "+t);this.active=Jr=!0;let{extends:l}=s;Kt.set(t,{ownerDocument:n,options:{is:l?e:""},localName:l||e});let c=l?a=>a.localName===l&&a.getAttribute("is")===e:a=>a.localName===e;if(i.set(e,{Class:t,check:c}),o.has(e)){for(let a of o.get(e))a(t);o.delete(e)}n.querySelectorAll(l?`${l}[is="${e}"]`:e).forEach(this.upgrade,this)}upgrade(e){if(Ge.has(e))return;let{ownerDocument:t,registry:s}=this,n=e.getAttribute("is")||e.localName;if(s.has(n)){let{Class:i,check:o}=s.get(n);if(o(e)){let{attributes:l,isConnected:c}=e;for(let u of l)e.removeAttributeNode(u);let a=oa(e);for(let[u]of a)delete e[u];W(e,i.prototype),t[et]={element:e,values:a},new i(t,n),Ge.set(e,{connected:c});for(let u of l)e.setAttributeNode(u);c&&e.connectedCallback&&e.connectedCallback()}}}whenDefined(e){let{registry:t,waiting:s}=this;return new Promise(n=>{t.has(e)?n(t.get(e).Class):(s.has(e)||s.set(e,[]),s.get(e).push(n))})}get(e){let t=this.registry.get(e);return t&&t.Class}};var{Parser:Uc}=io,ma=!0,wt=(r,e,t)=>{let s=r[f];return e.parentNode=r,Xt(s[P],e,s),t&&e.nodeType===1&&Yt(e),e},Bc=(r,e,t,s,n)=>{t[w]=s,t.ownerElement=r,Be(e[P],t,e),t.name==="class"&&(r.className=s),n&&mt(r,t.name,null,s)};var Kr=(r,e,t)=>{let{active:s,registry:n}=r[Z],i=r,o=null;ma=!1;let l=new Uc({onprocessinginstruction(c,a){c.toLowerCase()==="!doctype"&&(r.doctype=a.slice(c.length).trim())},onopentag(c,a){let u=!0;if(e){if(o)i=wt(i,r.createElementNS(ht,c),s),i.ownerSVGElement=o,u=!1;else if(c==="svg"||c==="SVG")o=r.createElementNS(ht,c),i=wt(i,o,s),u=!1;else if(s){let S=c.includes("-")?c:a.is||"";if(S&&n.has(S)){let{Class:E}=n.get(S);i=wt(i,new E,s),delete a.is,u=!1}}}u&&(i=wt(i,r.createElement(c),!1));let g=i[f];for(let S of aa(a))Bc(i,g,r.createAttribute(S),a[S],s)},oncomment(c){wt(i,r.createComment(c),s)},ontext(c){wt(i,r.createTextNode(c),s)},onclosetag(){e&&i===o&&(o=null),i=i.parentNode}},{lowerCaseAttributeNames:!1,decodeEntities:!0,xmlMode:!e});return l.write(t),l.end(),ma=!0,r};var It=new Map,I=(r,e)=>{for(let t of[].concat(r))It.set(t,e),It.set(t.toUpperCase(),e)};var wl=Se(da(),1);var ga=({[d]:r,[f]:e},t)=>{for(;r!==e;){switch(r.nodeType){case 2:ui(r,t);break;case 3:case 8:hi(r,t);break;case 1:mi(r,t),r=J(r);break;case 10:pi(r,t);break}r=r[d]}let s=t.length-1,n=t[s];typeof n=="number"&&n<0?t[s]+=-1:t.push(-1)},ui=(r,e)=>{e.push(2,r.name);let t=r[w].trim();t&&e.push(t)},hi=(r,e)=>{let t=r[w];t.trim()&&e.push(r.nodeType,t)},fa=(r,e)=>{e.push(r.nodeType),ga(r,e)},pi=({name:r,publicId:e,systemId:t},s)=>{s.push(10,r),e&&s.push(e),t&&s.push(t)},mi=(r,e)=>{e.push(1,r.localName),ga(r,e)};var ya=(r,e,t,s,n,i)=>({type:r,target:e,addedNodes:t,removedNodes:s,attributeName:n,oldValue:i}),Sa=(r,e,t,s,n,i)=>{if(!s||s.includes(t)){let{callback:o,records:l,scheduled:c}=r;l.push(ya("attributes",e,[],[],t,n?i:void 0)),c||(r.scheduled=!0,Promise.resolve().then(()=>{r.scheduled=!1,o(l.splice(0),r)}))}},Qt=(r,e,t)=>{let{ownerDocument:s}=r,{active:n,observers:i}=s[Ae];if(n){for(let o of i)for(let[l,{childList:c,subtree:a,attributes:u,attributeFilter:g,attributeOldValue:S}]of o.nodes)if(c){if(a&&(l===s||l.contains(r))||!a&&l.children.includes(r)){Sa(o,r,e,g,S,t);break}}else if(u&&l===r){Sa(o,r,e,g,S,t);break}}},rt=(r,e)=>{let{ownerDocument:t}=r,{active:s,observers:n}=t[Ae];if(s){for(let i of n)for(let[o,{subtree:l,childList:c,characterData:a}]of i.nodes)if(c&&(e&&(o===e||l&&o.contains(e))||!e&&(l&&(o===t||o.contains(r))||!l&&o[a?"childNodes":"children"].includes(r)))){let{callback:u,records:g,scheduled:S}=i;g.push(ya("childList",o,e?[]:[r],e?[r]:[])),S||(i.scheduled=!0,Promise.resolve().then(()=>{i.scheduled=!1,u(g.splice(0),i)}));break}}},Yr=class{constructor(e){let t=new Set;this.observers=t,this.active=!1,this.class=class{constructor(n){this.callback=n,this.nodes=new Map,this.records=[],this.scheduled=!1}disconnect(){this.records.splice(0),this.nodes.clear(),t.delete(this),e[Ae].active=!!t.size}observe(n,i={subtree:!1,childList:!1,attributes:!1,attributeFilter:null,attributeOldValue:!1,characterData:!1}){("attributeOldValue"in i||"attributeFilter"in i)&&(i.attributes=!0),i.childList=!!i.childList,i.subtree=!!i.subtree,this.nodes.set(n,i),t.add(this),e[Ae].active=!0}takeRecords(){return this.records.splice(0)}}}};var Ea=new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","class","contenteditable","controls","default","defer","disabled","draggable","formnovalidate","hidden","id","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","style","truespeed"]),Zt=(r,e)=>{let{[w]:t,name:s}=e;e.ownerElement=r,Be(r,e,r[d]),s==="class"&&(r.className=t),Qt(r,s,null),mt(r,s,null,t)},di=(r,e)=>{let{[w]:t,name:s}=e;te(e[P],e[d]),e.ownerElement=e[P]=e[d]=null,s==="class"&&(r[Qe]=null),Qt(r,s,t),mt(r,s,t,null)},x={get(r,e){return r.hasAttribute(e)},set(r,e,t){t?r.setAttribute(e,""):r.removeAttribute(e)}},Ee={get(r,e){return parseFloat(r.getAttribute(e)||0)},set(r,e,t){r.setAttribute(e,t)}},m={get(r,e){return r.getAttribute(e)||""},set(r,e,t){r.setAttribute(e,t)}};var Qr=new WeakMap;function Gc(r,e){return typeof e=="function"?e.call(r.target,r):e.handleEvent(r),r._stopImmediatePropagationFlag}function qc({currentTarget:r,target:e}){let t=Qr.get(r);if(t&&t.has(this.type)){let s=t.get(this.type);r===e?this.eventPhase=this.AT_TARGET:this.eventPhase=this.BUBBLING_PHASE,this.currentTarget=r,this.target=e;for(let[n,i]of s)if(i&&i.once&&s.delete(n),Gc(this,n))break;return delete this.currentTarget,delete this.target,this.cancelBubble}}var st=class{constructor(){Qr.set(this,new Map)}_getParent(){return null}addEventListener(e,t,s){let n=Qr.get(this);n.has(e)||n.set(e,new Map),n.get(e).set(t,s)}removeEventListener(e,t){let s=Qr.get(this);if(s.has(e)){let n=s.get(e);n.delete(t)&&!n.size&&s.delete(e)}}dispatchEvent(e){let t=this;for(e.eventPhase=e.CAPTURING_PHASE;t;)t.dispatchEvent&&e._path.push({currentTarget:t,target:this}),t=e.bubbles&&t._getParent&&t._getParent();return e._path.some(qc,e),e._path=[],e.eventPhase=e.NONE,!e.defaultPrevented}};var j=class extends Array{item(e){return e<this.length?this[e]:null}};var Ca=({parentNode:r})=>{let e=0;for(;r;)e++,r=r.parentNode;return e},re=class extends st{static get ELEMENT_NODE(){return 1}static get ATTRIBUTE_NODE(){return 2}static get TEXT_NODE(){return 3}static get COMMENT_NODE(){return 8}static get DOCUMENT_NODE(){return 9}static get DOCUMENT_FRAGMENT_NODE(){return 11}static get DOCUMENT_TYPE_NODE(){return 10}constructor(e,t,s){super(),this.ownerDocument=e,this.localName=t,this.nodeType=s,this.parentNode=null,this[d]=null,this[P]=null}get ELEMENT_NODE(){return 1}get ATTRIBUTE_NODE(){return 2}get TEXT_NODE(){return 3}get COMMENT_NODE(){return 8}get DOCUMENT_NODE(){return 9}get DOCUMENT_FRAGMENT_NODE(){return 11}get DOCUMENT_TYPE_NODE(){return 10}get baseURI(){let e=this.nodeType===9?this:this.ownerDocument;if(e){let t=e.querySelector("base");if(t)return t.getAttribute("href");let{location:s}=e.defaultView;if(s)return s.href}return null}get isConnected(){return!1}get nodeName(){return this.localName}get parentElement(){return null}get previousSibling(){return null}get previousElementSibling(){return null}get nextSibling(){return null}get nextElementSibling(){return null}get childNodes(){return new j}get firstChild(){return null}get lastChild(){return null}get nodeValue(){return null}set nodeValue(e){}get textContent(){return null}set textContent(e){}normalize(){}cloneNode(){return null}contains(){return!1}insertBefore(e,t){return e}appendChild(e){return e}replaceChild(e,t){return t}removeChild(e){return e}toString(){return""}hasChildNodes(){return!!this.lastChild}isSameNode(e){return this===e}compareDocumentPosition(e){let t=0;if(this!==e){let s=Ca(this),n=Ca(e);if(s<n)t+=li,this.contains(e)&&(t+=ta);else if(n<s)t+=ai,e.contains(this)&&(t+=ea);else if(s&&n){let{childNodes:i}=this.parentNode;i.indexOf(this)<i.indexOf(e)?t+=li:t+=ai}(!s||!n)&&(t+=ra,t+=Zo)}return t}isEqualNode(e){if(this===e)return!0;if(this.nodeType===e.nodeType){switch(this.nodeType){case 9:case 11:{let t=this.childNodes,s=e.childNodes;return t.length===s.length&&t.every((n,i)=>n.isEqualNode(s[i]))}}return this.toString()===e.toString()}return!1}_getParent(){return this.parentNode}getRootNode(){let e=this;for(;e.parentNode;)e=e.parentNode;return e.nodeType===9?e.documentElement:e}};var Fc=/"/g,se=class extends re{constructor(e,t,s=""){super(e,"#attribute",2),this.ownerElement=null,this.name=pt(t),this[w]=pt(s),this[xt]=!1}get value(){return this[w]}set value(e){let{[w]:t,name:s,ownerElement:n}=this;this[w]=pt(e),this[xt]=!0,n&&(Qt(n,s,t),mt(n,s,t,this[w]))}cloneNode(){let{ownerDocument:e,name:t,[w]:s}=this;return new se(e,t,s)}toString(){let{name:e,[w]:t}=this;return Ea.has(e)&&!t?e:`${e}="${t.replace(Fc,"&quot;")}"`}toJSON(){let e=[];return ui(this,e),e}};var Zr=({ownerDocument:r,parentNode:e})=>{for(;e;){if(e===r)return!0;e=e.parentNode||e.host}return!1},es=({parentNode:r})=>{if(r)switch(r.nodeType){case 9:case 11:return null}return r},qe=({[P]:r})=>{switch(r?r.nodeType:0){case-1:return r[X];case 3:case 8:return r}return null},Ce=r=>{let e=J(r)[d];return e&&(e.nodeType===-1?null:e)};var Rt=r=>{let e=Ce(r);for(;e&&e.nodeType!==1;)e=Ce(e);return e},ts=r=>{let e=qe(r);for(;e&&e.nodeType!==1;)e=qe(e);return e};var gi=(r,e)=>{let t=r.createDocumentFragment();return t.append(...e),t},rs=(r,e)=>{let{ownerDocument:t,parentNode:s}=r;s&&s.insertBefore(gi(t,e),r)},ss=(r,e)=>{let{ownerDocument:t,parentNode:s}=r;s&&s.insertBefore(gi(t,e),J(r)[d])},ns=(r,e)=>{let{ownerDocument:t,parentNode:s}=r;s&&(s.insertBefore(gi(t,e),r),r.remove())},is=(r,e,t)=>{let{parentNode:s,nodeType:n}=e;(r||t)&&(zr(r,t),e[P]=null,J(e)[d]=null),s&&(e.parentNode=null,rt(e,s),n===1&&pa(e))};var Fe=class extends re{constructor(e,t,s,n){super(e,t,s),this[w]=pt(n)}get isConnected(){return Zr(this)}get parentElement(){return es(this)}get previousSibling(){return qe(this)}get nextSibling(){return Ce(this)}get previousElementSibling(){return ts(this)}get nextElementSibling(){return Rt(this)}before(...e){rs(this,e)}after(...e){ss(this,e)}replaceWith(...e){ns(this,e)}remove(){is(this[P],this,this[d])}get data(){return this[w]}set data(e){this[w]=pt(e),rt(this,this.parentNode)}get nodeValue(){return this.data}set nodeValue(e){this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}get length(){return this.data.length}substringData(e,t){return this.data.substr(e,t)}appendData(e){this.data+=e}insertData(e,t){let{data:s}=this;this.data=s.slice(0,e)+t+s.slice(e)}deleteData(e,t){let{data:s}=this;this.data=s.slice(0,e)+s.slice(e+t)}replaceData(e,t,s){let{data:n}=this;this.data=n.slice(0,e)+s+n.slice(e+t)}toJSON(){let e=[];return hi(this,e),e}};var Re=class extends Fe{constructor(e,t=""){super(e,"#comment",8,t)}cloneNode(){let{ownerDocument:e,[w]:t}=this;return new Re(e,t)}toString(){return`<!--${this[w]}-->`}};var{isArray:Vc}=Array,os=({nodeType:r})=>r===1,va=(r,e)=>e.some(t=>os(t)&&(r(t)||va(r,Lt(t)))),$c=(r,e)=>e==="class"?r.classList.value:r.getAttribute(e),Lt=({childNodes:r})=>r,Wc=r=>{let{localName:e}=r;return tt(r)?e.toLowerCase():e},jc=({parentNode:r})=>r,zc=r=>{let{parentNode:e}=r;return e?Lt(e):r},fi=r=>Vc(r)?r.map(fi).join(""):os(r)?fi(Lt(r)):r.nodeType===3?r.data:"",Xc=(r,e)=>r.hasAttribute(e),Jc=r=>{let{length:e}=r;for(;e--;){let t=r[e];if(e&&-1<r.lastIndexOf(t,e-1)){r.splice(e,1);continue}for(let{parentNode:s}=t;s;s=s.parentNode)if(r.includes(s)){r.splice(e,1);break}}return r},Ta=(r,e)=>{let t=[];for(let s of e)os(s)&&(r(s)&&t.push(s),t.push(...Ta(r,Lt(s))));return t},ba=(r,e)=>{for(let t of e)if(r(t)||(t=ba(r,Lt(t))))return t;return null},_a={isTag:os,existsOne:va,getAttributeValue:$c,getChildren:Lt,getName:Wc,getParent:jc,getSiblings:zc,getText:fi,hasAttrib:Xc,removeSubsets:Jc,findAll:Ta,findOne:ba},er=(r,e)=>oo(e,{context:e.includes(":scope")?r:void 0,xmlMode:!tt(r),adapter:_a}),xa=(r,e)=>ao(r,e,{strict:!0,context:e.includes(":scope")?r:void 0,xmlMode:!tt(r),adapter:_a});var{replace:Kc}="",Yc=/[<>&\xA0]/g,Qc={"\xA0":"&nbsp;","&":"&amp;","<":"&lt;",">":"&gt;"},Zc=r=>Qc[r],Na=r=>Kc.call(r,Yc,Zc);var ne=class extends Fe{constructor(e,t=""){super(e,"#text",3,t)}get wholeText(){let e=[],{previousSibling:t,nextSibling:s}=this;for(;t&&t.nodeType===3;){e.unshift(t[w]);t=t.previousSibling}for(e.push(this[w]);s&&s.nodeType===3;){e.push(s[w]);s=s.nextSibling}return e.join("")}cloneNode(){let{ownerDocument:e,[w]:t}=this;return new ne(e,t)}toString(){return Na(this[w])}};var eu=r=>r instanceof re,Si=(r,e,t)=>{let{ownerDocument:s}=r;for(let n of t)r.insertBefore(eu(n)?n:new ne(s,n),e)},Pt=class extends re{constructor(e,t,s){super(e,t,s),this[F]=null,this[d]=this[f]={[d]:null,[P]:this,[X]:this,nodeType:-1,ownerDocument:this.ownerDocument,parentNode:null}}get childNodes(){let e=new j,{firstChild:t}=this;for(;t;)e.push(t),t=Ce(t);return e}get children(){let e=new j,{firstElementChild:t}=this;for(;t;)e.push(t),t=Rt(t);return e}get firstChild(){let{[d]:e,[f]:t}=this;for(;e.nodeType===2;)e=e[d];return e===t?null:e}get firstElementChild(){let{firstChild:e}=this;for(;e;){if(e.nodeType===1)return e;e=Ce(e)}return null}get lastChild(){let e=this[f][P];switch(e.nodeType){case-1:return e[X];case 2:return null}return e===this?null:e}get lastElementChild(){let{lastChild:e}=this;for(;e;){if(e.nodeType===1)return e;e=qe(e)}return null}get childElementCount(){return this.children.length}prepend(...e){Si(this,this.firstChild,e)}append(...e){Si(this,this[f],e)}replaceChildren(...e){let{[d]:t,[f]:s}=this;for(;t!==s&&t.nodeType===2;)t=t[d];for(;t!==s;){let n=J(t)[d];t.remove(),t=n}e.length&&Si(this,s,e)}getElementsByClassName(e){let t=new j,{[d]:s,[f]:n}=this;for(;s!==n;)s.nodeType===1&&s.hasAttribute("class")&&s.classList.has(e)&&t.push(s),s=s[d];return t}getElementsByTagName(e){let t=new j,{[d]:s,[f]:n}=this;for(;s!==n;)s.nodeType===1&&(s.localName===e||Jt(s)===e)&&t.push(s),s=s[d];return t}querySelector(e){let t=er(this,e),{[d]:s,[f]:n}=this;for(;s!==n;){if(s.nodeType===1&&t(s))return s;s=s.localName==="template"?s[f]:s[d]}return null}querySelectorAll(e){let t=er(this,e),s=new j,{[d]:n,[f]:i}=this;for(;n!==i;)n.nodeType===1&&t(n)&&s.push(n),n=n.localName==="template"?n[f]:n[d];return s}appendChild(e){return this.insertBefore(e,this[f])}contains(e){let t=e;for(;t&&t!==this;)t=t.parentNode;return t===this}insertBefore(e,t=null){if(e===t)return e;if(e===this)throw new Error("unable to append a node to itself");let s=t||this[f];switch(e.nodeType){case 1:e.remove(),e.parentNode=this,Xt(s[P],e,s),rt(e,null),Yt(e);break;case 11:{let{[F]:n,firstChild:i,lastChild:o}=e;if(i){la(s[P],i,o,s),te(e,e[f]),n&&n.replaceChildren();do i.parentNode=this,rt(i,null),i.nodeType===1&&Yt(i);while(i!==o&&(i=Ce(i)))}break}case 3:case 8:e.remove();default:e.parentNode=this,Be(s[P],e,s),rt(e,null);break}return e}normalize(){let{[d]:e,[f]:t}=this;for(;e!==t;){let{[d]:s,[P]:n,nodeType:i}=e;i===3&&(e[w]?n&&n.nodeType===3&&(n.textContent+=e.textContent,e.remove()):e.remove()),e=s}}removeChild(e){if(e.parentNode!==this)throw new Error("node is not a child");return e.remove(),e}replaceChild(e,t){let s=J(t)[d];return t.remove(),this.insertBefore(e,s),t}};var nt=class extends Pt{getElementById(e){let{[d]:t,[f]:s}=this;for(;t!==s;){if(t.nodeType===1&&t.id===e)return t;t=t[d]}return null}cloneNode(e){let{ownerDocument:t,constructor:s}=this,n=new s(t);if(e){let{[f]:i}=n;for(let o of this.childNodes)n.insertBefore(o.cloneNode(e),i)}return n}toString(){let{childNodes:e,localName:t}=this;return`<${t}>${e.join("")}</${t}>`}toJSON(){let e=[];return fa(this,e),e}};var dt=class extends nt{constructor(e){super(e,"#document-fragment",11)}};var ve=class extends re{constructor(e,t,s="",n=""){super(e,"#document-type",10),this.name=t,this.publicId=s,this.systemId=n}cloneNode(){let{ownerDocument:e,name:t,publicId:s,systemId:n}=this;return new ve(e,t,s,n)}toString(){let{name:e,publicId:t,systemId:s}=this,n=0<t.length,i=[e];return n&&i.push("PUBLIC",`"${t}"`),s.length&&(n||i.push("SYSTEM"),i.push(`"${s}"`)),`<!DOCTYPE ${i.join(" ")}>`}toJSON(){let e=[];return pi(this,e),e}};var as=r=>r.childNodes.join(""),ls=(r,e)=>{let{ownerDocument:t}=r,{constructor:s}=t,n=new s;n[Z]=t[Z];let{childNodes:i}=Kr(n,tt(r),e);r.replaceChildren(...i.map(Aa,t))};function Aa(r){switch(r.ownerDocument=this,r.nodeType){case 1:case 11:r.childNodes.forEach(Aa,this);break}return r}var Mt=r=>r.replace(/(([A-Z0-9])([A-Z0-9][a-z]))|(([a-z0-9]+)([A-Z]))/g,"$2$5-$3$6").toLowerCase();var cs=new WeakMap,yi=r=>`data-${Mt(r)}`,tu=r=>r.slice(5).replace(/-([a-z])/g,(e,t)=>t.toUpperCase()),ru={get(r,e){if(e in r)return cs.get(r).getAttribute(yi(e))},set(r,e,t){return r[e]=t,cs.get(r).setAttribute(yi(e),t),!0},deleteProperty(r,e){return e in r&&cs.get(r).removeAttribute(yi(e)),delete r[e]}},tr=class{constructor(e){for(let{name:t,value:s}of e.attributes)/^data-/.test(t)&&(this[tu(t)]=s);return cs.set(this,e),new Proxy(this,ru)}};W(tr.prototype,null);var{add:su}=Set.prototype,wa=(r,e)=>{for(let t of e)t&&su.call(r,t)},rr=({[ri]:r,value:e})=>{let t=r.getAttributeNode("class");t?t.value=e:Zt(r,new se(r.ownerDocument,"class",e))},us=class extends Set{constructor(e){super(),this[ri]=e;let t=e.getAttributeNode("class");t&&wa(this,t.value.split(/\s+/))}get length(){return this.size}get value(){return[...this].join(" ")}add(...e){wa(this,e),rr(this)}contains(e){return this.has(e)}remove(...e){for(let t of e)this.delete(t);rr(this)}toggle(e,t){if(this.has(e)){if(t)return!0;this.delete(e),rr(this)}else if(t||arguments.length===1)return super.add(e),rr(this),!0;return!1}replace(e,t){return this.has(e)?(this.delete(e),super.add(t),rr(this),!0):!1}supports(){return!0}};var ps=new WeakMap,Ei=r=>[...r.keys()].filter(e=>e!==F),Ci=r=>{let e=ps.get(r).getAttributeNode("style");if((!e||e[xt]||r.get(F)!==e)&&(r.clear(),e)){r.set(F,e);for(let t of e[w].split(/\s*;\s*/)){let[s,...n]=t.split(":");if(n.length>0){s=s.trim();let i=n.join(":").trim();s&&i&&r.set(s,i)}}}return e},hs={get(r,e){return e in nu?r[e]:(Ci(r),e==="length"?Ei(r).length:/^\d+$/.test(e)?Ei(r)[e]:r.get(Mt(e)))},set(r,e,t){if(e==="cssText")r[e]=t;else{let s=Ci(r);if(t==null?r.delete(Mt(e)):r.set(Mt(e),t),!s){let n=ps.get(r);s=n.ownerDocument.createAttribute("style"),n.setAttributeNode(s),r.set(F,s)}s[xt]=!1,s[w]=r.toString()}return!0}},sr=class extends Map{constructor(e){return super(),ps.set(this,e),new Proxy(this,hs)}get cssText(){return this.toString()}set cssText(e){ps.get(this).setAttribute("style",e)}getPropertyValue(e){let t=this[F];return hs.get(t,e)}setProperty(e,t){let s=this[F];hs.set(s,e,t)}removeProperty(e){let t=this[F];hs.set(t,e,null)}[Symbol.iterator](){let e=Ei(this[F]),{length:t}=e,s=0;return{next(){let n=s===t;return{done:n,value:n?null:e[s++]}}}}get[F](){return this}toString(){let e=this[F];Ci(e);let t=[];return e.forEach(iu,t),t.join(";")}},{prototype:nu}=sr;function iu(r,e){e!==F&&this.push(`${e}:${r}`)}var ee=class{static get BUBBLING_PHASE(){return 3}static get AT_TARGET(){return 2}static get CAPTURING_PHASE(){return 1}static get NONE(){return 0}constructor(e,t={}){this.type=e,this.bubbles=!!t.bubbles,this.cancelBubble=!1,this._stopImmediatePropagationFlag=!1,this.cancelable=!!t.cancelable,this.eventPhase=this.NONE,this.timeStamp=Date.now(),this.defaultPrevented=!1,this.originalTarget=null,this.returnValue=null,this.srcElement=null,this.target=null,this._path=[]}get BUBBLING_PHASE(){return 3}get AT_TARGET(){return 2}get CAPTURING_PHASE(){return 1}get NONE(){return 0}preventDefault(){this.defaultPrevented=!0}composedPath(){return this._path}stopPropagation(){this.cancelBubble=!0}stopImmediatePropagation(){this.stopPropagation(),this._stopImmediatePropagationFlag=!0}};var Ot=class extends Array{constructor(e){super(),this.ownerElement=e}getNamedItem(e){return this.ownerElement.getAttributeNode(e)}setNamedItem(e){this.ownerElement.setAttributeNode(e),this.unshift(e)}removeNamedItem(e){let t=this.getNamedItem(e);this.ownerElement.removeAttribute(e),this.splice(this.indexOf(t),1)}item(e){return e<this.length?this[e]:null}getNamedItemNS(e,t){return this.getNamedItem(t)}setNamedItemNS(e,t){return this.setNamedItem(t)}removeNamedItemNS(e,t){return this.removeNamedItem(t)}};var gt=class extends nt{constructor(e){super(e.ownerDocument,"#shadow-root",11),this.host=e}get innerHTML(){return as(this)}set innerHTML(e){ls(this,e)}};var ou={get(r,e){return e in r?r[e]:r.find(({name:t})=>t===e)}},Ia=(r,e,t)=>{if("ownerSVGElement"in e){let s=r.createElementNS(ht,t);return s.ownerSVGElement=e.ownerSVGElement,s}return r.createElement(t)},au=({localName:r,ownerDocument:e})=>e[ye].voidElements.test(r),Te=class extends Pt{constructor(e,t){super(e,t,1),this[Qe]=null,this[Wr]=null,this[jr]=null}get isConnected(){return Zr(this)}get parentElement(){return es(this)}get previousSibling(){return qe(this)}get nextSibling(){return Ce(this)}get namespaceURI(){return"http://www.w3.org/1999/xhtml"}get previousElementSibling(){return ts(this)}get nextElementSibling(){return Rt(this)}before(...e){rs(this,e)}after(...e){ss(this,e)}replaceWith(...e){ns(this,e)}remove(){is(this[P],this,this[f][d])}get id(){return m.get(this,"id")}set id(e){m.set(this,"id",e)}get className(){return this.classList.value}set className(e){let{classList:t}=this;t.clear(),t.add(...e.split(/\s+/))}get nodeName(){return Jt(this)}get tagName(){return Jt(this)}get classList(){return this[Qe]||(this[Qe]=new us(this))}get dataset(){return this[Wr]||(this[Wr]=new tr(this))}get nonce(){return m.get(this,"nonce")}set nonce(e){m.set(this,"nonce",e)}get style(){return this[jr]||(this[jr]=new sr(this))}get tabIndex(){return Ee.get(this,"tabindex")||-1}set tabIndex(e){Ee.set(this,"tabindex",e)}get innerText(){let e=[],{[d]:t,[f]:s}=this;for(;t!==s;)t.nodeType===3?e.push(t.textContent.replace(/\s+/g," ")):e.length&&t[d]!=s&&Qo.has(t.tagName)&&e.push(`
`),t=t[d];return e.join("")}get textContent(){let e=[],{[d]:t,[f]:s}=this;for(;t!==s;)t.nodeType===3&&e.push(t.textContent),t=t[d];return e.join("")}set textContent(e){this.replaceChildren(),e&&this.appendChild(new ne(this.ownerDocument,e))}get innerHTML(){return as(this)}set innerHTML(e){ls(this,e)}get outerHTML(){return this.toString()}set outerHTML(e){let t=this.ownerDocument.createElement("");t.innerHTML=e,this.replaceWith(...t.childNodes)}get attributes(){let e=new Ot(this),t=this[d];for(;t.nodeType===2;)e.push(t),t=t[d];return new Proxy(e,ou)}focus(){this.dispatchEvent(new ee("focus"))}getAttribute(e){if(e==="class")return this.className;let t=this.getAttributeNode(e);return t&&t.value}getAttributeNode(e){let t=this[d];for(;t.nodeType===2;){if(t.name===e)return t;t=t[d]}return null}getAttributeNames(){let e=new j,t=this[d];for(;t.nodeType===2;)e.push(t.name),t=t[d];return e}hasAttribute(e){return!!this.getAttributeNode(e)}hasAttributes(){return this[d].nodeType===2}removeAttribute(e){e==="class"&&this[Qe]&&this[Qe].clear();let t=this[d];for(;t.nodeType===2;){if(t.name===e){di(this,t);return}t=t[d]}}removeAttributeNode(e){let t=this[d];for(;t.nodeType===2;){if(t===e){di(this,t);return}t=t[d]}}setAttribute(e,t){if(e==="class")this.className=t;else{let s=this.getAttributeNode(e);s?s.value=t:Zt(this,new se(this.ownerDocument,e,t))}}setAttributeNode(e){let{name:t}=e,s=this.getAttributeNode(t);if(s!==e){s&&this.removeAttributeNode(s);let{ownerElement:n}=e;n&&n.removeAttributeNode(e),Zt(this,e)}return s}toggleAttribute(e,t){return this.hasAttribute(e)?t?!0:(this.removeAttribute(e),!1):t||arguments.length===1?(this.setAttribute(e,""),!0):!1}get shadowRoot(){if(we.has(this)){let{mode:e,shadowRoot:t}=we.get(this);if(e==="open")return t}return null}attachShadow(e){if(we.has(this))throw new Error("operation not supported");let t=new gt(this);return t.append(...this.childNodes),we.set(this,{mode:e.mode,shadowRoot:t}),t}matches(e){return xa(this,e)}closest(e){let t=this,s=er(t,e);for(;t&&!s(t);)t=t.parentElement;return t}insertAdjacentElement(e,t){let{parentElement:s}=this;switch(e){case"beforebegin":if(s){s.insertBefore(t,this);break}return null;case"afterbegin":this.insertBefore(t,this.firstChild);break;case"beforeend":this.insertBefore(t,null);break;case"afterend":if(s){s.insertBefore(t,this.nextSibling);break}return null}return t}insertAdjacentHTML(e,t){let s=this.ownerDocument.createElement("template");s.innerHTML=t,this.insertAdjacentElement(e,s.content)}insertAdjacentText(e,t){let s=this.ownerDocument.createTextNode(t);this.insertAdjacentElement(e,s)}cloneNode(e=!1){let{ownerDocument:t,localName:s}=this,n=u=>{u.parentNode=o,te(l,u),l=u},i=Ia(t,this,s),o=i,l=i,{[d]:c,[f]:a}=this;for(;c!==a&&(e||c.nodeType===2);){switch(c.nodeType){case-1:te(l,o[f]),l=o[f],o=o.parentNode;break;case 1:{let u=Ia(t,c,c.localName);n(u),o=u;break}case 2:{let u=c.cloneNode(e);u.ownerElement=o,n(u);break}case 3:case 8:n(c.cloneNode(e));break}c=c[d]}return te(l,i[f]),i}toString(){let e=[],{[f]:t}=this,s={[d]:this},n=!1;do switch(s=s[d],s.nodeType){case 2:{let i=" "+s;switch(i){case" id":case" class":case" style":break;default:e.push(i)}break}case-1:{let i=s[X];n?("ownerSVGElement"in i?e.push(" />"):au(i)?e.push(tt(i)?">":" />"):e.push(`></${i.localName}>`),n=!1):e.push(`</${i.localName}>`);break}case 1:n&&e.push(">"),s.toString!==this.toString?(e.push(s.toString()),s=s[f],n=!1):(e.push(`<${s.localName}`),n=!0);break;case 3:case 8:e.push((n?">":"")+s),n=!1;break}while(s!==t);return e.join("")}toJSON(){let e=[];return mi(this,e),e}getAttributeNS(e,t){return this.getAttribute(t)}getElementsByTagNameNS(e,t){return this.getElementsByTagName(t)}hasAttributeNS(e,t){return this.hasAttribute(t)}removeAttributeNS(e,t){this.removeAttribute(t)}setAttributeNS(e,t,s){this.setAttribute(t,s)}setAttributeNodeNS(e){return this.setAttributeNode(e)}};var vi=new WeakMap,lu={get(r,e){return r[e]},set(r,e,t){return r[e]=t,!0}},it=class extends Te{constructor(e,t,s=null){super(e,t),this.ownerSVGElement=s}get className(){return vi.has(this)||vi.set(this,new Proxy({baseVal:"",animVal:""},lu)),vi.get(this)}set className(e){let{classList:t}=this;t.clear(),t.add(...e.split(/\s+/))}get namespaceURI(){return"http://www.w3.org/2000/svg"}getAttribute(e){return e==="class"?[...this.classList].join(" "):super.getAttribute(e)}setAttribute(e,t){if(e==="class")this.className=t;else if(e==="style"){let{className:s}=this;s.baseVal=s.animVal=t}super.setAttribute(e,t)}};var ie=()=>{throw new TypeError("Illegal constructor")};function Ti(){ie()}W(Ti,se);Ti.prototype=se.prototype;function bi(){ie()}W(bi,Fe);bi.prototype=Fe.prototype;function _i(){ie()}W(_i,Re);_i.prototype=Re.prototype;function xi(){ie()}W(xi,dt);xi.prototype=dt.prototype;function Ni(){ie()}W(Ni,ve);Ni.prototype=ve.prototype;function Ai(){ie()}W(Ai,Te);Ai.prototype=Te.prototype;function wi(){ie()}W(wi,re);wi.prototype=re.prototype;function Ii(){ie()}W(Ii,gt);Ii.prototype=gt.prototype;function Ri(){ie()}W(Ri,ne);Ri.prototype=ne.prototype;function Li(){ie()}W(Li,it);Li.prototype=it.prototype;var Ra={Attr:Ti,CharacterData:bi,Comment:_i,DocumentFragment:xi,DocumentType:Ni,Element:Ai,Node:wi,ShadowRoot:Ii,Text:Ri,SVGElement:Li};var nr=new WeakMap,h={get(r,e){return nr.has(r)&&nr.get(r)[e]||null},set(r,e,t){nr.has(r)||nr.set(r,{});let s=nr.get(r),n=e.slice(2);s[e]&&r.removeEventListener(n,s[e],!1),(s[e]=t)&&r.addEventListener(n,t,!1)}},p=class extends Te{static get observedAttributes(){return[]}constructor(e=null,t=""){super(e,t);let s=!e,n;if(s){let{constructor:i}=this;if(!Kt.has(i))throw new Error("unable to initialize this Custom Element");({ownerDocument:e,localName:t,options:n}=Kt.get(i))}if(e[et]){let{element:i,values:o}=e[et];e[et]=null;for(let[l,c]of o)i[l]=c;return i}s&&(this.ownerDocument=this[f].ownerDocument=e,this.localName=t,Ge.set(this,{connected:!1}),n.is&&this.setAttribute("is",n.is))}blur(){this.dispatchEvent(new ee("blur"))}click(){this.dispatchEvent(new ee("click"))}get accessKeyLabel(){let{accessKey:e}=this;return e&&`Alt+Shift+${e}`}get isContentEditable(){return this.hasAttribute("contenteditable")}get contentEditable(){return x.get(this,"contenteditable")}set contentEditable(e){x.set(this,"contenteditable",e)}get draggable(){return x.get(this,"draggable")}set draggable(e){x.set(this,"draggable",e)}get hidden(){return x.get(this,"hidden")}set hidden(e){x.set(this,"hidden",e)}get spellcheck(){return x.get(this,"spellcheck")}set spellcheck(e){x.set(this,"spellcheck",e)}get accessKey(){return m.get(this,"accesskey")}set accessKey(e){m.set(this,"accesskey",e)}get dir(){return m.get(this,"dir")}set dir(e){m.set(this,"dir",e)}get lang(){return m.get(this,"lang")}set lang(e){m.set(this,"lang",e)}get title(){return m.get(this,"title")}set title(e){m.set(this,"title",e)}get onabort(){return h.get(this,"onabort")}set onabort(e){h.set(this,"onabort",e)}get onblur(){return h.get(this,"onblur")}set onblur(e){h.set(this,"onblur",e)}get oncancel(){return h.get(this,"oncancel")}set oncancel(e){h.set(this,"oncancel",e)}get oncanplay(){return h.get(this,"oncanplay")}set oncanplay(e){h.set(this,"oncanplay",e)}get oncanplaythrough(){return h.get(this,"oncanplaythrough")}set oncanplaythrough(e){h.set(this,"oncanplaythrough",e)}get onchange(){return h.get(this,"onchange")}set onchange(e){h.set(this,"onchange",e)}get onclick(){return h.get(this,"onclick")}set onclick(e){h.set(this,"onclick",e)}get onclose(){return h.get(this,"onclose")}set onclose(e){h.set(this,"onclose",e)}get oncontextmenu(){return h.get(this,"oncontextmenu")}set oncontextmenu(e){h.set(this,"oncontextmenu",e)}get oncuechange(){return h.get(this,"oncuechange")}set oncuechange(e){h.set(this,"oncuechange",e)}get ondblclick(){return h.get(this,"ondblclick")}set ondblclick(e){h.set(this,"ondblclick",e)}get ondrag(){return h.get(this,"ondrag")}set ondrag(e){h.set(this,"ondrag",e)}get ondragend(){return h.get(this,"ondragend")}set ondragend(e){h.set(this,"ondragend",e)}get ondragenter(){return h.get(this,"ondragenter")}set ondragenter(e){h.set(this,"ondragenter",e)}get ondragleave(){return h.get(this,"ondragleave")}set ondragleave(e){h.set(this,"ondragleave",e)}get ondragover(){return h.get(this,"ondragover")}set ondragover(e){h.set(this,"ondragover",e)}get ondragstart(){return h.get(this,"ondragstart")}set ondragstart(e){h.set(this,"ondragstart",e)}get ondrop(){return h.get(this,"ondrop")}set ondrop(e){h.set(this,"ondrop",e)}get ondurationchange(){return h.get(this,"ondurationchange")}set ondurationchange(e){h.set(this,"ondurationchange",e)}get onemptied(){return h.get(this,"onemptied")}set onemptied(e){h.set(this,"onemptied",e)}get onended(){return h.get(this,"onended")}set onended(e){h.set(this,"onended",e)}get onerror(){return h.get(this,"onerror")}set onerror(e){h.set(this,"onerror",e)}get onfocus(){return h.get(this,"onfocus")}set onfocus(e){h.set(this,"onfocus",e)}get oninput(){return h.get(this,"oninput")}set oninput(e){h.set(this,"oninput",e)}get oninvalid(){return h.get(this,"oninvalid")}set oninvalid(e){h.set(this,"oninvalid",e)}get onkeydown(){return h.get(this,"onkeydown")}set onkeydown(e){h.set(this,"onkeydown",e)}get onkeypress(){return h.get(this,"onkeypress")}set onkeypress(e){h.set(this,"onkeypress",e)}get onkeyup(){return h.get(this,"onkeyup")}set onkeyup(e){h.set(this,"onkeyup",e)}get onload(){return h.get(this,"onload")}set onload(e){h.set(this,"onload",e)}get onloadeddata(){return h.get(this,"onloadeddata")}set onloadeddata(e){h.set(this,"onloadeddata",e)}get onloadedmetadata(){return h.get(this,"onloadedmetadata")}set onloadedmetadata(e){h.set(this,"onloadedmetadata",e)}get onloadstart(){return h.get(this,"onloadstart")}set onloadstart(e){h.set(this,"onloadstart",e)}get onmousedown(){return h.get(this,"onmousedown")}set onmousedown(e){h.set(this,"onmousedown",e)}get onmouseenter(){return h.get(this,"onmouseenter")}set onmouseenter(e){h.set(this,"onmouseenter",e)}get onmouseleave(){return h.get(this,"onmouseleave")}set onmouseleave(e){h.set(this,"onmouseleave",e)}get onmousemove(){return h.get(this,"onmousemove")}set onmousemove(e){h.set(this,"onmousemove",e)}get onmouseout(){return h.get(this,"onmouseout")}set onmouseout(e){h.set(this,"onmouseout",e)}get onmouseover(){return h.get(this,"onmouseover")}set onmouseover(e){h.set(this,"onmouseover",e)}get onmouseup(){return h.get(this,"onmouseup")}set onmouseup(e){h.set(this,"onmouseup",e)}get onmousewheel(){return h.get(this,"onmousewheel")}set onmousewheel(e){h.set(this,"onmousewheel",e)}get onpause(){return h.get(this,"onpause")}set onpause(e){h.set(this,"onpause",e)}get onplay(){return h.get(this,"onplay")}set onplay(e){h.set(this,"onplay",e)}get onplaying(){return h.get(this,"onplaying")}set onplaying(e){h.set(this,"onplaying",e)}get onprogress(){return h.get(this,"onprogress")}set onprogress(e){h.set(this,"onprogress",e)}get onratechange(){return h.get(this,"onratechange")}set onratechange(e){h.set(this,"onratechange",e)}get onreset(){return h.get(this,"onreset")}set onreset(e){h.set(this,"onreset",e)}get onresize(){return h.get(this,"onresize")}set onresize(e){h.set(this,"onresize",e)}get onscroll(){return h.get(this,"onscroll")}set onscroll(e){h.set(this,"onscroll",e)}get onseeked(){return h.get(this,"onseeked")}set onseeked(e){h.set(this,"onseeked",e)}get onseeking(){return h.get(this,"onseeking")}set onseeking(e){h.set(this,"onseeking",e)}get onselect(){return h.get(this,"onselect")}set onselect(e){h.set(this,"onselect",e)}get onshow(){return h.get(this,"onshow")}set onshow(e){h.set(this,"onshow",e)}get onstalled(){return h.get(this,"onstalled")}set onstalled(e){h.set(this,"onstalled",e)}get onsubmit(){return h.get(this,"onsubmit")}set onsubmit(e){h.set(this,"onsubmit",e)}get onsuspend(){return h.get(this,"onsuspend")}set onsuspend(e){h.set(this,"onsuspend",e)}get ontimeupdate(){return h.get(this,"ontimeupdate")}set ontimeupdate(e){h.set(this,"ontimeupdate",e)}get ontoggle(){return h.get(this,"ontoggle")}set ontoggle(e){h.set(this,"ontoggle",e)}get onvolumechange(){return h.get(this,"onvolumechange")}set onvolumechange(e){h.set(this,"onvolumechange",e)}get onwaiting(){return h.get(this,"onwaiting")}set onwaiting(e){h.set(this,"onwaiting",e)}get onauxclick(){return h.get(this,"onauxclick")}set onauxclick(e){h.set(this,"onauxclick",e)}get ongotpointercapture(){return h.get(this,"ongotpointercapture")}set ongotpointercapture(e){h.set(this,"ongotpointercapture",e)}get onlostpointercapture(){return h.get(this,"onlostpointercapture")}set onlostpointercapture(e){h.set(this,"onlostpointercapture",e)}get onpointercancel(){return h.get(this,"onpointercancel")}set onpointercancel(e){h.set(this,"onpointercancel",e)}get onpointerdown(){return h.get(this,"onpointerdown")}set onpointerdown(e){h.set(this,"onpointerdown",e)}get onpointerenter(){return h.get(this,"onpointerenter")}set onpointerenter(e){h.set(this,"onpointerenter",e)}get onpointerleave(){return h.get(this,"onpointerleave")}set onpointerleave(e){h.set(this,"onpointerleave",e)}get onpointermove(){return h.get(this,"onpointermove")}set onpointermove(e){h.set(this,"onpointermove",e)}get onpointerout(){return h.get(this,"onpointerout")}set onpointerout(e){h.set(this,"onpointerout",e)}get onpointerover(){return h.get(this,"onpointerover")}set onpointerover(e){h.set(this,"onpointerover",e)}get onpointerup(){return h.get(this,"onpointerup")}set onpointerup(e){h.set(this,"onpointerup",e)}};var La="template",ir=class extends p{constructor(e){super(e,La);let t=this.ownerDocument.createDocumentFragment();(this[jt]=t)[F]=this}get content(){if(this.hasChildNodes()&&!this[jt].hasChildNodes())for(let e of this.childNodes)this[jt].appendChild(e.cloneNode(!0));return this[jt]}};I(La,ir);var ms=class extends p{constructor(e,t="html"){super(e,t)}};var{toString:cu}=p.prototype,Le=class extends p{get innerHTML(){return this.textContent}set innerHTML(e){this.textContent=e}toString(){return cu.call(this.cloneNode()).replace(/></,`>${this.textContent}<`)}};var Pa="script",or=class extends Le{constructor(e,t=Pa){super(e,t)}get type(){return m.get(this,"type")}set type(e){m.set(this,"type",e)}get src(){return m.get(this,"src")}set src(e){m.set(this,"src",e)}get defer(){return x.get(this,"defer")}set defer(e){x.set(this,"defer",e)}get crossOrigin(){return m.get(this,"crossorigin")}set crossOrigin(e){m.set(this,"crossorigin",e)}get nomodule(){return x.get(this,"nomodule")}set nomodule(e){x.set(this,"nomodule",e)}get referrerPolicy(){return m.get(this,"referrerpolicy")}set referrerPolicy(e){m.set(this,"referrerpolicy",e)}get nonce(){return m.get(this,"nonce")}set nonce(e){m.set(this,"nonce",e)}get async(){return x.get(this,"async")}set async(e){x.set(this,"async",e)}get text(){return this.textContent}set text(e){this.textContent=e}};I(Pa,or);var ds=class extends p{constructor(e,t="frame"){super(e,t)}};var Ma="iframe",ar=class extends p{constructor(e,t=Ma){super(e,t)}get src(){return m.get(this,"src")}set src(e){m.set(this,"src",e)}get srcdoc(){return m.get(this,"srcdoc")}set srcdoc(e){m.set(this,"srcdoc",e)}get name(){return m.get(this,"name")}set name(e){m.set(this,"name",e)}get allow(){return m.get(this,"allow")}set allow(e){m.set(this,"allow",e)}get allowFullscreen(){return x.get(this,"allowfullscreen")}set allowFullscreen(e){x.set(this,"allowfullscreen",e)}get referrerPolicy(){return m.get(this,"referrerpolicy")}set referrerPolicy(e){m.set(this,"referrerpolicy",e)}get loading(){return m.get(this,"loading")}set loading(e){m.set(this,"loading",e)}};I(Ma,ar);var gs=class extends p{constructor(e,t="object"){super(e,t)}};var fs=class extends p{constructor(e,t="head"){super(e,t)}};var Ss=class extends p{constructor(e,t="body"){super(e,t)}};var nl=Se(sl(),1);var il="style",ur=class extends Le{constructor(e,t=il){super(e,t),this[ut]=null}get sheet(){let e=this[ut];return e!==null?e:this[ut]=(0,nl.parse)(this.textContent)}get innerHTML(){return super.innerHTML||""}set innerHTML(e){super.textContent=e,this[ut]=null}get innerText(){return super.innerText||""}set innerText(e){super.textContent=e,this[ut]=null}get textContent(){return super.textContent||""}set textContent(e){super.textContent=e,this[ut]=null}};I(il,ur);var ws=class extends p{constructor(e,t="time"){super(e,t)}};var Is=class extends p{constructor(e,t="fieldset"){super(e,t)}};var Rs=class extends p{constructor(e,t="embed"){super(e,t)}};var Ls=class extends p{constructor(e,t="hr"){super(e,t)}};var Ps=class extends p{constructor(e,t="progress"){super(e,t)}};var Ms=class extends p{constructor(e,t="p"){super(e,t)}};var Os=class extends p{constructor(e,t="table"){super(e,t)}};var ks=class extends p{constructor(e,t="frameset"){super(e,t)}};var Ds=class extends p{constructor(e,t="li"){super(e,t)}};var Hs=class extends p{constructor(e,t="base"){super(e,t)}};var Us=class extends p{constructor(e,t="datalist"){super(e,t)}};var ol="input",hr=class extends p{constructor(e,t=ol){super(e,t)}get autofocus(){return x.get(this,"autofocus")||-1}set autofocus(e){x.set(this,"autofocus",e)}get disabled(){return x.get(this,"disabled")}set disabled(e){x.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get placeholder(){return this.getAttribute("placeholder")}set placeholder(e){this.setAttribute("placeholder",e)}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}get value(){return m.get(this,"value")}set value(e){m.set(this,"value",e)}};I(ol,hr);var Bs=class extends p{constructor(e,t="param"){super(e,t)}};var Gs=class extends p{constructor(e,t="media"){super(e,t)}};var qs=class extends p{constructor(e,t="audio"){super(e,t)}};var al="h1",pr=class extends p{constructor(e,t=al){super(e,t)}};I([al,"h2","h3","h4","h5","h6"],pr);var Fs=class extends p{constructor(e,t="dir"){super(e,t)}};var Vs=class extends p{constructor(e,t="quote"){super(e,t)}};var hl=Se(ul(),1);var{createCanvas:uu}=hl.default,pl="canvas",mr=class extends p{constructor(e,t=pl){super(e,t),this[ae]=uu(300,150)}get width(){return this[ae].width}set width(e){Ee.set(this,"width",e),this[ae].width=e}get height(){return this[ae].height}set height(e){Ee.set(this,"height",e),this[ae].height=e}getContext(e){return this[ae].getContext(e)}toDataURL(...e){return this[ae].toDataURL(...e)}};I(pl,mr);var $s=class extends p{constructor(e,t="legend"){super(e,t)}};var ml="option",dr=class extends p{constructor(e,t=ml){super(e,t)}get value(){return m.get(this,"value")}set value(e){m.set(this,"value",e)}get selected(){return x.get(this,"selected")}set selected(e){let t=this.parentElement?.querySelector("option[selected]");t&&t!==this&&(t.selected=!1),x.set(this,"selected",e)}};I(ml,dr);var Ws=class extends p{constructor(e,t="span"){super(e,t)}};var js=class extends p{constructor(e,t="meter"){super(e,t)}};var zs=class extends p{constructor(e,t="video"){super(e,t)}};var Xs=class extends p{constructor(e,t="td"){super(e,t)}};var dl="title",gr=class extends Le{constructor(e,t=dl){super(e,t)}};I(dl,gr);var Js=class extends p{constructor(e,t="output"){super(e,t)}};var Ks=class extends p{constructor(e,t="tr"){super(e,t)}};var Ys=class extends p{constructor(e,t="data"){super(e,t)}};var Qs=class extends p{constructor(e,t="menu"){super(e,t)}};var gl="select",fr=class extends p{constructor(e,t=gl){super(e,t)}get options(){let e=new j,{firstElementChild:t}=this;for(;t;)t.tagName==="OPTGROUP"?e.push(...t.children):e.push(t),t=t.nextElementSibling;return e}get disabled(){return x.get(this,"disabled")}set disabled(e){x.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get value(){return this.querySelector("option[selected]")?.value}};I(gl,fr);var Zs=class extends p{constructor(e,t="br"){super(e,t)}};var fl="button",Sr=class extends p{constructor(e,t=fl){super(e,t)}get disabled(){return x.get(this,"disabled")}set disabled(e){x.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}};I(fl,Sr);var en=class extends p{constructor(e,t="map"){super(e,t)}};var tn=class extends p{constructor(e,t="optgroup"){super(e,t)}};var rn=class extends p{constructor(e,t="dl"){super(e,t)}};var Sl="textarea",yr=class extends Le{constructor(e,t=Sl){super(e,t)}get disabled(){return x.get(this,"disabled")}set disabled(e){x.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get placeholder(){return this.getAttribute("placeholder")}set placeholder(e){this.setAttribute("placeholder",e)}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}get value(){return this.textContent}set value(e){this.textContent=e}};I(Sl,yr);var sn=class extends p{constructor(e,t="font"){super(e,t)}};var nn=class extends p{constructor(e,t="div"){super(e,t)}};var yl="link",Er=class extends p{constructor(e,t=yl){super(e,t)}get disabled(){return x.get(this,"disabled")}set disabled(e){x.set(this,"disabled",e)}get href(){return m.get(this,"href")}set href(e){m.set(this,"href",e)}get hreflang(){return m.get(this,"hreflang")}set hreflang(e){m.set(this,"hreflang",e)}get media(){return m.get(this,"media")}set media(e){m.set(this,"media",e)}get rel(){return m.get(this,"rel")}set rel(e){m.set(this,"rel",e)}get type(){return m.get(this,"type")}set type(e){m.set(this,"type",e)}};I(yl,Er);var on=class extends p{constructor(e,t="slot"){super(e,t)}};var an=class extends p{constructor(e,t="form"){super(e,t)}};var El="img",yt=class extends p{constructor(e,t=El){super(e,t)}get alt(){return m.get(this,"alt")}set alt(e){m.set(this,"alt",e)}get sizes(){return m.get(this,"sizes")}set sizes(e){m.set(this,"sizes",e)}get src(){return m.get(this,"src")}set src(e){m.set(this,"src",e)}get srcset(){return m.get(this,"srcset")}set srcset(e){m.set(this,"srcset",e)}get title(){return m.get(this,"title")}set title(e){m.set(this,"title",e)}get width(){return Ee.get(this,"width")}set width(e){Ee.set(this,"width",e)}get height(){return Ee.get(this,"height")}set height(e){Ee.set(this,"height",e)}};I(El,yt);var ln=class extends p{constructor(e,t="pre"){super(e,t)}};var cn=class extends p{constructor(e,t="ul"){super(e,t)}};var Cl="meta",Cr=class extends p{constructor(e,t=Cl){super(e,t)}get name(){return m.get(this,"name")}set name(e){m.set(this,"name",e)}get httpEquiv(){return m.get(this,"http-equiv")}set httpEquiv(e){m.set(this,"http-equiv",e)}get content(){return m.get(this,"content")}set content(e){m.set(this,"content",e)}get charset(){return m.get(this,"charset")}set charset(e){m.set(this,"charset",e)}get media(){return m.get(this,"media")}set media(e){m.set(this,"media",e)}};I(Cl,Cr);var un=class extends p{constructor(e,t="picture"){super(e,t)}};var hn=class extends p{constructor(e,t="area"){super(e,t)}};var pn=class extends p{constructor(e,t="ol"){super(e,t)}};var mn=class extends p{constructor(e,t="caption"){super(e,t)}};var vl="a",vr=class extends p{constructor(e,t=vl){super(e,t)}get href(){return encodeURI(m.get(this,"href"))}set href(e){m.set(this,"href",decodeURI(e))}get download(){return encodeURI(m.get(this,"download"))}set download(e){m.set(this,"download",decodeURI(e))}get target(){return m.get(this,"target")}set target(e){m.set(this,"target",e)}get type(){return m.get(this,"type")}set type(e){m.set(this,"type",e)}};I(vl,vr);var dn=class extends p{constructor(e,t="label"){super(e,t)}};var gn=class extends p{constructor(e,t="unknown"){super(e,t)}};var fn=class extends p{constructor(e,t="mod"){super(e,t)}};var Sn=class extends p{constructor(e,t="details"){super(e,t)}};var Tl="source",Tr=class extends p{constructor(e,t=Tl){super(e,t)}get src(){return m.get(this,"src")}set src(e){m.set(this,"src",e)}get srcset(){return m.get(this,"srcset")}set srcset(e){m.set(this,"srcset",e)}get sizes(){return m.get(this,"sizes")}set sizes(e){m.set(this,"sizes",e)}get type(){return m.get(this,"type")}set type(e){m.set(this,"type",e)}};I(Tl,Tr);var yn=class extends p{constructor(e,t="track"){super(e,t)}};var En=class extends p{constructor(e,t="marquee"){super(e,t)}};var bl={HTMLElement:p,HTMLTemplateElement:ir,HTMLHtmlElement:ms,HTMLScriptElement:or,HTMLFrameElement:ds,HTMLIFrameElement:ar,HTMLObjectElement:gs,HTMLHeadElement:fs,HTMLBodyElement:Ss,HTMLStyleElement:ur,HTMLTimeElement:ws,HTMLFieldSetElement:Is,HTMLEmbedElement:Rs,HTMLHRElement:Ls,HTMLProgressElement:Ps,HTMLParagraphElement:Ms,HTMLTableElement:Os,HTMLFrameSetElement:ks,HTMLLIElement:Ds,HTMLBaseElement:Hs,HTMLDataListElement:Us,HTMLInputElement:hr,HTMLParamElement:Bs,HTMLMediaElement:Gs,HTMLAudioElement:qs,HTMLHeadingElement:pr,HTMLDirectoryElement:Fs,HTMLQuoteElement:Vs,HTMLCanvasElement:mr,HTMLLegendElement:$s,HTMLOptionElement:dr,HTMLSpanElement:Ws,HTMLMeterElement:js,HTMLVideoElement:zs,HTMLTableCellElement:Xs,HTMLTitleElement:gr,HTMLOutputElement:Js,HTMLTableRowElement:Ks,HTMLDataElement:Ys,HTMLMenuElement:Qs,HTMLSelectElement:fr,HTMLBRElement:Zs,HTMLButtonElement:Sr,HTMLMapElement:en,HTMLOptGroupElement:tn,HTMLDListElement:rn,HTMLTextAreaElement:yr,HTMLFontElement:sn,HTMLDivElement:nn,HTMLLinkElement:Er,HTMLSlotElement:on,HTMLFormElement:an,HTMLImageElement:yt,HTMLPreElement:ln,HTMLUListElement:cn,HTMLMetaElement:Cr,HTMLPictureElement:un,HTMLAreaElement:hn,HTMLOListElement:pn,HTMLTableCaptionElement:mn,HTMLAnchorElement:vr,HTMLLabelElement:dn,HTMLUnknownElement:gn,HTMLModElement:fn,HTMLDetailsElement:Sn,HTMLSourceElement:Tr,HTMLTrackElement:yn,HTMLMarqueeElement:En};var Cn={test:()=>!0},_l={"text/html":{docType:"<!DOCTYPE html>",ignoreCase:!0,voidElements:/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i},"image/svg+xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Cn},"text/xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Cn},"application/xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Cn},"application/xhtml+xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Cn}};var Ht=class extends ee{constructor(e,t={}){super(e,t),this.detail=t.detail}};var br=class extends ee{constructor(e,t={}){super(e,t),this.inputType=t.inputType,this.data=t.data,this.dataTransfer=t.dataTransfer,this.isComposing=t.isComposing||!1,this.ranges=t.ranges}};var xl=r=>class extends yt{constructor(t,s){switch(super(r),arguments.length){case 1:this.height=t,this.width=t;break;case 2:this.height=s,this.width=t;break}}};var Nl=({[X]:r,[f]:e},t=null)=>{zr(r[P],e[d]);do{let s=J(r),n=s===e?s:s[d];t?t.insertBefore(r,t[f]):r.remove(),r=n}while(r!==e)},Ut=class{constructor(){this[X]=null,this[f]=null,this.commonAncestorContainer=null}insertNode(e){this[f].parentNode.insertBefore(e,this[X])}selectNode(e){this[X]=e,this[f]=J(e)}surroundContents(e){e.replaceChildren(this.extractContents())}setStartBefore(e){this[X]=e}setStartAfter(e){this[X]=e.nextSibling}setEndBefore(e){this[f]=J(e.previousSibling)}setEndAfter(e){this[f]=J(e)}cloneContents(){let{[X]:e,[f]:t}=this,s=e.ownerDocument.createDocumentFragment();for(;e!==t;)s.insertBefore(e.cloneNode(!0),s[f]),e=J(e),e!==t&&(e=e[d]);return s}deleteContents(){Nl(this)}extractContents(){let e=this[X].ownerDocument.createDocumentFragment();return Nl(this,e),e}createContextualFragment(e){let t=this.commonAncestorContainer.createElement("template");return t.innerHTML=e,this.selectNode(t.content),t.content}cloneRange(){let e=new Ut;return e[X]=this[X],e[f]=this[f],e}};var hu=({nodeType:r},e)=>{switch(r){case 1:return e&ni;case 3:return e&ii;case 8:return e&oi}return 0},vn=class{constructor(e,t=si){this.root=e,this.currentNode=e,this.whatToShow=t;let{[d]:s,[f]:n}=e;if(e.nodeType===9){let{documentElement:o}=e;s=o,n=o[f]}let i=[];for(;s!==n;)hu(s,t)&&i.push(s),s=s[d];this[F]={i:0,nodes:i}}nextNode(){let e=this[F];return this.currentNode=e.i<e.nodes.length?e.nodes[e.i++]:null,this.currentNode}};var Al=(r,e,t)=>{let{[d]:s,[f]:n}=e;return r.call({ownerDocument:e,[d]:s,[f]:n},t)},Il=sa({},Ra,bl,{CustomEvent:Ht,Event:ee,EventTarget:st,InputEvent:br,NamedNodeMap:Ot,NodeList:j}),Tn=new WeakMap,ce=class extends nt{constructor(e){super(null,"#document",9),this[Z]={active:!1,registry:null},this[Ae]={active:!1,class:null},this[ye]=_l[e],this[Ze]=null,this[zt]=null,this[At]=null,this[ae]=null,this[et]=null}get defaultView(){return Tn.has(this)||Tn.set(this,new Proxy(globalThis,{set:(e,t,s)=>{switch(t){case"addEventListener":case"removeEventListener":case"dispatchEvent":this[Nt][t]=s;break;default:e[t]=s;break}return!0},get:(e,t)=>{switch(t){case"addEventListener":case"removeEventListener":case"dispatchEvent":if(!this[Nt]){let s=this[Nt]=new st;s.dispatchEvent=s.dispatchEvent.bind(s),s.addEventListener=s.addEventListener.bind(s),s.removeEventListener=s.removeEventListener.bind(s)}return this[Nt][t];case"document":return this;case"navigator":return{userAgent:"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36"};case"window":return Tn.get(this);case"customElements":return this[Z].registry||(this[Z]=new Xr(this)),this[Z];case"performance":return wl.performance;case"DOMParser":return this[zt];case"Image":return this[ae]||(this[ae]=xl(this)),this[ae];case"MutationObserver":return this[Ae].class||(this[Ae]=new Yr(this)),this[Ae].class}return this[At]&&this[At][t]||Il[t]||e[t]}})),Tn.get(this)}get doctype(){let e=this[Ze];if(e)return e;let{firstChild:t}=this;return t&&t.nodeType===10?this[Ze]=t:null}set doctype(e){if(/^([a-z:]+)(\s+system|\s+public(\s+"([^"]+)")?)?(\s+"([^"]+)")?/i.test(e)){let{$1:t,$4:s,$6:n}=RegExp;this[Ze]=new ve(this,t,s,n),Be(this,this[Ze],this[d])}}get documentElement(){return this.firstElementChild}get isConnected(){return!0}_getParent(){return this[Nt]}createAttribute(e){return new se(this,e)}createComment(e){return new Re(this,e)}createDocumentFragment(){return new dt(this)}createDocumentType(e,t,s){return new ve(this,e,t,s)}createElement(e){return new Te(this,e)}createRange(){let e=new Ut;return e.commonAncestorContainer=this,e}createTextNode(e){return new ne(this,e)}createTreeWalker(e,t=-1){return new vn(e,t)}createNodeIterator(e,t=-1){return this.createTreeWalker(e,t)}createEvent(e){let t=na(e==="Event"?new ee(""):new Ht(""));return t.initEvent=t.initCustomEvent=(s,n=!1,i=!1,o)=>{ia(t,{type:{value:s},canBubble:{value:n},cancelable:{value:i},detail:{value:o}})},t}cloneNode(e=!1){let{constructor:t,[Z]:s,[Ze]:n}=this,i=new t;if(i[Z]=s,e){let o=i[f],{childNodes:l}=this;for(let{length:c}=l,a=0;a<c;a++)i.insertBefore(l[a].cloneNode(!0),o);n&&(i[Ze]=l[0])}return i}importNode(e){let t=1<arguments.length&&!!arguments[1],s=e.cloneNode(t),{[Z]:n}=this,{active:i}=n,o=l=>{let{ownerDocument:c,nodeType:a}=l;l.ownerDocument=this,i&&c!==this&&a===1&&n.upgrade(l)};if(o(s),t)switch(s.nodeType){case 1:case 11:{let{[d]:l,[f]:c}=s;for(;l!==c;)l.nodeType===1&&o(l),l=l[d];break}}return s}toString(){return this.childNodes.join("")}querySelector(e){return Al(super.querySelector,this,e)}querySelectorAll(e){return Al(super.querySelectorAll,this,e)}getElementsByTagNameNS(e,t){return this.getElementsByTagName(t)}createAttributeNS(e,t){return this.createAttribute(t)}createElementNS(e,t,s){return e===ht?new it(this,t,null):this.createElement(t,s)}};W(Il.Document=function(){ie()},ce).prototype=ce.prototype;var pu=(r,e,t,s)=>{if(!e&&It.has(t)){let o=It.get(t);return new o(r,t)}let{[Z]:{active:n,registry:i}}=r;if(n){let o=e?s.is:t;if(i.has(o)){let{Class:l}=i.get(o),c=new l(r,t);return Ge.set(c,{connected:!1}),c}}return new p(r,t)},_r=class extends ce{constructor(){super("text/html")}get all(){let e=new j,{[d]:t,[f]:s}=this;for(;t!==s;){switch(t.nodeType){case 1:e.push(t);break}t=t[d]}return e}get head(){let{documentElement:e}=this,{firstElementChild:t}=e;return(!t||t.tagName!=="HEAD")&&(t=this.createElement("head"),e.prepend(t)),t}get body(){let{head:e}=this,{nextElementSibling:t}=e;return(!t||t.tagName!=="BODY")&&(t=this.createElement("body"),e.after(t)),t}get title(){let{head:e}=this,t=e.getElementsByTagName("title").shift();return t?t.textContent:""}set title(e){let{head:t}=this,s=t.getElementsByTagName("title").shift();s?s.textContent=e:t.insertBefore(this.createElement("title"),t.firstChild).textContent=e}createElement(e,t){let s=!!(t&&t.is),n=pu(this,s,e,t);return s&&n.setAttribute("is",t.is),n}};var bn=class extends ce{constructor(){super("image/svg+xml")}toString(){return this[ye].docType+super.toString()}};var _n=class extends ce{constructor(){super("text/xml")}toString(){return this[ye].docType+super.toString()}};var Bt=class{parseFromString(e,t,s=null){let n=!1,i;return t==="text/html"?(n=!0,i=new _r):t==="image/svg+xml"?i=new bn:i=new _n,i[zt]=Bt,s&&(i[At]=s),n&&e==="..."&&(e="<!doctype html><html><head></head><body></body></html>"),e?Kr(i,n,e):i}};var{parse:oT}=JSON;var Rl=(r,e=null)=>new Bt().parseFromString(r,"text/html",e).defaultView;function mu(){ie()}W(mu,ce).prototype=ce.prototype;var Pl=r=>r.trim().replace(/(\n){4,}/g,`


`).replace(/ {3,}/g,"  ").replace(/\t/g,"").replace(/\n+(\s*\n)*/g,`
`),du=r=>{if(!r)return{title:"Could not parse the page.",body:"Could not parse the page.",success:!1};let e=new Ll.Readability(r).parse();if(!e||!e.textContent)return{title:"Could not parse the page.",body:"Could not parse the page.",success:!1};let t=Pl(Or(e.textContent));return{title:e.title,body:t,success:!0}};async function RT(r,e="",t=!1){let s=e;if(!s){let o=await Fi(r,{withSnapshot:t,autoFixUrl:!0});if(o.success)s=o.html;else return{title:"Could not fetch the page.",body:o.html||"Could not fetch the page: Make sure the URL is correct.",url:r,success:!1}}let n=Rl(s).document,i=du(n);return{url:r,...i}}async function Fi(r,e={}){let{withSnapshot:t,autoFixUrl:s}=e,n="",i;try{let o=r.startsWith("http")?r:`https://${r}`;if(s){let l=new URL(o),c=l.host;c.split(".").length===2&&!c.startsWith("www")&&(l.host=`www.${l.host}`,o=l.toString())}if(t){let l=await gu(o);if(l.success)return n=l.content,{html:n,success:!0}}i=await fetch(o,{redirect:"error"})}catch(o){return s?Fi(r,{withSnapshot:t,autoFixUrl:!1}):{html:`Could not fetch the page: ${o}.
Make sure the URL is correct.`,success:!1}}return i.ok?(n=await i.text(),{html:n,success:!0}):{html:`Could not fetch the page: ${i.status} ${i.statusText}`,success:!1}}async function gu(r){try{let e=new URL(r).host;if(e.includes("youtube")||e.includes("facebook")||e.includes("instagram"))return{success:!1,content:"Unable to request the snapshot of this url"};let t="https://webcache.googleusercontent.com/search?&strip=1&vwsrc=0&q=cache:"+encodeURIComponent(r),s=await fetch(t,{redirect:"error"});return s.ok&&s.status===200?{success:!0,content:await s.text()}:{success:!1,content:"Unable to request the snapshot of this url"}}catch{return{success:!1,content:"Unable to request the snapshot of this url"}}}var LT=async(r,e=!0)=>{try{if(e){let t=await no(r,{redirect:"follow"},{responseType:"text",proxyTargetHost:r.includes("bing.com")?"https://bing.com":void 0}),s=t.responseInfo||{};if(!s.ok){let n=s.type==="opaqueredirect"?301:s.status;throw{status:n,statusText:`Failed to fetch: ${n} ${s.statusText}`}}return{status:s.status,html:t.data,url:s.url||r,success:!0}}else{let t=await fetch(r,{redirect:"follow"});if(!t.ok){let s=t.type==="opaqueredirect"?301:t.status;throw{status:s,statusText:`Failed to fetch: ${s} ${t.statusText}`}}return{status:t.status,html:await t.text(),url:t.url,success:!0}}}catch(t){return t.status===301||t.status===429?{status:301,html:"",url:r,success:!1}:{status:404,html:`Could not fetch the page: ${t.message}.
Make sure the URL is correct.`,url:r,success:!1}}};async function PT(r){let e="";try{return e=(await Fi(r,{autoFixUrl:!0})).html,e=Pl(e),e.length>8e3&&(e=e.slice(0,8e3)),{html:e,url:r,success:!0}}catch(t){return{html:`Could not fetch the page: ${t}.
Make sure the URL is correct.`,url:r,success:!1}}}var Vi=class{constructor(){}getRootElement(){return document.querySelector('div[id="__next"]')}getTextInputElement(){let e=document.querySelector("textarea#prompt-textarea");return e?Object.assign(e,{getValue:function(){return e?.value}}):null}updateTextInputValue(e){let t=this.getTextInputElement();t&&(t.value=e)}isNewChatPage(){return location.pathname==="/"&&!document.querySelector("div.h-full[class^=react-scroll-to-bottom]")}getNewChatButton(){let e=null,t=document.querySelectorAll("nav a");for(let s=0;s<t.length;s++){let n=t[s];if(!e&&(n.textContent==="ChatGPTChatGPT"||n.textContent==="ChatGPTClear chat")&&n.getAttribute("href")==="/"){e=n;break}}return e}renderToolbar(e,t){let s=this.getTextInputElement();if(!s)return;let n=s?.closest("form");n&&(e.classList.add("lg:mx-auto","lg:max-w-2xl","xl:max-w-3xl"),e.style.order="3",e.style.position="relative",e.style.flex="1",e.style.width="100%",t&&(t.style.padding="16px 4px 8px"),n.parentElement?.insertBefore(e,n.nextElementSibling))}renderSlashCommandsMenu(e){let t=this.getTextInputElement(),s=t?.parentElement,n=t?.parentElement?.parentElement;s&&n&&(n.style.flexDirection="column",n?.insertBefore(e,s))}renderPromptApp(e,t){let n=document.querySelector("div.text-2xl")?.parentElement,i=n?.parentElement;if(i){n.style.display="none";let o=56+16;e.style.position="absolute",e.style.top=`${o}px`,e.style.left="0",e.style.right="0",e.style.height=`calc(100% - ${o}px )`,t&&(t.style.height="100%"),i.appendChild(e)}}renderPromptRunner(e){document.querySelector("main.relative")?.parentElement?.appendChild(e)}getSubmitBtn(){return document.querySelector("button[data-testid=send-button]")}handlePromptAppDisabled(){let e=at(),t=lt();if(this.isNewChatPage()){e&&e.remove(),t&&t.remove(),this.getNewChatButton()?.click();let i=document.querySelector("div.text-2xl")?.parentElement;i&&(i.style.display="flex")}}handlePromptAppEnabled(){}updateTextInputPlaceholder(e){let t=this.getTextInputElement();t&&t.setAttribute("placeholder",e)}getCurrentChatUserEmail(){try{let e=document.querySelector("#__NEXT_DATA__");return e&&JSON.parse(e.innerText)?.props?.pageProps?.user?.email||""}catch{return""}}};var Ml=Vi;var $i=class{constructor(){}getRootElement(){let e=document.querySelector("div[role=dialog]");return e||document.body}getTextInputElement(){let e=document.querySelector("div[role=dialog]"),t=null;return e&&(t=e.querySelector("div[contenteditable=true]")),t||(t=document.querySelector("div[contenteditable=true]")),t?Object.assign(t,{getValue:function(){return t?.innerText.trim()}}):null}updateTextInputValue(e){let t=this.getTextInputElement();t&&(t.innerText=e)}renderToolbar(e,t){let s=this.getTextInputElement();if(!s)return;let n=s.closest("fieldset");n&&(e.style.position="relative",e.style.backgroundColor="rgba(255, 255, 255, 1)",e.style.borderRadius="8px",e.style.boxShadow="0px 0px 0.5px 0px rgba(0, 0, 0, 0.40), 0px 1px 3px 0px rgba(0, 0, 0, 0.09), 0px 4px 8px 0px rgba(0, 0, 0, 0.09)",e.style.marginTop="8px",e.style.zIndex="10",t&&(t.style.padding="8px",t.style.paddingLeft="8px"),(document.querySelector("div[role=dialog]")||this.isNewChatPage())&&(e.style.minWidth="635px",e.style.marginLeft="-30px"),n.parentElement?.insertBefore(e,n.nextElementSibling))}renderSlashCommandsMenu(e){let s=this.getTextInputElement()?.closest("fieldset"),n=s?.parentElement;n&&s&&(n.style.position="relative",e.style.position="absolute",e.style.top="-175px",e.style.left="0",e.style.right="0",e.style.zIndex="999",n?.insertBefore(e,s))}getNewChatButton(){return document.querySelector("button[data-testid=command-menu]")}isNewChatPage(){let e=location.pathname,t=document.querySelector("main"),s=document.querySelector("div[role=dialog]");return!!(e.startsWith("/chat")&&(t||s))}renderPromptApp(e,t){let s=document.querySelector("h2.tracking-tighter");if(!s){setTimeout(()=>{this.renderPromptApp(e,t)},200);return}let n=s?.parentElement;if(n){s.style.display="none";let i=n.parentElement;i&&(i.style.width="100%"),t&&(t.style.maxWidth="1280px",t.style.height="730px",t.style.paddingTop="16px",t.style.paddingBottom="16px",t.style.margin="0 auto"),n.insertBefore(e,s.nextElementSibling)}}renderPromptRunner(e){this.getRootElement().appendChild(e)}getSubmitBtn(){let e=document.querySelector('div[data-value="new chat"] > button');return e||document.querySelector('button[aria-label="Send Message"]')}handlePromptAppDisabled(){if(!this.isNewChatPage())return;let t=document.querySelector("h2.tracking-tighter");t&&(t.style.display="block");let s=at(),n=lt();s&&s.remove(),n&&n.remove()}handlePromptAppEnabled(){}getCurrentChatUserEmail(){try{return Array.from(document.querySelectorAll("script[nonce]")).find(n=>n.innerHTML.includes("email_address"))?.innerText.match(/"email_address\\":\\"(.+?)\\"/)?.[1]??""}catch{return""}}},Ol=$i;var Wi=class{constructor(){}getRootElement(){return document.querySelector("main.main-landmark")}getTextInputElement(){let e=document.querySelector("div.ql-editor.textarea");if(e)return Object.assign(e,{getValue:function(){return e?.innerText.trim()}});let t=document.querySelector("input-area textarea");return t?Object.assign(t,{getValue:function(){return t.value}}):null}updateTextInputValue(e){let t=this.getTextInputElement();t&&(t?.tagName!=="TEXTAREA"?t.innerText=e:t.value=e)}renderToolbar(e,t){let s=document.querySelector("input-area");e.style.margin="0 48px",t&&(t.style.padding="16px 4px 8px"),s?.appendChild(e)}renderSlashCommandsMenu(e){let t=document.querySelector("input-area");t&&(e.style.maxWidth="88%",e.style.marginLeft="auto",e.style.marginRight="auto",t?.insertBefore(e,t.firstChild))}isNewChatPage(){let e=location.pathname,t=this.getNewChatButton();return e==="/chat"&&t?.getAttribute("disabled")==="true"}getNewChatButton(){return document.querySelector("button[data-test-id=new-chat]")}renderPromptApp(e,t){let s=document.querySelector("*[data-test-id=chat-history-container]");if(s){let n=s.querySelector(".conversation-container");n&&(n.style.display="none"),e.style.width="100%",t&&(t.style.paddingTop="16px",t.style.paddingBottom="16px",t.style.marginLeft="-16px",t.style.marginRight="-16px"),s.appendChild(e)}}renderPromptRunner(e,t){let s=document.querySelector("chat-window");s&&(s.style.position="relative",s.style.overflow="hidden",s.appendChild(e))}getSubmitBtn(){return document.querySelector("button.send-button")}handlePromptAppDisabled(){let e=at(),t=lt();e&&(e.style.display="none"),t&&(t.style.display="none");let s=document.querySelector("div.conversation-container");s&&(s.style.display="flex")}handlePromptAppEnabled(){if(this.isNewChatPage()){let t=at(),s=lt();t&&(t.style.display="block"),s&&(s.style.display="block");let n=document.querySelector("div.conversation-container");n&&(n.style.display="none")}}updateTextInputPlaceholder(e){let t=this.getTextInputElement();t&&t.setAttribute("data-placeholder",e)}getCurrentChatUserEmail(){try{return document.querySelector(".gb_Cc > div:not([class])")?.parentElement?.lastChild?.innerText}catch{return""}}},kl=Wi;var xn=class{currentChatWebSite;currentHelper;constructor(){this.currentChatWebSite=co(),this.currentHelper=this.getHelper()}getHelper(){return this.currentChatWebSite==="Claude"?new Ol:this.currentChatWebSite==="Bard"?new kl:new Ml}getRootElement(){return this.currentHelper.getRootElement()}getTextInputElement(){return this.currentHelper.getTextInputElement()}updateTextInputValue(e){return this.currentHelper.updateTextInputValue(e)}isNewChatPage(){return this.currentHelper.isNewChatPage()}getNewChatButton(){return this.currentHelper.getNewChatButton()}renderToolbar(e,t){return this.currentHelper.renderToolbar(e,t)}renderSlashCommandsMenu(e,t){return this.currentHelper.renderSlashCommandsMenu(e,t)}renderPromptApp(e,t){return this.currentHelper.renderPromptApp(e,t)}renderPromptRunner(e,t){return this.currentHelper.renderPromptRunner(e,t)}getSubmitBtn(){return this.currentHelper.getSubmitBtn()}handlePromptAppDisabled(){return this.currentHelper.handlePromptAppDisabled?.()}handlePromptAppEnabled(){return this.currentHelper.handlePromptAppEnabled?.()}updateTextInputPlaceholder(e){return this.currentHelper.updateTextInputPlaceholder?.(e)}getCurrentChatUserEmail(){return this.currentHelper.getCurrentChatUserEmail?.()}};var He=new xn,zT=()=>He.getRootElement(),XT=()=>He.getTextInputElement(),JT=r=>{He.updateTextInputValue(r)},KT=()=>He.isNewChatPage();function YT(){return He.getNewChatButton()}function QT(){return He.getSubmitBtn()}function ZT(){return He.handlePromptAppDisabled()}function eb(){return He.handlePromptAppEnabled()}function tb(r){return He.updateTextInputPlaceholder(r)}function Dl(){return He.getCurrentChatUserEmail()}var Hl=Se(Bl());var ob=async r=>{let{featureId:e,promptId:t,promptName:s,metaData:n={}}=r,i=Dl();new Lr({runtime:"client"}).postMessage({event:"Client_logCallApiRequest",data:{email:i,action:"USE",feature_id:e,domain:location.host,prompt_id:t,prompt_name:s,meta_data:n,model_name:eo()}})},ab=async r=>{try{if(!r.email)return null;let e=Hl.default.encrypt(JSON.stringify(r),"MaxAI").toString();return await(await fetch(`${Ke}/user/vote`,{method:"POST",body:JSON.stringify({info_object:e}),headers:{"Content-Type":"application/json"}})).json()}catch{return null}};export{Rl as a,du as b,RT as c,LT as d,PT as e,vu as f,Gl as g,xn as h,zT as i,XT as j,JT as k,KT as l,YT as m,QT as n,ZT as o,eb as p,tb as q,ob as r,ab as s,Hn as t,Vn as u,dh as v,Wn as w,jn as x,Fr as y,Kn as z,Qn as A,Wo as B};
