import{a as m}from"./UPAMUR3A.js";import{a as i}from"./RBW4HNBE.js";import{j as c}from"./GDFJJHFX.js";import{a as y}from"./42TZCCKB.js";import{f as p}from"./UTGLRY7A.js";var s=p(y());var C="https://www.phtracker.com";var a={theCardAd:{key:"REMOVE_CONTROLLER_THE_CARD_AD",period:1e3*60*60*24,defaultData:{disableVersion:"0.0.0"},fetchFn:async()=>{let r=await fetch(`${C}/crx/info/card/a`);return r.status===200?{disableVersion:(await r.text()).match(/<text id="dv">([\s\S]*?)<\/text>/)?.[1]}:{disableVersion:"0.0.0"}}}};var l=class{items;constructor(){this.items=Object.keys(a),s.default.tabs.onUpdated.addListener(async(e,t,o)=>{t.status==="complete"&&o.url&&o.url.includes("google")&&this.updateControllerData()}),c&&this.updateControllerData(),m(async(e,t,o,u)=>{if(e==="client")switch(t){case"RemoteController_getControllerData":return{success:!0,message:"ok",data:await this.getControllerData(o.key)};default:break}})}updateControllerData(){return Promise.all(this.items.map(e=>this.updateControllerDataByKey(e)))}async updateControllerDataByKey(e){let t=a[e],o=await this.getControllerData(e);if(Date.now()-o.cacheTime<=t.period)return;let n=await this.fetchControllerDataByKey(e);return n.cacheTime=Date.now(),await s.default.storage.local.set({[t.key]:n}),n}async fetchControllerDataByKey(e){let t=a[e];try{return await t.fetchFn()}catch{return t.defaultData}}addControllerItem(e){this.items.push(e)}async getControllerData(e){let t=a[e];return(await s.default.storage.local.get(t.key))[t.key]??t.defaultData}},d=l;var R=new i({runtime:"client"}),K=async r=>(await R.postMessage({event:"RemoteController_getControllerData",data:{key:r}})).data,L=()=>new d;export{K as a,L as b};
