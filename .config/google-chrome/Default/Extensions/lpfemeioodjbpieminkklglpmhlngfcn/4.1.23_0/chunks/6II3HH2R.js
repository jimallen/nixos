import{a as we,c as G}from"./OUNRME46.js";import{a as ie,c as Ie,d as Ee,e as Oe,g as Pe}from"./SKM5Z6ZR.js";import{a as Ae,c as ve,g as _e}from"./KSSOAXI3.js";import{a as te,c as ke,f as ce}from"./UTGLRY7A.js";var je=ke((xe,Ne)=>{(function(O){var u;typeof xe=="object"?Ne.exports=O():typeof define=="function"&&define.amd?define(O):(typeof window<"u"?u=window:typeof global<"u"?u=global:typeof self<"u"&&(u=self),u.objectHash=O())})(function(){return function O(u,p,b){function P(B,S){if(!p[B]){if(!u[B]){var K=typeof te=="function"&&te;if(!S&&K)return K(B,!0);if(x)return x(B,!0);throw new Error("Cannot find module '"+B+"'")}S=p[B]={exports:{}},u[B][0].call(S.exports,function(M){var z=u[B][1][M];return P(z||M)},S,S.exports,O,u,p,b)}return p[B].exports}for(var x=typeof te=="function"&&te,T=0;T<b.length;T++)P(b[T]);return P}({1:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){"use strict";var m=O("crypto");function I(a,f){f=A(a,f);var r;return(r=f.algorithm!=="passthrough"?m.createHash(f.algorithm):new N).write===void 0&&(r.write=r.update,r.end=r.update),g(f,r).dispatch(a),r.update||r.end(""),r.digest?r.digest(f.encoding==="buffer"?void 0:f.encoding):(a=r.read(),f.encoding!=="buffer"?a.toString(f.encoding):a)}(p=u.exports=I).sha1=function(a){return I(a)},p.keys=function(a){return I(a,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},p.MD5=function(a){return I(a,{algorithm:"md5",encoding:"hex"})},p.keysMD5=function(a){return I(a,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var l=m.getHashes?m.getHashes().slice():["sha1","md5"],y=(l.push("passthrough"),["buffer","hex","binary","base64"]);function A(a,f){var r={};if(r.algorithm=(f=f||{}).algorithm||"sha1",r.encoding=f.encoding||"hex",r.excludeValues=!!f.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=f.ignoreUnknown===!0,r.respectType=f.respectType!==!1,r.respectFunctionNames=f.respectFunctionNames!==!1,r.respectFunctionProperties=f.respectFunctionProperties!==!1,r.unorderedArrays=f.unorderedArrays===!0,r.unorderedSets=f.unorderedSets!==!1,r.unorderedObjects=f.unorderedObjects!==!1,r.replacer=f.replacer||void 0,r.excludeKeys=f.excludeKeys||void 0,a===void 0)throw new Error("Object argument required.");for(var i=0;i<l.length;++i)l[i].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=l[i]);if(l.indexOf(r.algorithm)===-1)throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+l.join(", "));if(y.indexOf(r.encoding)===-1&&r.algorithm!=="passthrough")throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+y.join(", "));return r}function w(a){if(typeof a=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(a))!=null}function g(a,f,r){r=r||[];function i(t){return f.update?f.update(t,"utf8"):f.write(t,"utf8")}return{dispatch:function(t){return this["_"+((t=a.replacer?a.replacer(t):t)===null?"null":typeof t)](t)},_object:function(t){var s,c=Object.prototype.toString.call(t),L=/\[object (.*)\]/i.exec(c);if(L=(L=L?L[1]:"unknown:["+c+"]").toLowerCase(),0<=(c=r.indexOf(t)))return this.dispatch("[CIRCULAR:"+c+"]");if(r.push(t),x!==void 0&&x.isBuffer&&x.isBuffer(t))return i("buffer:"),i(t);if(L==="object"||L==="function"||L==="asyncfunction")return c=Object.keys(t),a.unorderedObjects&&(c=c.sort()),a.respectType===!1||w(t)||c.splice(0,0,"prototype","__proto__","constructor"),a.excludeKeys&&(c=c.filter(function(j){return!a.excludeKeys(j)})),i("object:"+c.length+":"),s=this,c.forEach(function(j){s.dispatch(j),i(":"),a.excludeValues||s.dispatch(t[j]),i(",")});if(!this["_"+L]){if(a.ignoreUnknown)return i("["+L+"]");throw new Error('Unknown object type "'+L+'"')}this["_"+L](t)},_array:function(t,j){j=j!==void 0?j:a.unorderedArrays!==!1;var c=this;if(i("array:"+t.length+":"),!j||t.length<=1)return t.forEach(function(k){return c.dispatch(k)});var L=[],j=t.map(function(k){var E=new N,D=r.slice();return g(a,E,D).dispatch(k),L=L.concat(D.slice(r.length)),E.read().toString()});return r=r.concat(L),j.sort(),this._array(j,!1)},_date:function(t){return i("date:"+t.toJSON())},_symbol:function(t){return i("symbol:"+t.toString())},_error:function(t){return i("error:"+t.toString())},_boolean:function(t){return i("bool:"+t.toString())},_string:function(t){i("string:"+t.length+":"),i(t.toString())},_function:function(t){i("fn:"),w(t)?this.dispatch("[native]"):this.dispatch(t.toString()),a.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(t.name)),a.respectFunctionProperties&&this._object(t)},_number:function(t){return i("number:"+t.toString())},_xml:function(t){return i("xml:"+t.toString())},_null:function(){return i("Null")},_undefined:function(){return i("Undefined")},_regexp:function(t){return i("regex:"+t.toString())},_uint8array:function(t){return i("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray:function(t){return i("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array:function(t){return i("int8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array:function(t){return i("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array:function(t){return i("int16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array:function(t){return i("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array:function(t){return i("int32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array:function(t){return i("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array:function(t){return i("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer:function(t){return i("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url:function(t){return i("url:"+t.toString())},_map:function(t){return i("map:"),t=Array.from(t),this._array(t,a.unorderedSets!==!1)},_set:function(t){return i("set:"),t=Array.from(t),this._array(t,a.unorderedSets!==!1)},_file:function(t){return i("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},_blob:function(){if(a.ignoreUnknown)return i("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return i("domwindow")},_bigint:function(t){return i("bigint:"+t.toString())},_process:function(){return i("process")},_timer:function(){return i("timer")},_pipe:function(){return i("pipe")},_tcp:function(){return i("tcp")},_udp:function(){return i("udp")},_tty:function(){return i("tty")},_statwatcher:function(){return i("statwatcher")},_securecontext:function(){return i("securecontext")},_connection:function(){return i("connection")},_zlib:function(){return i("zlib")},_context:function(){return i("context")},_nodescript:function(){return i("nodescript")},_httpparser:function(){return i("httpparser")},_dataview:function(){return i("dataview")},_signal:function(){return i("signal")},_fsevent:function(){return i("fsevent")},_tlswrap:function(){return i("tlswrap")}}}function N(){return{buf:"",write:function(a){this.buf+=a},end:function(a){this.buf+=a},read:function(){return this.buf}}}p.writeToStream=function(a,f,r){return r===void 0&&(r=f,f={}),g(f=A(a,f),r).dispatch(a)}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){(function(m){"use strict";var I=typeof Uint8Array<"u"?Uint8Array:Array,l="+".charCodeAt(0),y="/".charCodeAt(0),A="0".charCodeAt(0),w="a".charCodeAt(0),g="A".charCodeAt(0),N="-".charCodeAt(0),a="_".charCodeAt(0);function f(r){return r=r.charCodeAt(0),r===l||r===N?62:r===y||r===a?63:r<A?-1:r<A+10?r-A+26+26:r<g+26?r-g:r<w+26?r-w+26:void 0}m.toByteArray=function(r){var i,t;if(0<r.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var s=r.length,s=r.charAt(s-2)==="="?2:r.charAt(s-1)==="="?1:0,c=new I(3*r.length/4-s),L=0<s?r.length-4:r.length,j=0;function k(E){c[j++]=E}for(i=0;i<L;i+=4,0)k((16711680&(t=f(r.charAt(i))<<18|f(r.charAt(i+1))<<12|f(r.charAt(i+2))<<6|f(r.charAt(i+3))))>>16),k((65280&t)>>8),k(255&t);return s==2?k(255&(t=f(r.charAt(i))<<2|f(r.charAt(i+1))>>4)):s==1&&(k((t=f(r.charAt(i))<<10|f(r.charAt(i+1))<<4|f(r.charAt(i+2))>>2)>>8&255),k(255&t)),c},m.fromByteArray=function(r){var i,t,s,c,L=r.length%3,j="";function k(E){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(E)}for(i=0,s=r.length-L;i<s;i+=3)t=(r[i]<<16)+(r[i+1]<<8)+r[i+2],j+=k((c=t)>>18&63)+k(c>>12&63)+k(c>>6&63)+k(63&c);switch(L){case 1:j=(j+=k((t=r[r.length-1])>>2))+k(t<<4&63)+"==";break;case 2:j=(j=(j+=k((t=(r[r.length-2]<<8)+r[r.length-1])>>10))+k(t>>4&63))+k(t<<2&63)+"="}return j}})(p===void 0?this.base64js={}:p)}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(O,u,p){(function(b,P,l,T,B,S,K,M,z){var m=O("base64-js"),I=O("ieee754");function l(e,n,o){if(!(this instanceof l))return new l(e,n,o);var d,h,_,C,R=typeof e;if(n==="base64"&&R=="string")for(e=(C=e).trim?C.trim():C.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if(R=="number")d=W(e);else if(R=="string")d=l.byteLength(e,n);else{if(R!="object")throw new Error("First argument needs to be a number, array or string.");d=W(e.length)}if(l._useTypedArrays?h=l._augment(new Uint8Array(d)):((h=this).length=d,h._isBuffer=!0),l._useTypedArrays&&typeof e.byteLength=="number")h._set(e);else if(Y(C=e)||l.isBuffer(C)||C&&typeof C=="object"&&typeof C.length=="number")for(_=0;_<d;_++)l.isBuffer(e)?h[_]=e.readUInt8(_):h[_]=e[_];else if(R=="string")h.write(e,0,n);else if(R=="number"&&!l._useTypedArrays&&!o)for(_=0;_<d;_++)h[_]=0;return h}function y(e,n,o,d){return l._charsWritten=ne(function(h){for(var _=[],C=0;C<h.length;C++)_.push(255&h.charCodeAt(C));return _}(n),e,o,d)}function A(e,n,o,d){return l._charsWritten=ne(function(h){for(var _,C,R=[],q=0;q<h.length;q++)C=h.charCodeAt(q),_=C>>8,C=C%256,R.push(C),R.push(_);return R}(n),e,o,d)}function w(e,n,o){var d="";o=Math.min(e.length,o);for(var h=n;h<o;h++)d+=String.fromCharCode(e[h]);return d}function g(e,n,o,_){_||(v(typeof o=="boolean","missing or invalid endian"),v(n!=null,"missing offset"),v(n+1<e.length,"Trying to read beyond buffer length"));var h,_=e.length;if(!(_<=n))return o?(h=e[n],n+1<_&&(h|=e[n+1]<<8)):(h=e[n]<<8,n+1<_&&(h|=e[n+1])),h}function N(e,n,o,_){_||(v(typeof o=="boolean","missing or invalid endian"),v(n!=null,"missing offset"),v(n+3<e.length,"Trying to read beyond buffer length"));var h,_=e.length;if(!(_<=n))return o?(n+2<_&&(h=e[n+2]<<16),n+1<_&&(h|=e[n+1]<<8),h|=e[n],n+3<_&&(h+=e[n+3]<<24>>>0)):(n+1<_&&(h=e[n+1]<<16),n+2<_&&(h|=e[n+2]<<8),n+3<_&&(h|=e[n+3]),h+=e[n]<<24>>>0),h}function a(e,n,o,d){if(d||(v(typeof o=="boolean","missing or invalid endian"),v(n!=null,"missing offset"),v(n+1<e.length,"Trying to read beyond buffer length")),!(e.length<=n))return d=g(e,n,o,!0),32768&d?-1*(65535-d+1):d}function f(e,n,o,d){if(d||(v(typeof o=="boolean","missing or invalid endian"),v(n!=null,"missing offset"),v(n+3<e.length,"Trying to read beyond buffer length")),!(e.length<=n))return d=N(e,n,o,!0),2147483648&d?-1*(4294967295-d+1):d}function r(e,n,o,d){return d||(v(typeof o=="boolean","missing or invalid endian"),v(n+3<e.length,"Trying to read beyond buffer length")),I.read(e,n,o,23,4)}function i(e,n,o,d){return d||(v(typeof o=="boolean","missing or invalid endian"),v(n+7<e.length,"Trying to read beyond buffer length")),I.read(e,n,o,52,8)}function t(e,n,o,d,h){if(h||(v(n!=null,"missing value"),v(typeof d=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+1<e.length,"trying to write beyond buffer length"),ue(n,65535)),h=e.length,!(h<=o))for(var _=0,C=Math.min(h-o,2);_<C;_++)e[o+_]=(n&255<<8*(d?_:1-_))>>>8*(d?_:1-_)}function s(e,n,o,d,h){if(h||(v(n!=null,"missing value"),v(typeof d=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+3<e.length,"trying to write beyond buffer length"),ue(n,4294967295)),h=e.length,!(h<=o))for(var _=0,C=Math.min(h-o,4);_<C;_++)e[o+_]=n>>>8*(d?_:3-_)&255}function c(e,n,o,d,h){h||(v(n!=null,"missing value"),v(typeof d=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+1<e.length,"Trying to write beyond buffer length"),le(n,32767,-32768)),e.length<=o||t(e,0<=n?n:65535+n+1,o,d,h)}function L(e,n,o,d,h){h||(v(n!=null,"missing value"),v(typeof d=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+3<e.length,"Trying to write beyond buffer length"),le(n,2147483647,-2147483648)),e.length<=o||s(e,0<=n?n:4294967295+n+1,o,d,h)}function j(e,n,o,d,h){h||(v(n!=null,"missing value"),v(typeof d=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+3<e.length,"Trying to write beyond buffer length"),ye(n,34028234663852886e22,-34028234663852886e22)),e.length<=o||I.write(e,n,o,d,23,4)}function k(e,n,o,d,h){h||(v(n!=null,"missing value"),v(typeof d=="boolean","missing or invalid endian"),v(o!=null,"missing offset"),v(o+7<e.length,"Trying to write beyond buffer length"),ye(n,17976931348623157e292,-17976931348623157e292)),e.length<=o||I.write(e,n,o,d,52,8)}p.Buffer=l,p.SlowBuffer=l,p.INSPECT_MAX_BYTES=50,l.poolSize=8192,l._useTypedArrays=function(){try{var e=new ArrayBuffer(0),n=new Uint8Array(e);return n.foo=function(){return 42},n.foo()===42&&typeof n.subarray=="function"}catch{return!1}}(),l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.isBuffer=function(e){return!(e==null||!e._isBuffer)},l.byteLength=function(e,n){var o;switch(e+="",n||"utf8"){case"hex":o=e.length/2;break;case"utf8":case"utf-8":o=H(e).length;break;case"ascii":case"binary":case"raw":o=e.length;break;case"base64":o=me(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=2*e.length;break;default:throw new Error("Unknown encoding")}return o},l.concat=function(e,n){if(v(Y(e),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),e.length===0)return new l(0);if(e.length===1)return e[0];if(typeof n!="number")for(h=n=0;h<e.length;h++)n+=e[h].length;for(var o=new l(n),d=0,h=0;h<e.length;h++){var _=e[h];_.copy(o,d),d+=_.length}return o},l.prototype.write=function(e,n,o,d){isFinite(n)?isFinite(o)||(d=o,o=void 0):(q=d,d=n,n=o,o=q),n=Number(n)||0;var h,_,C,R,q=this.length-n;switch((!o||q<(o=Number(o)))&&(o=q),d=String(d||"utf8").toLowerCase()){case"hex":h=function($,Z,J,V){J=Number(J)||0;var F=$.length-J;(!V||F<(V=Number(V)))&&(V=F),v((F=Z.length)%2==0,"Invalid hex string"),F/2<V&&(V=F/2);for(var X=0;X<V;X++){var be=parseInt(Z.substr(2*X,2),16);v(!isNaN(be),"Invalid hex string"),$[J+X]=be}return l._charsWritten=2*X,X}(this,e,n,o);break;case"utf8":case"utf-8":_=this,C=n,R=o,h=l._charsWritten=ne(H(e),_,C,R);break;case"ascii":case"binary":h=y(this,e,n,o);break;case"base64":_=this,C=n,R=o,h=l._charsWritten=ne(me(e),_,C,R);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":h=A(this,e,n,o);break;default:throw new Error("Unknown encoding")}return h},l.prototype.toString=function(e,n,o){var d,h,_,C,R=this;if(e=String(e||"utf8").toLowerCase(),n=Number(n)||0,(o=o!==void 0?Number(o):R.length)===n)return"";switch(e){case"hex":d=function(q,$,Z){var J=q.length;(!$||$<0)&&($=0),(!Z||Z<0||J<Z)&&(Z=J);for(var V="",F=$;F<Z;F++)V+=U(q[F]);return V}(R,n,o);break;case"utf8":case"utf-8":d=function(q,$,Z){var J="",V="";Z=Math.min(q.length,Z);for(var F=$;F<Z;F++)q[F]<=127?(J+=ge(V)+String.fromCharCode(q[F]),V=""):V+="%"+q[F].toString(16);return J+ge(V)}(R,n,o);break;case"ascii":case"binary":d=w(R,n,o);break;case"base64":h=R,C=o,d=(_=n)===0&&C===h.length?m.fromByteArray(h):m.fromByteArray(h.slice(_,C));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":d=function(q,$,Z){for(var J=q.slice($,Z),V="",F=0;F<J.length;F+=2)V+=String.fromCharCode(J[F]+256*J[F+1]);return V}(R,n,o);break;default:throw new Error("Unknown encoding")}return d},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.copy=function(e,n,o,d){if(n=n||0,(d=d||d===0?d:this.length)!==(o=o||0)&&e.length!==0&&this.length!==0){v(o<=d,"sourceEnd < sourceStart"),v(0<=n&&n<e.length,"targetStart out of bounds"),v(0<=o&&o<this.length,"sourceStart out of bounds"),v(0<=d&&d<=this.length,"sourceEnd out of bounds"),d>this.length&&(d=this.length);var h=(d=e.length-n<d-o?e.length-n+o:d)-o;if(h<100||!l._useTypedArrays)for(var _=0;_<h;_++)e[_+n]=this[_+o];else e._set(this.subarray(o,o+h),n)}},l.prototype.slice=function(e,n){var o=this.length;if(e=D(e,o,0),n=D(n,o,o),l._useTypedArrays)return l._augment(this.subarray(e,n));for(var d=n-e,h=new l(d,void 0,!0),_=0;_<d;_++)h[_]=this[_+e];return h},l.prototype.get=function(e){return this.readUInt8(e)},l.prototype.set=function(e,n){return this.writeUInt8(e,n)},l.prototype.readUInt8=function(e,n){if(n||(v(e!=null,"missing offset"),v(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},l.prototype.readUInt16LE=function(e,n){return g(this,e,!0,n)},l.prototype.readUInt16BE=function(e,n){return g(this,e,!1,n)},l.prototype.readUInt32LE=function(e,n){return N(this,e,!0,n)},l.prototype.readUInt32BE=function(e,n){return N(this,e,!1,n)},l.prototype.readInt8=function(e,n){if(n||(v(e!=null,"missing offset"),v(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,n){return a(this,e,!0,n)},l.prototype.readInt16BE=function(e,n){return a(this,e,!1,n)},l.prototype.readInt32LE=function(e,n){return f(this,e,!0,n)},l.prototype.readInt32BE=function(e,n){return f(this,e,!1,n)},l.prototype.readFloatLE=function(e,n){return r(this,e,!0,n)},l.prototype.readFloatBE=function(e,n){return r(this,e,!1,n)},l.prototype.readDoubleLE=function(e,n){return i(this,e,!0,n)},l.prototype.readDoubleBE=function(e,n){return i(this,e,!1,n)},l.prototype.writeUInt8=function(e,n,o){o||(v(e!=null,"missing value"),v(n!=null,"missing offset"),v(n<this.length,"trying to write beyond buffer length"),ue(e,255)),n>=this.length||(this[n]=e)},l.prototype.writeUInt16LE=function(e,n,o){t(this,e,n,!0,o)},l.prototype.writeUInt16BE=function(e,n,o){t(this,e,n,!1,o)},l.prototype.writeUInt32LE=function(e,n,o){s(this,e,n,!0,o)},l.prototype.writeUInt32BE=function(e,n,o){s(this,e,n,!1,o)},l.prototype.writeInt8=function(e,n,o){o||(v(e!=null,"missing value"),v(n!=null,"missing offset"),v(n<this.length,"Trying to write beyond buffer length"),le(e,127,-128)),n>=this.length||(0<=e?this.writeUInt8(e,n,o):this.writeUInt8(255+e+1,n,o))},l.prototype.writeInt16LE=function(e,n,o){c(this,e,n,!0,o)},l.prototype.writeInt16BE=function(e,n,o){c(this,e,n,!1,o)},l.prototype.writeInt32LE=function(e,n,o){L(this,e,n,!0,o)},l.prototype.writeInt32BE=function(e,n,o){L(this,e,n,!1,o)},l.prototype.writeFloatLE=function(e,n,o){j(this,e,n,!0,o)},l.prototype.writeFloatBE=function(e,n,o){j(this,e,n,!1,o)},l.prototype.writeDoubleLE=function(e,n,o){k(this,e,n,!0,o)},l.prototype.writeDoubleBE=function(e,n,o){k(this,e,n,!1,o)},l.prototype.fill=function(e,n,o){if(n=n||0,o=o||this.length,v(typeof(e=typeof(e=e||0)=="string"?e.charCodeAt(0):e)=="number"&&!isNaN(e),"value is not a number"),v(n<=o,"end < start"),o!==n&&this.length!==0){v(0<=n&&n<this.length,"start out of bounds"),v(0<=o&&o<=this.length,"end out of bounds");for(var d=n;d<o;d++)this[d]=e}},l.prototype.inspect=function(){for(var e=[],n=this.length,o=0;o<n;o++)if(e[o]=U(this[o]),o===p.INSPECT_MAX_BYTES){e[o+1]="...";break}return"<Buffer "+e.join(" ")+">"},l.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(l._useTypedArrays)return new l(this).buffer;for(var e=new Uint8Array(this.length),n=0,o=e.length;n<o;n+=1)e[n]=this[n];return e.buffer};var E=l.prototype;function D(e,n,o){return typeof e!="number"?o:n<=(e=~~e)?n:0<=e||0<=(e+=n)?e:0}function W(e){return(e=~~Math.ceil(+e))<0?0:e}function Y(e){return(Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"})(e)}function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e){for(var n=[],o=0;o<e.length;o++){var d=e.charCodeAt(o);if(d<=127)n.push(e.charCodeAt(o));else for(var h=o,_=(55296<=d&&d<=57343&&o++,encodeURIComponent(e.slice(h,o+1)).substr(1).split("%")),C=0;C<_.length;C++)n.push(parseInt(_[C],16))}return n}function me(e){return m.toByteArray(e)}function ne(e,n,o,d){for(var h=0;h<d&&!(h+o>=n.length||h>=e.length);h++)n[h+o]=e[h];return h}function ge(e){try{return decodeURIComponent(e)}catch{return String.fromCharCode(65533)}}function ue(e,n){v(typeof e=="number","cannot write a non-number as a number"),v(0<=e,"specified a negative value for writing an unsigned value"),v(e<=n,"value is larger than maximum value for type"),v(Math.floor(e)===e,"value has a fractional component")}function le(e,n,o){v(typeof e=="number","cannot write a non-number as a number"),v(e<=n,"value larger than maximum allowed value"),v(o<=e,"value smaller than minimum allowed value"),v(Math.floor(e)===e,"value has a fractional component")}function ye(e,n,o){v(typeof e=="number","cannot write a non-number as a number"),v(e<=n,"value larger than maximum allowed value"),v(o<=e,"value smaller than minimum allowed value")}function v(e,n){if(!e)throw new Error(n||"Failed assertion")}l._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=E.get,e.set=E.set,e.write=E.write,e.toString=E.toString,e.toLocaleString=E.toString,e.toJSON=E.toJSON,e.copy=E.copy,e.slice=E.slice,e.readUInt8=E.readUInt8,e.readUInt16LE=E.readUInt16LE,e.readUInt16BE=E.readUInt16BE,e.readUInt32LE=E.readUInt32LE,e.readUInt32BE=E.readUInt32BE,e.readInt8=E.readInt8,e.readInt16LE=E.readInt16LE,e.readInt16BE=E.readInt16BE,e.readInt32LE=E.readInt32LE,e.readInt32BE=E.readInt32BE,e.readFloatLE=E.readFloatLE,e.readFloatBE=E.readFloatBE,e.readDoubleLE=E.readDoubleLE,e.readDoubleBE=E.readDoubleBE,e.writeUInt8=E.writeUInt8,e.writeUInt16LE=E.writeUInt16LE,e.writeUInt16BE=E.writeUInt16BE,e.writeUInt32LE=E.writeUInt32LE,e.writeUInt32BE=E.writeUInt32BE,e.writeInt8=E.writeInt8,e.writeInt16LE=E.writeInt16LE,e.writeInt16BE=E.writeInt16BE,e.writeInt32LE=E.writeInt32LE,e.writeInt32BE=E.writeInt32BE,e.writeFloatLE=E.writeFloatLE,e.writeFloatBE=E.writeFloatBE,e.writeDoubleLE=E.writeDoubleLE,e.writeDoubleBE=E.writeDoubleBE,e.fill=E.fill,e.inspect=E.inspect,e.toArrayBuffer=E.toArrayBuffer,e}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(O,u,p){(function(b,P,m,T,B,S,K,M,z){var m=O("buffer").Buffer,I=4,l=new m(I);l.fill(0),u.exports={hash:function(y,A,w,g){for(var N=A(function(t,s){t.length%I!=0&&(c=t.length+(I-t.length%I),t=m.concat([t,l],c));for(var c,L=[],j=s?t.readInt32BE:t.readInt32LE,k=0;k<t.length;k+=I)L.push(j.call(t,k));return L}(y=m.isBuffer(y)?y:new m(y),g),8*y.length),A=g,a=new m(w),f=A?a.writeInt32BE:a.writeInt32LE,r=0;r<N.length;r++)f.call(a,N[r],4*r,!0);return a}}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(O,u,p){(function(b,P,m,T,B,S,K,M,z){var m=O("buffer").Buffer,I=O("./sha"),l=O("./sha256"),y=O("./rng"),A={sha1:I,sha256:l,md5:O("./md5")},w=64,g=new m(w);function N(t,s){var c=A[t=t||"sha1"],L=[];return c||a("algorithm:",t,"is not yet supported"),{update:function(j){return m.isBuffer(j)||(j=new m(j)),L.push(j),j.length,this},digest:function(j){var k=m.concat(L),k=s?function(E,D,W){m.isBuffer(D)||(D=new m(D)),m.isBuffer(W)||(W=new m(W)),D.length>w?D=E(D):D.length<w&&(D=m.concat([D,g],w));for(var Y=new m(w),U=new m(w),H=0;H<w;H++)Y[H]=54^D[H],U[H]=92^D[H];return W=E(m.concat([Y,W])),E(m.concat([U,W]))}(c,s,k):c(k);return L=null,j?k.toString(j):k}}}function a(){var t=[].slice.call(arguments).join(" ");throw new Error([t,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}g.fill(0),p.createHash=function(t){return N(t)},p.createHmac=N,p.randomBytes=function(t,s){if(!s||!s.call)return new m(y(t));try{s.call(this,void 0,new m(y(t)))}catch(c){s(c)}};var f,r=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],i=function(t){p[t]=function(){a("sorry,",t,"is not implemented yet")}};for(f in r)i(r[f],f)}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){var m=O("./helpers");function I(a,f){a[f>>5]|=128<<f%32,a[14+(f+64>>>9<<4)]=f;for(var r=1732584193,i=-271733879,t=-1732584194,s=271733878,c=0;c<a.length;c+=16){var L=r,j=i,k=t,E=s,r=y(r,i,t,s,a[c+0],7,-680876936),s=y(s,r,i,t,a[c+1],12,-389564586),t=y(t,s,r,i,a[c+2],17,606105819),i=y(i,t,s,r,a[c+3],22,-1044525330);r=y(r,i,t,s,a[c+4],7,-176418897),s=y(s,r,i,t,a[c+5],12,1200080426),t=y(t,s,r,i,a[c+6],17,-1473231341),i=y(i,t,s,r,a[c+7],22,-45705983),r=y(r,i,t,s,a[c+8],7,1770035416),s=y(s,r,i,t,a[c+9],12,-1958414417),t=y(t,s,r,i,a[c+10],17,-42063),i=y(i,t,s,r,a[c+11],22,-1990404162),r=y(r,i,t,s,a[c+12],7,1804603682),s=y(s,r,i,t,a[c+13],12,-40341101),t=y(t,s,r,i,a[c+14],17,-1502002290),r=A(r,i=y(i,t,s,r,a[c+15],22,1236535329),t,s,a[c+1],5,-165796510),s=A(s,r,i,t,a[c+6],9,-1069501632),t=A(t,s,r,i,a[c+11],14,643717713),i=A(i,t,s,r,a[c+0],20,-373897302),r=A(r,i,t,s,a[c+5],5,-701558691),s=A(s,r,i,t,a[c+10],9,38016083),t=A(t,s,r,i,a[c+15],14,-660478335),i=A(i,t,s,r,a[c+4],20,-405537848),r=A(r,i,t,s,a[c+9],5,568446438),s=A(s,r,i,t,a[c+14],9,-1019803690),t=A(t,s,r,i,a[c+3],14,-187363961),i=A(i,t,s,r,a[c+8],20,1163531501),r=A(r,i,t,s,a[c+13],5,-1444681467),s=A(s,r,i,t,a[c+2],9,-51403784),t=A(t,s,r,i,a[c+7],14,1735328473),r=w(r,i=A(i,t,s,r,a[c+12],20,-1926607734),t,s,a[c+5],4,-378558),s=w(s,r,i,t,a[c+8],11,-2022574463),t=w(t,s,r,i,a[c+11],16,1839030562),i=w(i,t,s,r,a[c+14],23,-35309556),r=w(r,i,t,s,a[c+1],4,-1530992060),s=w(s,r,i,t,a[c+4],11,1272893353),t=w(t,s,r,i,a[c+7],16,-155497632),i=w(i,t,s,r,a[c+10],23,-1094730640),r=w(r,i,t,s,a[c+13],4,681279174),s=w(s,r,i,t,a[c+0],11,-358537222),t=w(t,s,r,i,a[c+3],16,-722521979),i=w(i,t,s,r,a[c+6],23,76029189),r=w(r,i,t,s,a[c+9],4,-640364487),s=w(s,r,i,t,a[c+12],11,-421815835),t=w(t,s,r,i,a[c+15],16,530742520),r=g(r,i=w(i,t,s,r,a[c+2],23,-995338651),t,s,a[c+0],6,-198630844),s=g(s,r,i,t,a[c+7],10,1126891415),t=g(t,s,r,i,a[c+14],15,-1416354905),i=g(i,t,s,r,a[c+5],21,-57434055),r=g(r,i,t,s,a[c+12],6,1700485571),s=g(s,r,i,t,a[c+3],10,-1894986606),t=g(t,s,r,i,a[c+10],15,-1051523),i=g(i,t,s,r,a[c+1],21,-2054922799),r=g(r,i,t,s,a[c+8],6,1873313359),s=g(s,r,i,t,a[c+15],10,-30611744),t=g(t,s,r,i,a[c+6],15,-1560198380),i=g(i,t,s,r,a[c+13],21,1309151649),r=g(r,i,t,s,a[c+4],6,-145523070),s=g(s,r,i,t,a[c+11],10,-1120210379),t=g(t,s,r,i,a[c+2],15,718787259),i=g(i,t,s,r,a[c+9],21,-343485551),r=N(r,L),i=N(i,j),t=N(t,k),s=N(s,E)}return Array(r,i,t,s)}function l(a,f,r,i,t,s){return N((f=N(N(f,a),N(i,s)))<<t|f>>>32-t,r)}function y(a,f,r,i,t,s,c){return l(f&r|~f&i,a,f,t,s,c)}function A(a,f,r,i,t,s,c){return l(f&i|r&~i,a,f,t,s,c)}function w(a,f,r,i,t,s,c){return l(f^r^i,a,f,t,s,c)}function g(a,f,r,i,t,s,c){return l(r^(f|~i),a,f,t,s,c)}function N(a,f){var r=(65535&a)+(65535&f);return(a>>16)+(f>>16)+(r>>16)<<16|65535&r}u.exports=function(a){return m.hash(a,I,16)}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){var m;u.exports=m||function(I){for(var l,y=new Array(I),A=0;A<I;A++)!(3&A)&&(l=4294967296*Math.random()),y[A]=l>>>((3&A)<<3)&255;return y}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){var m=O("./helpers");function I(A,w){A[w>>5]|=128<<24-w%32,A[15+(w+64>>9<<4)]=w;for(var g,N,a,f=Array(80),r=1732584193,i=-271733879,t=-1732584194,s=271733878,c=-1009589776,L=0;L<A.length;L+=16){for(var j=r,k=i,E=t,D=s,W=c,Y=0;Y<80;Y++){f[Y]=Y<16?A[L+Y]:y(f[Y-3]^f[Y-8]^f[Y-14]^f[Y-16],1);var U=l(l(y(r,5),(U=i,N=t,a=s,(g=Y)<20?U&N|~U&a:!(g<40)&&g<60?U&N|U&a|N&a:U^N^a)),l(l(c,f[Y]),(g=Y)<20?1518500249:g<40?1859775393:g<60?-1894007588:-899497514)),c=s,s=t,t=y(i,30),i=r,r=U}r=l(r,j),i=l(i,k),t=l(t,E),s=l(s,D),c=l(c,W)}return Array(r,i,t,s,c)}function l(A,w){var g=(65535&A)+(65535&w);return(A>>16)+(w>>16)+(g>>16)<<16|65535&g}function y(A,w){return A<<w|A>>>32-w}u.exports=function(A){return m.hash(A,I,20,!0)}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){function m(w,g){var N=(65535&w)+(65535&g);return(w>>16)+(g>>16)+(N>>16)<<16|65535&N}function I(w,g){var N,a=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),f=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),r=new Array(64);w[g>>5]|=128<<24-g%32,w[15+(g+64>>9<<4)]=g;for(var i,t,s=0;s<w.length;s+=16){for(var c=f[0],L=f[1],j=f[2],k=f[3],E=f[4],D=f[5],W=f[6],Y=f[7],U=0;U<64;U++)r[U]=U<16?w[U+s]:m(m(m((t=r[U-2],y(t,17)^y(t,19)^A(t,10)),r[U-7]),(t=r[U-15],y(t,7)^y(t,18)^A(t,3))),r[U-16]),N=m(m(m(m(Y,y(t=E,6)^y(t,11)^y(t,25)),E&D^~E&W),a[U]),r[U]),i=m(y(i=c,2)^y(i,13)^y(i,22),c&L^c&j^L&j),Y=W,W=D,D=E,E=m(k,N),k=j,j=L,L=c,c=m(N,i);f[0]=m(c,f[0]),f[1]=m(L,f[1]),f[2]=m(j,f[2]),f[3]=m(k,f[3]),f[4]=m(E,f[4]),f[5]=m(D,f[5]),f[6]=m(W,f[6]),f[7]=m(Y,f[7])}return f}var l=O("./helpers"),y=function(w,g){return w>>>g|w<<32-g},A=function(w,g){return w>>>g};u.exports=function(w){return l.hash(w,I,32,!0)}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){p.read=function(m,I,l,y,s){var w,g,N=8*s-y-1,a=(1<<N)-1,f=a>>1,r=-7,i=l?s-1:0,t=l?-1:1,s=m[I+i];for(i+=t,w=s&(1<<-r)-1,s>>=-r,r+=N;0<r;w=256*w+m[I+i],i+=t,r-=8);for(g=w&(1<<-r)-1,w>>=-r,r+=y;0<r;g=256*g+m[I+i],i+=t,r-=8);if(w===0)w=1-f;else{if(w===a)return g?NaN:1/0*(s?-1:1);g+=Math.pow(2,y),w-=f}return(s?-1:1)*g*Math.pow(2,w-y)},p.write=function(m,I,l,y,A,c){var g,N,a=8*c-A-1,f=(1<<a)-1,r=f>>1,i=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,t=y?0:c-1,s=y?1:-1,c=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(N=isNaN(I)?1:0,g=f):(g=Math.floor(Math.log(I)/Math.LN2),I*(y=Math.pow(2,-g))<1&&(g--,y*=2),2<=(I+=1<=g+r?i/y:i*Math.pow(2,1-r))*y&&(g++,y/=2),f<=g+r?(N=0,g=f):1<=g+r?(N=(I*y-1)*Math.pow(2,A),g+=r):(N=I*Math.pow(2,r-1)*Math.pow(2,A),g=0));8<=A;m[l+t]=255&N,t+=s,N/=256,A-=8);for(g=g<<A|N,a+=A;0<a;m[l+t]=255&g,t+=s,g/=256,a-=8);m[l+t-s]|=128*c}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(O,u,p){(function(b,P,x,T,B,S,K,M,z){var m,I,l;function y(){}(b=u.exports={}).nextTick=(I=typeof window<"u"&&window.setImmediate,l=typeof window<"u"&&window.postMessage&&window.addEventListener,I?function(A){return window.setImmediate(A)}:l?(m=[],window.addEventListener("message",function(A){var w=A.source;w!==window&&w!==null||A.data!=="process-tick"||(A.stopPropagation(),0<m.length&&m.shift()())},!0),function(A){m.push(A),window.postMessage("process-tick","*")}):function(A){setTimeout(A,0)}),b.title="browser",b.browser=!0,b.env={},b.argv=[],b.on=y,b.addListener=y,b.once=y,b.off=y,b.removeListener=y,b.removeAllListeners=y,b.emit=y,b.binding=function(A){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(A){throw new Error("process.chdir is not supported")}}).call(this,O("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},O("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})});var se=ce(we(),1);var fe=(O,u)=>O.reduce((p,b,P)=>{let x=Math.floor(P/u),T=p[x]||[];return p[x]=T.concat([b]),p},[]);var Be=ce(je(),1),pe=(...O)=>(0,Be.default)(O.join("_"));var Te=new Map,Q=class extends _e{constructor(u){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=u??new Map}lookup(u,p){return Promise.resolve(this.cache.get(pe(u,p))??null)}async update(u,p,b){this.cache.set(pe(u,p),b)}static global(){return new Q(Te)}};var re=class extends Pe{constructor({cache:u,concurrency:p,...b}){super(p?{maxConcurrency:p,...b}:b),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof u=="object"?this.cache=u:u?this.cache=Q.global():this.cache=void 0}async generatePrompt(u,p,b){let P=u.map(x=>x.toString());return this.generate(P,p,b)}invocationParams(){return{}}async _generateUncached(u,p,b){let P=await Oe.configure(b,this.callbacks,{verbose:this.verbose}),x={invocation_params:this?.invocationParams()},T=await P?.handleLLMStart({name:this._llmType()},u,void 0,void 0,x),B;try{B=await this._generate(u,p,T)}catch(S){throw await T?.handleLLMError(S),S}return await T?.handleLLMEnd(B),Object.defineProperty(B,Ae,{value:T?{runId:T?.runId}:void 0,configurable:!0}),B}async generate(u,p,b){if(!Array.isArray(u))throw new Error("Argument 'prompts' is expected to be a string[]");let P;if(Array.isArray(p)?P={stop:p}:p?.timeout&&!p.signal?P={...p,signal:AbortSignal.timeout(p.timeout)}:P=p??{},!this.cache)return this._generateUncached(u,P,b);let{cache:x}=this,T=this.serialize();T.stop=P.stop??T.stop;let B=`${Object.entries(T).sort()}`,S=[],K=await Promise.all(u.map(async(z,m)=>{let I=await x.lookup(z,B);return I||S.push(m),I})),M={};if(S.length>0){let z=await this._generateUncached(S.map(m=>u[m]),P,b);await Promise.all(z.generations.map(async(m,I)=>{let l=S[I];return K[l]=m,x.update(u[l],B,m)})),M=z.llmOutput??{}}return{generations:K,llmOutput:M}}async call(u,p,b){let{generations:P}=await this.generate([u],p??{},b);return P[0][0].text}async predict(u,p,b){return this.call(u,p,b)}async predictMessages(u,p,b){let P=Ee(u),x=await this.call(P,p,b);return new ve(x)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(u){let{_type:p,_model:b,...P}=u;if(b&&b!=="base_llm")throw new Error(`Cannot load LLM with model ${b}`);let x={openai:(await import("./B7AUYG2C.js")).OpenAI}[p];if(x===void 0)throw new Error(`Cannot load  LLM with type ${p}`);return new x(P)}},oe=class extends re{async _generate(u,p,b){return{generations:await Promise.all(u.map(x=>this._call(x,p,b).then(T=>[{text:T}])))}}};var ae=ce(we(),1);var ee=class extends oe{get callKeys(){return["stop","signal","timeout","options"]}constructor(u,p){super(u??{}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"prefixMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let b=u?.openAIApiKey??(typeof process<"u"?process.env?.OPENAI_API_KEY:void 0),P=u?.azureOpenAIApiKey??(typeof process<"u"?process.env?.AZURE_OPENAI_API_KEY:void 0);if(!P&&!b)throw new Error("(Azure) OpenAI API key not found");let x=u?.azureOpenAIApiInstanceName??(typeof process<"u"?process.env?.AZURE_OPENAI_API_INSTANCE_NAME:void 0),T=u?.azureOpenAIApiDeploymentName??(typeof process<"u"?process.env?.AZURE_OPENAI_API_DEPLOYMENT_NAME:void 0),B=u?.azureOpenAIApiVersion??(typeof process<"u"?process.env?.AZURE_OPENAI_API_VERSION:void 0);if(this.modelName=u?.modelName??this.modelName,this.prefixMessages=u?.prefixMessages??this.prefixMessages,this.modelKwargs=u?.modelKwargs??{},this.timeout=u?.timeout,this.temperature=u?.temperature??this.temperature,this.topP=u?.topP??this.topP,this.frequencyPenalty=u?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=u?.presencePenalty??this.presencePenalty,this.n=u?.n??this.n,this.logitBias=u?.logitBias,this.maxTokens=u?.maxTokens,this.stop=u?.stop,this.streaming=u?.streaming??!1,this.azureOpenAIApiVersion=B,this.azureOpenAIApiKey=P,this.azureOpenAIApiInstanceName=x,this.azureOpenAIApiDeploymentName=T,this.streaming&&this.n>1)throw new Error("Cannot stream results when n > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:b,...p}}invocationParams(){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,logit_bias:this.logitBias,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,stop:this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}formatMessages(u){let p={role:"user",content:u};return this.prefixMessages?[...this.prefixMessages,p]:[p]}async _call(u,p,b){let{stop:P}=p,x=this.invocationParams();return x.stop=P??x.stop,(x.stream?await new Promise((B,S)=>{let K,M=!1,z=!1;this.completionWithRetry({...x,messages:this.formatMessages(u)},{signal:p.signal,...p.options,adapter:G,responseType:"stream",onmessage:m=>{if(m.data?.trim?.()==="[DONE]"){if(z)return;z=!0,B(K)}else{let I=JSON.parse(m.data);K||(K={id:I.id,object:I.object,created:I.created,model:I.model,choices:[]});for(let l of I.choices)if(l!=null){let y=K.choices.find(A=>A.index===l.index);y||(y={index:l.index,finish_reason:l.finish_reason??void 0},K.choices.push(y)),y.message||(y.message={role:l.delta?.role,content:l.delta?.content??""}),y.message.content+=l.delta?.content??"",b?.handleLLMNewToken(l.delta?.content??"")}!z&&I.choices.every(l=>l.finish_reason!=null)&&(z=!0,B(K))}}}).catch(m=>{M||(M=!0,S(m))})}):await this.completionWithRetry({...x,messages:this.formatMessages(u)},{signal:p.signal,...p.options})).choices[0].message?.content??""}async completionWithRetry(u,p){if(!this.client){let P=this.azureOpenAIApiKey?`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/openai/deployments/${this.azureOpenAIApiDeploymentName}`:this.clientConfig.basePath,x=new ae.Configuration({...this.clientConfig,basePath:P,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new ae.OpenAIApi(x)}let b={adapter:ie()?void 0:G,...this.clientConfig.baseOptions,...p};return this.azureOpenAIApiKey&&(b.headers={"api-key":this.azureOpenAIApiKey,...b.headers},b.params={"api-version":this.azureOpenAIApiVersion,...b.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),u,b).then(P=>P.data)}_llmType(){return"openai"}},he=class extends ee{constructor(u){if(super(u),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=u?.plTags??[],this.promptLayerApiKey=u?.promptLayerApiKey??(typeof process<"u"?process.env?.PROMPTLAYER_API_KEY:void 0),!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(u,p){if(u.stream)return super.completionWithRetry(u,p);let b=Date.now(),P=await super.completionWithRetry(u),x=Date.now();return await this.caller.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:"openai.ChatCompletion.create",args:[],kwargs:{engine:u.model,messages:u.messages},tags:this.plTags??[],request_response:P,request_start_time:Math.floor(b/1e3),request_end_time:Math.floor(x/1e3),api_key:this.promptLayerApiKey})}),P}};var de=class extends re{get callKeys(){return["stop","signal","timeout","options"]}constructor(u,p){if(u?.modelName?.startsWith("gpt-3.5-turbo")||u?.modelName?.startsWith("gpt-4")||u?.modelName?.startsWith("gpt-4-32k"))return new ee(u,p);super(u??{}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:256}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-davinci-003"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let b=u?.openAIApiKey??(typeof process<"u"?process.env?.OPENAI_API_KEY:void 0),P=u?.azureOpenAIApiKey??(typeof process<"u"?process.env?.AZURE_OPENAI_API_KEY:void 0);if(!P&&!b)throw new Error("(Azure) OpenAI API key not found");let x=u?.azureOpenAIApiInstanceName??(typeof process<"u"?process.env?.AZURE_OPENAI_API_INSTANCE_NAME:void 0),T=(u?.azureOpenAIApiCompletionsDeploymentName||u?.azureOpenAIApiDeploymentName)??(typeof process<"u"?process.env?.AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME||process.env?.AZURE_OPENAI_API_DEPLOYMENT_NAME:void 0),B=u?.azureOpenAIApiVersion??(typeof process<"u"?process.env?.AZURE_OPENAI_API_VERSION:void 0);if(this.modelName=u?.modelName??this.modelName,this.modelKwargs=u?.modelKwargs??{},this.batchSize=u?.batchSize??this.batchSize,this.timeout=u?.timeout,this.temperature=u?.temperature??this.temperature,this.maxTokens=u?.maxTokens??this.maxTokens,this.topP=u?.topP??this.topP,this.frequencyPenalty=u?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=u?.presencePenalty??this.presencePenalty,this.n=u?.n??this.n,this.bestOf=u?.bestOf??this.bestOf,this.logitBias=u?.logitBias,this.stop=u?.stop,this.streaming=u?.streaming??!1,this.azureOpenAIApiVersion=B,this.azureOpenAIApiKey=P,this.azureOpenAIApiInstanceName=x,this.azureOpenAIApiDeploymentName=T,this.streaming&&this.n>1)throw new Error("Cannot stream results when n > 1");if(this.streaming&&this.bestOf>1)throw new Error("Cannot stream results when bestOf > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:b,...p}}invocationParams(){return{model:this.modelName,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(u,p,b){let{stop:P}=p,x=fe(u,this.batchSize),T=[],B={};if(this.stop&&P)throw new Error("Stop found in input and default params");let S=this.invocationParams();if(S.stop=P??S.stop,S.max_tokens===-1){if(u.length!==1)throw new Error("max_tokens set to -1 not supported for multiple inputs");S.max_tokens=await Ie({prompt:u[0],modelName:this.modelName})}for(let M=0;M<x.length;M+=1){let z=S.stream?await new Promise((y,A)=>{let w=[],g,N=!1,a=!1;this.completionWithRetry({...S,prompt:x[M]},{signal:p.signal,...p.options,adapter:G,responseType:"stream",onmessage:f=>{if(f.data?.trim?.()==="[DONE]"){if(a)return;a=!0,y({...g,choices:w})}else{let r=JSON.parse(f.data);g||(g={id:r.id,object:r.object,created:r.created,model:r.model});for(let i of r.choices)if(i!=null&&i.index!=null){w[i.index]||(w[i.index]={});let t=w[i.index];t.text=(t.text??"")+(i.text??""),t.finish_reason=i.finish_reason,t.logprobs=i.logprobs,b?.handleLLMNewToken(i.text??"")}!a&&w.every(i=>i.finish_reason!=null)&&(a=!0,y({...g,choices:w}))}}}).catch(f=>{N||(N=!0,A(f))})}):await this.completionWithRetry({...S,prompt:x[M]},{signal:p.signal,...p.options});T.push(...z.choices);let{completion_tokens:m,prompt_tokens:I,total_tokens:l}=z.usage??{};m&&(B.completionTokens=(B.completionTokens??0)+m),I&&(B.promptTokens=(B.promptTokens??0)+I),l&&(B.totalTokens=(B.totalTokens??0)+l)}return{generations:fe(T,this.n).map(M=>M.map(z=>({text:z.text??"",generationInfo:{finishReason:z.finish_reason,logprobs:z.logprobs}}))),llmOutput:{tokenUsage:B}}}async completionWithRetry(u,p){if(!this.client){let P=this.azureOpenAIApiKey?`https://${this.azureOpenAIApiInstanceName}.openai.azure.com/openai/deployments/${this.azureOpenAIApiDeploymentName}`:this.clientConfig.basePath,x=new se.Configuration({...this.clientConfig,basePath:P,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new se.OpenAIApi(x)}let b={adapter:ie()?void 0:G,...this.clientConfig.baseOptions,...p};return this.azureOpenAIApiKey&&(b.headers={"api-key":this.azureOpenAIApiKey,...b.headers},b.params={"api-version":this.azureOpenAIApiVersion,...b.params}),this.caller.call(this.client.createCompletion.bind(this.client),u,b).then(P=>P.data)}_llmType(){return"openai"}},Le=class extends de{constructor(u){if(super(u),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=u?.plTags??[],this.promptLayerApiKey=u?.promptLayerApiKey??(typeof process<"u"?process.env?.PROMPTLAYER_API_KEY:void 0),!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(u,p){if(u.stream)return super.completionWithRetry(u,p);let b=Date.now(),P=await super.completionWithRetry(u),x=Date.now();return await this.caller.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:"openai.Completion.create",args:[],kwargs:{engine:u.model,prompt:u.prompt},tags:this.plTags??[],request_response:P,request_start_time:Math.floor(b/1e3),request_end_time:Math.floor(x/1e3),api_key:this.promptLayerApiKey})}),P}};export{ee as a,he as b,de as c,Le as d};
