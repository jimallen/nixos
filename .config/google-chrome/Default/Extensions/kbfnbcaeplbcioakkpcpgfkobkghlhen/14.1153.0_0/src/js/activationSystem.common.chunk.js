(self.webpackChunk=self.webpackChunk||[]).push([[6132],{64757:(e,t,i)=>{i.d(t,{L_:()=>_,RZ:()=>d,zx:()=>u});var n=i(50858),a=i(55818),s=i(27378),l=i(8543),o=i(54001),r=i(88648),m=i(86732),c=i(1509),p=i(26215),h=i(94632);function u(e){return s.createElement(p.Y,_(e,h.LI))}function _(e,t){var i=(0,o.Sh)(e.className,t).className;return(0,a._)((0,n._)({},e),{className:i})}!function(e){var t=e.Animated=function(e){return s.createElement(p.Y,(0,a._)((0,n._)({},e),{animationMode:Boolean(e.animationMode)?e.animationMode:m.m.FromClickPoint}))};e.Primary=function(e){return s.createElement(t,(0,n._)({styleType:c.Z.Type.Button},_(e,h.T$)))},e.Secondary=function(e){return s.createElement(t,(0,n._)({styleType:c.Z.Type.Button},_(e,h.BD)))},e.Ghost=function(e){return s.createElement(t,(0,n._)({styleType:c.Z.Type.Button},_(e,h.fk)))},e.Tertiary=function(e){return s.createElement(t,(0,n._)({styleType:c.Z.Type.Base},_(e,h.UF)))},e.Flat=function(e){return s.createElement(t,_(e,h.$H))},e.White=function(e){return s.createElement(t,_(e,h.ix))},e.SidebarFlat=function(e){return s.createElement(p.Y,(0,n._)({styleType:c.Z.Type.H3Legacy},_(e,h.HN)))},e.Caps=function(e){return s.createElement(p.Y,(0,n._)({styleType:c.Z.Type.H3Legacy},_(e,h.Mp)))},e.Group=function(e){var t=e.children,i=e.className,r=e.align,m=void 0===r?"horizontal":r,c=e.sticky,p=e.name;return s.createElement(l.F.div,(0,a._)((0,n._)({role:"group"},(0,o.Sh)(i,"horizontal"===m?!0===c?h.vD:h.ru:h.oc)),{"data-name":p}),t)}}(u||(u={}));var d=function(e){var t=e.title,i=e.titleAlign,n=e.buttonClass,a=e.iconClass,m=e.iconWidth,c=e.tooltipClass;return s.createElement(u,{name:"info-button","aria-label":t,tag:p.X.div,title:s.createElement(l.F.div,(0,o.Sh)(h.bC,c),s.createElement("p",null,t)),titleAlign:i,className:n},s.createElement(r.JO.Info,{width:m,className:a}))}},13273:(e,t,i)=>{i.r(t),i.d(t,{ActivationSystemFeatureImpl:()=>k});var n=i(14601),a=i(76974),s=i(98403),l=i(5114),o=i(55415),r=i(23239),m=i(27378),c=i(10389),p=i(55649),h=i(37869),u=i(15389),_=i(96309),d=i(37902),g=i(90845),f=i(64757),b=i(51869);function v(e){return.5===e?"half":.25===e?"quarter":`${e}`}function y({margin:e,marginLeft:t,marginRight:i,marginTop:n,marginBottom:a}){const s=function(e){if("string"!=typeof e)return{top:e,right:e,bottom:e,left:e};const t=e.split(" "),i=t[0],n=t[1]||i,a=t[2]||i,s=t[3]||n;return{top:i,right:n,bottom:a,left:s}}(e);return{marginLeft:P(t,s.left),marginRight:P(i,s.right),marginTop:P(n,s.top),marginBottom:P(a,s.bottom)}}function P(e,t){const i=void 0!==e?e:t;if(void 0!==i){if("string"==typeof i)return i;if(i<0){return`calc(var(--space-${v(-1*i)}) * -1)`}return`var(--space-${v(i)})`}}const E=m.forwardRef((function(e,t){const{as:i,className:n,variant:a="text-medium",color:s,align:l,weight:o,italic:r,decoration:c,margin:p,marginLeft:h,marginRight:u,marginTop:_,marginBottom:d,style:g,...f}=e,v={...g,...null!=s&&{color:`var(--color-text-${s})`},...null!=l&&{textAlign:l},...null!=o&&{fontWeight:o},...null!=r&&{fontStyle:r?"italic":"normal"},...null!=c&&{textDecoration:c},...y({margin:p,marginLeft:h,marginRight:u,marginTop:_,marginBottom:d})};return m.createElement(i,{ref:t,className:(0,b.W)("gds-typography","gds-"+(a.startsWith("heading")?"heading":"text"),`gds-${a}`,n),style:v,...f})})),C=({descriptionText:e,ctaText:t,onCtaClick:i,onDismiss:n,onMount:a,emotion:s,placementInfo:l})=>{const{referenceElement:o,placement:r,modifiers:c}=l,[p,b]=m.useState(null),{styles:v,attributes:y}=(0,h.D)(o,p,{placement:r,modifiers:c});return g.P.useEffectOnDidMount(a),m.createElement("div",{ref:b,className:u.inlinePill,style:v.popper,"data-test-attr":"inline-activation-pill",...y.popper},m.createElement(_.P,{size:"small","aria-label":"Dismiss",className:u.inlinePillCloseButton,onClick:n}),m.createElement(E,{as:"span",variant:"text-small",className:u.inlinePillDescriptionText},e),s&&m.createElement(d.dy,{size:"small-medium",unicodeHexArray:[s.emojiId],unicodeLiteral:s.emoji,className:u.inlinePillEmoji,"aria-hidden":"true"}),m.createElement(f.zx.Ghost,{className:u.inlinePillCTA,onClick:i},t))};var S=i(31528),T=i(57050);const I={cta:"See more in Grammarly",emotionHook:e=>`Sounding ${e}`};var N;!function(e){e.MINIMUM_TONE_COUNT=3,e.MINIMUM_TONE_CONFIDENCE=.5}(N||(N={}));var x=i(9629),M=i(68546),O=i(94602);class k{constructor(e){this._params=e,this._subs=new n.w,this._log=p.Y.create("ActivationSystemFeatureImpl"),this._emogenieState=r.h.create({prevalentEmotion:l.none,allEmotions:l.none}),this._areOtherGrammarlyPopupsOpen=r.h.create(!1),this._fieldContainer=l.none,this._composeFieldContainer=l.none,this._isCompose=!1,this._toolbarInfo=r.h.create(l.none),this._inlinePillPlacement=r.h.create(l.none),this._isMinimized=r.h.create(!1),this._createToolbarInfoSubscription=()=>(0,T.zG)(this._fieldContainer,l.map(M.x.createToolbarVisibleObservable),l.getOrElse((0,T.a9)(a.of(null)))).subscribe((e=>{(0,T.zG)(e,l.fromNullable,s.wW(this._toolbarInfo))})),this._createIsMinimizedSubscription=()=>(0,T.zG)(this._composeFieldContainer,l.filter((()=>this._isCompose)),l.map(M.x.createMinimizableComposeContainerVisibilityObservable),l.getOrElse((0,T.a9)(a.of(null)))).subscribe((e=>{(0,T.zG)(e,l.fromNullable,l.map((e=>!e.visible)),l.getOrElse((()=>!1)),s.wW(this._isMinimized))})),this._createInlinePillPlacementAtom=()=>r.h.combine(this._toolbarInfo,this._isMinimized,((e,t)=>(0,T.zG)(l.Do,l.bind("toolbar",(()=>e)),l.bind("sendButtonContainer",(()=>this._sendButtonContainer)),l.filter((()=>!t)),l.map((({toolbar:e,sendButtonContainer:t})=>{const i=e.visible?e.el:t,n=e.visible?8:20;return(0,O.tw)(i,n)}))))),this._createEmogenieStateSubscription=()=>this._params.emogenieService.viewState.view(o.H6("report","prevalentEmotion")).subscribe((0,T.ls)((({report:e,prevalentEmotion:t})=>({allEmotions:l.fromNullable(null==e?void 0:e.emotions),prevalentEmotion:l.fromNullable(t)})),s.wW(this._emogenieState))),this._createGrammarlyPopupsOpenSubscription=()=>r.h.combine(this._params.assistantDynamicService.assistantOpenState.view((e=>"open"===e)),this._params.cheetahDynamicService.assistantState.view((e=>"opened"===e.kind)),this._params.gButtonPopupState.view((e=>"none"!==e.type)),((e,t,i)=>e||t||i)).subscribe(s.wW(this._areOtherGrammarlyPopupsOpen)),this._resetActivationState=()=>{this._params.actions._resetActivationSystemSettings()},this._onInlinePillCTAClick=()=>{this._log.debug("Inline pill CTA clicked"),this._params.gnar.activationSystemInlinePillCtaClick("inlinePill"),this._params.openEmogenieReport({type:S.WT.activationSystem}),this._params.actions.setActivationSystemToneInlinePillCTAClicked().then((()=>{this.dispose()}))},this._onDismissInlinePill=()=>{this._log.debug("Dismissing inline pill"),this._params.gnar.activationSystemInlinePillDismissClick("inlinePill"),this._params.actions.setActivationSystemToneInlinePillDismissed().then((()=>{this.dispose()}))},this._onInlinePillShown=()=>{this._log.debug("Inline pill shown"),this._params.gnar.activationSystemInlinePillPopupShow(),this._params.actions.setActivationSystemToneInlinePillSeen()},this._textHasSufficientEmotionsToRenderPill=(e,t)=>e.length>=N.MINIMUM_TONE_COUNT&&t.confidence>=N.MINIMUM_TONE_CONFIDENCE,this._fieldContainer=O.jK(this._params.textField),this._composeFieldContainer=O.cY(this._params.textField),this._sendButtonContainer=O.cB(this._params.textField),this._isCompose=O.mh(this._composeFieldContainer),this._subs.add(this._createToolbarInfoSubscription()),this._subs.add(this._createIsMinimizedSubscription()),this._inlinePillPlacement=this._createInlinePillPlacementAtom(),this._subs.add(this._inlinePillPlacement.subscribe()),this._subs.add(this._createEmogenieStateSubscription()),this._subs.add(this._createGrammarlyPopupsOpenSubscription())}get inlinePillUI(){const{cta:e,emotionHook:t}=I;return r.h.combine(this._emogenieState,this._areOtherGrammarlyPopupsOpen,this._params.csPageState.view("activationSystem"),this._params.user,this._params.checkingStatus,this._inlinePillPlacement,((i,n,a,s,o,r)=>(0,T.zG)(l.Do,l.filter((()=>!(0,O.Zl)(a))),l.bind("allEmotions",(()=>i.allEmotions)),l.bind("prevalentEmotion",(()=>i.prevalentEmotion)),l.bind("inlinePillPlacement",(()=>r)),l.filter((({allEmotions:e,prevalentEmotion:t})=>this._textHasSufficientEmotionsToRenderPill(e,t))),l.filter((()=>s.anonymous)),l.filter((()=>!n)),l.filter((()=>"test"===this._params.experimentClient.getTreatment(x.p.AspToneInlinePillGmail))),l.fold(T.gn,(({prevalentEmotion:i,inlinePillPlacement:n})=>m.createElement(C,{ctaText:e,descriptionText:t(i.name.toLowerCase()),onCtaClick:this._onInlinePillCTAClick,onDismiss:this._onDismissInlinePill,onMount:this._onInlinePillShown,placementInfo:n,emotion:i,checkingInProgress:o===c.Hq.inProgress}))))))}dispose(){this._log.debug("Disposing"),this._subs.unsubscribe()}}},15389:e=>{e.exports={inlinePill:"BYavB",fadeIn:"zG7Sj",inlinePillCloseButton:"qkYqs",inlinePillDescriptionText:"sRTeW",inlinePillCTA:"UPAxJ",spin:"UclXr"}}}]);